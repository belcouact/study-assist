<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>热化学计算器 - 化学学习助手</title>
    <link rel="icon" href="../../assets/icons/logo_btrfly.ico" type="image/x-icon">
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../../css/components.css">
    <link rel="stylesheet" href="../../css/utilities.css">
    <link rel="stylesheet" href="../../css/responsive.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        .thermo-page {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 2rem 0;
        }

        .thermo-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            margin: 2rem auto;
            max-width: 1600px;
        }

        .thermo-header {
            background: linear-gradient(135deg, #dc3545, #fd7e14);
            color: white;
            padding: 2rem;
            text-align: center;
        }

        .thermo-header h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 700;
        }

        .thermo-header p {
            margin: 1rem 0 0 0;
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .thermo-tabs {
            background: #f8f9fa;
            padding: 0;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            overflow-x: auto;
        }

        .thermo-tab {
            padding: 1rem 2rem;
            background: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            color: #666;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
        }

        .thermo-tab.active {
            color: #dc3545;
            border-bottom-color: #dc3545;
            background: white;
        }

        .thermo-tab:hover {
            color: #dc3545;
            background: #f0f8ff;
        }

        .thermo-content {
            padding: 2rem;
            min-height: 600px;
        }

        .tab-panel {
            display: none;
        }

        .tab-panel.active {
            display: block;
        }

        .calculator-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .input-group {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            border: 1px solid #e9ecef;
        }

        .input-group h4 {
            margin: 0 0 1rem 0;
            color: #dc3545;
            font-size: 1.1rem;
        }

        .input-field {
            margin-bottom: 1rem;
        }

        .input-field label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #333;
            font-size: 0.9rem;
        }

        .input-field input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 0.9rem;
            transition: border-color 0.3s ease;
        }

        .input-field input:focus {
            border-color: #dc3545;
            outline: none;
            box-shadow: 0 0 0 2px rgba(220, 53, 69, 0.1);
        }

        .unit-label {
            font-size: 0.8rem;
            color: #666;
            margin-left: 0.5rem;
        }

        .results-section {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            border: 1px solid #e9ecef;
            margin-bottom: 2rem;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .result-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 10px;
            padding: 1.5rem;
            text-align: center;
            border: 1px solid #e9ecef;
        }

        .result-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #dc3545;
            margin-bottom: 0.5rem;
        }

        .result-label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 0.3rem;
        }

        .result-unit {
            font-size: 0.8rem;
            color: #999;
        }

        .reaction-input {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            border: 1px solid #e9ecef;
            margin-bottom: 2rem;
        }

        .reaction-equation {
            width: 100%;
            height: 80px;
            padding: 1rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: monospace;
            font-size: 0.9rem;
            resize: vertical;
        }

        .compound-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .compound-card {
            background: white;
            border-radius: 10px;
            padding: 1rem;
            border: 1px solid #e9ecef;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .compound-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(220, 53, 69, 0.15);
        }

        .compound-card.selected {
            border-color: #dc3545;
            background: #fff5f5;
        }

        .compound-formula {
            font-family: monospace;
            font-size: 1.2rem;
            font-weight: bold;
            color: #dc3545;
            margin-bottom: 0.5rem;
        }

        .compound-name {
            font-size: 0.9rem;
            color: #333;
            margin-bottom: 0.3rem;
        }

        .compound-data {
            font-size: 0.8rem;
            color: #666;
        }

        .phase-selector {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .phase-btn {
            padding: 0.5rem 1rem;
            border: 1px solid #ddd;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.8rem;
        }

        .phase-btn:hover {
            border-color: #dc3545;
            background: #fff5f5;
        }

        .phase-btn.active {
            border-color: #dc3545;
            background: #dc3545;
            color: white;
        }

        .temperature-range {
            background: #f0f8ff;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .temperature-slider {
            width: 100%;
            margin: 1rem 0;
        }

        .temperature-display {
            text-align: center;
            font-size: 1.2rem;
            font-weight: bold;
            color: #dc3545;
            margin-bottom: 1rem;
        }

        .spontaneity-indicator {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            border: 1px solid #e9ecef;
            text-align: center;
            margin-bottom: 2rem;
        }

        .spontaneity-result {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .spontaneity-result.spontaneous {
            color: #28a745;
        }

        .spontaneity-result.non-spontaneous {
            color: #dc3545;
        }

        .spontaneity-result.equilibrium {
            color: #ffc107;
        }

        .action-btn {
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #dc3545, #fd7e14);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(220, 53, 69, 0.3);
        }

        .action-btn.secondary {
            background: linear-gradient(135deg, #6c757d, #495057);
        }

        .formula-reference {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            border: 1px solid #e9ecef;
        }

        .formula-item {
            margin-bottom: 1rem;
            padding: 1rem;
            background: white;
            border-radius: 5px;
            border-left: 4px solid #dc3545;
        }

        .formula-equation {
            font-family: monospace;
            font-size: 1.1rem;
            font-weight: bold;
            color: #dc3545;
            margin-bottom: 0.5rem;
        }

        .formula-description {
            font-size: 0.9rem;
            color: #666;
        }

        @media (max-width: 768px) {
            .thermo-tabs {
                flex-direction: column;
            }
            
            .thermo-tab {
                text-align: center;
            }
            
            .input-grid {
                grid-template-columns: 1fr;
            }
            
            .results-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="../../index.html">
                        <i class="fas fa-graduation-cap" style="background: linear-gradient(90deg, #4361ee, #7209b7); -webkit-background-clip: text; background-clip: text; color: transparent;"></i>
                        <span>Alex的学习助手</span>
                    </a>
                </div>
                <nav class="main-nav">
                    <ul>
                        <li><a href="../../index.html">首页</a></li>
                        <li><a href="main.html">化学</a></li>
                        <li><a href="../../index.html#subjects">科目</a></li>
                        <li><a href="../../tts.html">语音</a></li>
                        <li><a href="../../draw.html">绘图</a></li>
                    </ul>
                </nav>
                <button class="mobile-menu-toggle" aria-label="切换菜单">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </header>

    <main class="thermo-page">
        <div class="container">
            <div class="thermo-container">
                <div class="thermo-header">
                    <h1><i class="fas fa-fire"></i> 热化学计算器</h1>
                    <p>计算焓变、熵变和吉布斯自由能，预测反应自发性</p>
                </div>

                <div class="thermo-tabs">
                    <button class="thermo-tab active" data-tab="enthalpy">焓变计算</button>
                    <button class="thermo-tab" data-tab="entropy">熵变计算</button>
                    <button class="thermo-tab" data-tab="gibbs">吉布斯自由能</button>
                    <button class="thermo-tab" data-tab="spontaneity">反应自发性</button>
                </div>

                <div class="thermo-content">
                    <!-- 焓变计算标签页 -->
                    <div class="tab-panel active" id="enthalpy-panel">
                        <h2>焓变计算 (ΔH)</h2>
                        
                        <div class="calculator-section">
                            <div class="reaction-input">
                                <h4>输入化学反应</h4>
                                <textarea class="reaction-equation" id="enthalpy-reaction" 
                                          placeholder="请输入化学反应方程式，例如：&#10;CH4(g) + 2O2(g) → CO2(g) + 2H2O(l)"></textarea>
                            </div>

                            <div class="input-grid">
                                <div class="input-group">
                                    <h4>反应物焓值</h4>
                                    <div class="input-field">
                                        <label>反应物1 ΔHf° <span class="unit-label">(kJ/mol)</span></label>
                                        <input type="number" id="reactant1-enthalpy" step="0.1" placeholder="例如：-74.8">
                                    </div>
                                    <div class="input-field">
                                        <label>反应物2 ΔHf° <span class="unit-label">(kJ/mol)</span></label>
                                        <input type="number" id="reactant2-enthalpy" step="0.1" placeholder="例如：0">
                                    </div>
                                    <div class="input-field">
                                        <label>反应物1系数</label>
                                        <input type="number" id="reactant1-coeff" value="1" min="1">
                                    </div>
                                    <div class="input-field">
                                        <label>反应物2系数</label>
                                        <input type="number" id="reactant2-coeff" value="2" min="1">
                                    </div>
                                </div>

                                <div class="input-group">
                                    <h4>产物焓值</h4>
                                    <div class="input-field">
                                        <label>产物1 ΔHf° <span class="unit-label">(kJ/mol)</span></label>
                                        <input type="number" id="product1-enthalpy" step="0.1" placeholder="例如：-393.5">
                                    </div>
                                    <div class="input-field">
                                        <label>产物2 ΔHf° <span class="unit-label">(kJ/mol)</span></label>
                                        <input type="number" id="product2-enthalpy" step="0.1" placeholder="例如：-285.8">
                                    </div>
                                    <div class="input-field">
                                        <label>产物1系数</label>
                                        <input type="number" id="product1-coeff" value="1" min="1">
                                    </div>
                                    <div class="input-field">
                                        <label>产物2系数</label>
                                        <input type="number" id="product2-coeff" value="2" min="1">
                                    </div>
                                </div>
                            </div>

                            <div style="text-align: center;">
                                <button class="action-btn" id="calculate-enthalpy">计算焓变</button>
                                <button class="action-btn secondary" id="reset-enthalpy">重置</button>
                            </div>
                        </div>

                        <div class="results-section" id="enthalpy-results">
                            <h4>计算结果</h4>
                            <div class="results-grid">
                                <div class="result-card">
                                    <div class="result-value" id="delta-h">-</div>
                                    <div class="result-label">反应焓变</div>
                                    <div class="result-unit">kJ/mol</div>
                                </div>
                                <div class="result-card">
                                    <div class="result-value" id="reaction-type">-</div>
                                    <div class="result-label">反应类型</div>
                                    <div class="result-unit">放热/吸热</div>
                                </div>
                            </div>
                            <div id="enthalpy-calculation-steps"></div>
                        </div>

                        <div class="compound-selector">
                            <div class="compound-card" data-compound="ch4">
                                <div class="compound-formula">CH₄(g)</div>
                                <div class="compound-name">甲烷</div>
                                <div class="compound-data">ΔHf° = -74.8 kJ/mol</div>
                            </div>
                            <div class="compound-card" data-compound="co2">
                                <div class="compound-formula">CO₂(g)</div>
                                <div class="compound-name">二氧化碳</div>
                                <div class="compound-data">ΔHf° = -393.5 kJ/mol</div>
                            </div>
                            <div class="compound-card" data-compound="h2o-l">
                                <div class="compound-formula">H₂O(l)</div>
                                <div class="compound-name">水(液态)</div>
                                <div class="compound-data">ΔHf° = -285.8 kJ/mol</div>
                            </div>
                            <div class="compound-card" data-compound="h2o-g">
                                <div class="compound-formula">H₂O(g)</div>
                                <div class="compound-name">水(气态)</div>
                                <div class="compound-data">ΔHf° = -241.8 kJ/mol</div>
                            </div>
                            <div class="compound-card" data-compound="o2">
                                <div class="compound-formula">O₂(g)</div>
                                <div class="compound-name">氧气</div>
                                <div class="compound-data">ΔHf° = 0 kJ/mol</div>
                            </div>
                            <div class="compound-card" data-compound="h2">
                                <div class="compound-formula">H₂(g)</div>
                                <div class="compound-name">氢气</div>
                                <div class="compound-data">ΔHf° = 0 kJ/mol</div>
                            </div>
                        </div>
                    </div>

                    <!-- 熵变计算标签页 -->
                    <div class="tab-panel" id="entropy-panel">
                        <h2>熵变计算 (ΔS)</h2>
                        
                        <div class="calculator-section">
                            <div class="input-grid">
                                <div class="input-group">
                                    <h4>反应物熵值</h4>
                                    <div class="input-field">
                                        <label>反应物1 S° <span class="unit-label">(J/mol·K)</span></label>
                                        <input type="number" id="reactant1-entropy" step="0.1" placeholder="例如：186.3">
                                    </div>
                                    <div class="input-field">
                                        <label>反应物2 S° <span class="unit-label">(J/mol·K)</span></label>
                                        <input type="number" id="reactant2-entropy" step="0.1" placeholder="例如：205.1">
                                    </div>
                                </div>

                                <div class="input-group">
                                    <h4>产物熵值</h4>
                                    <div class="input-field">
                                        <label>产物1 S° <span class="unit-label">(J/mol·K)</span></label>
                                        <input type="number" id="product1-entropy" step="0.1" placeholder="例如：213.7">
                                    </div>
                                    <div class="input-field">
                                        <label>产物2 S° <span class="unit-label">(J/mol·K)</span></label>
                                        <input type="number" id="product2-entropy" step="0.1" placeholder="例如：69.9">
                                    </div>
                                </div>
                            </div>

                            <div style="text-align: center;">
                                <button class="action-btn" id="calculate-entropy">计算熵变</button>
                                <button class="action-btn secondary" id="reset-entropy">重置</button>
                            </div>
                        </div>

                        <div class="results-section" id="entropy-results">
                            <h4>计算结果</h4>
                            <div class="results-grid">
                                <div class="result-card">
                                    <div class="result-value" id="delta-s">-</div>
                                    <div class="result-label">反应熵变</div>
                                    <div class="result-unit">J/mol·K</div>
                                </div>
                                <div class="result-card">
                                    <div class="result-value" id="entropy-trend">-</div>
                                    <div class="result-label">熵变趋势</div>
                                    <div class="result-unit">增加/减少</div>
                                </div>
                            </div>
                            <div id="entropy-calculation-steps"></div>
                        </div>
                    </div>

                    <!-- 吉布斯自由能标签页 -->
                    <div class="tab-panel" id="gibbs-panel">
                        <h2>吉布斯自由能计算 (ΔG)</h2>
                        
                        <div class="calculator-section">
                            <div class="input-grid">
                                <div class="input-group">
                                    <h4>热力学参数</h4>
                                    <div class="input-field">
                                        <label>焓变 ΔH <span class="unit-label">(kJ/mol)</span></label>
                                        <input type="number" id="gibbs-enthalpy" step="0.1" placeholder="例如：-890.3">
                                    </div>
                                    <div class="input-field">
                                        <label>熵变 ΔS <span class="unit-label">(J/mol·K)</span></label>
                                        <input type="number" id="gibbs-entropy" step="0.1" placeholder="例如：-242.8">
                                    </div>
                                    <div class="input-field">
                                        <label>温度 T <span class="unit-label">(K)</span></label>
                                        <input type="number" id="gibbs-temperature" value="298.15" step="0.1" min="0">
                                    </div>
                                </div>

                                <div class="input-group">
                                    <h4>或直接输入ΔGf°值</h4>
                                    <div class="input-field">
                                        <label>反应物ΔGf° <span class="unit-label">(kJ/mol)</span></label>
                                        <input type="number" id="reactant-gibbs" step="0.1" placeholder="例如：-50.7">
                                    </div>
                                    <div class="input-field">
                                        <label>产物ΔGf° <span class="unit-label">(kJ/mol)</span></label>
                                        <input type="number" id="product-gibbs" step="0.1" placeholder="例如：-394.4">
                                    </div>
                                </div>
                            </div>

                            <div class="temperature-range">
                                <h4>温度范围分析</h4>
                                <div class="temperature-display" id="temp-display">298.15 K (25°C)</div>
                                <input type="range" class="temperature-slider" id="temp-slider" 
                                       min="200" max="1000" value="298.15" step="1">
                                <div style="display: flex; justify-content: space-between; font-size: 0.8rem; color: #666;">
                                    <span>200 K</span>
                                    <span>1000 K</span>
                                </div>
                            </div>

                            <div style="text-align: center;">
                                <button class="action-btn" id="calculate-gibbs">计算吉布斯自由能</button>
                                <button class="action-btn secondary" id="reset-gibbs">重置</button>
                            </div>
                        </div>

                        <div class="results-section" id="gibbs-results">
                            <h4>计算结果</h4>
                            <div class="results-grid">
                                <div class="result-card">
                                    <div class="result-value" id="delta-g">-</div>
                                    <div class="result-label">吉布斯自由能变</div>
                                    <div class="result-unit">kJ/mol</div>
                                </div>
                                <div class="result-card">
                                    <div class="result-value" id="equilibrium-constant">-</div>
                                    <div class="result-label">平衡常数 K</div>
                                    <div class="result-unit">-</div>
                                </div>
                            </div>
                            <div id="gibbs-calculation-steps"></div>
                        </div>
                    </div>

                    <!-- 反应自发性标签页 -->
                    <div class="tab-panel" id="spontaneity-panel">
                        <h2>反应自发性预测</h2>
                        
                        <div class="calculator-section">
                            <div class="input-grid">
                                <div class="input-group">
                                    <h4>热力学参数</h4>
                                    <div class="input-field">
                                        <label>焓变 ΔH <span class="unit-label">(kJ/mol)</span></label>
                                        <input type="number" id="spont-enthalpy" step="0.1" placeholder="例如：-890.3">
                                    </div>
                                    <div class="input-field">
                                        <label>熵变 ΔS <span class="unit-label">(J/mol·K)</span></label>
                                        <input type="number" id="spont-entropy" step="0.1" placeholder="例如：-242.8">
                                    </div>
                                    <div class="input-field">
                                        <label>温度 T <span class="unit-label">(K)</span></label>
                                        <input type="number" id="spont-temperature" value="298.15" step="0.1" min="0">
                                    </div>
                                </div>
                            </div>

                            <div style="text-align: center;">
                                <button class="action-btn" id="predict-spontaneity">预测自发性</button>
                                <button class="action-btn secondary" id="reset-spontaneity">重置</button>
                            </div>
                        </div>

                        <div class="spontaneity-indicator" id="spontaneity-indicator">
                            <div class="spontaneity-result" id="spontaneity-result">请输入参数进行预测</div>
                            <div id="spontaneity-explanation"></div>
                        </div>

                        <div class="formula-reference">
                            <h4>自发性判断规则</h4>
                            <div class="formula-item">
                                <div class="formula-equation">ΔG = ΔH - TΔS</div>
                                <div class="formula-description">吉布斯自由能方程</div>
                            </div>
                            <div class="formula-item">
                                <div class="formula-equation">ΔG < 0 → 自发反应</div>
                                <div class="formula-description">反应在给定条件下自发进行</div>
                            </div>
                            <div class="formula-item">
                                <div class="formula-equation">ΔG > 0 → 非自发反应</div>
                                <div class="formula-description">反应在给定条件下不能自发进行</div>
                            </div>
                            <div class="formula-item">
                                <div class="formula-equation">ΔG = 0 → 平衡状态</div>
                                <div class="formula-description">反应达到平衡，正逆反应速率相等</div>
                            </div>
                        </div>

                        <div style="background: white; padding: 2rem; border-radius: 10px; border: 1px solid #e9ecef; margin-top: 2rem;">
                            <h4>温度对自发性的影响</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
                                <div>
                                    <h5>ΔH < 0, ΔS > 0</h5>
                                    <p>所有温度下都自发</p>
                                </div>
                                <div>
                                    <h5>ΔH > 0, ΔS < 0</h5>
                                    <p>所有温度下都不自发</p>
                                </div>
                                <div>
                                    <h5>ΔH < 0, ΔS < 0</h5>
                                    <p>低温下自发，高温下不自发</p>
                                </div>
                                <div>
                                    <h5>ΔH > 0, ΔS > 0</h5>
                                    <p>高温下自发，低温下不自发</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="main-footer">
        <div class="container">
            <div class="footer-content">
                <p class="copyright-text">study-llm.me域名为Alex所有。保留所有权利。</p>
            </div>
        </div>
    </footer>

    <script src="../../js/common.js"></script>
    <script src="../../js/navigation.js"></script>
    <script>
        // 热化学计算器功能
        class ThermochemistryCalculator {
            constructor() {
                this.initializeEventListeners();
                this.setupTemperatureSlider();
            }

            initializeEventListeners() {
                // 标签页切换
                document.querySelectorAll('.thermo-tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        this.switchTab(e.target.dataset.tab);
                    });
                });

                // 计算按钮
                document.getElementById('calculate-enthalpy').addEventListener('click', () => {
                    this.calculateEnthalpy();
                });

                document.getElementById('calculate-entropy').addEventListener('click', () => {
                    this.calculateEntropy();
                });

                document.getElementById('calculate-gibbs').addEventListener('click', () => {
                    this.calculateGibbs();
                });

                document.getElementById('predict-spontaneity').addEventListener('click', () => {
                    this.predictSpontaneity();
                });

                // 重置按钮
                document.getElementById('reset-enthalpy').addEventListener('click', () => {
                    this.resetEnthalpy();
                });

                document.getElementById('reset-entropy').addEventListener('click', () => {
                    this.resetEntropy();
                });

                document.getElementById('reset-gibbs').addEventListener('click', () => {
                    this.resetGibbs();
                });

                document.getElementById('reset-spontaneity').addEventListener('click', () => {
                    this.resetSpontaneity();
                });

                // 化合物选择
                document.querySelectorAll('.compound-card').forEach(card => {
                    card.addEventListener('click', (e) => {
                        this.selectCompound(e.target.closest('.compound-card'));
                    });
                });
            }

            switchTab(tabName) {
                // 更新标签页状态
                document.querySelectorAll('.thermo-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

                // 显示对应面板
                document.querySelectorAll('.tab-panel').forEach(panel => {
                    panel.classList.remove('active');
                });
                document.getElementById(`${tabName}-panel`).classList.add('active');
            }

            setupTemperatureSlider() {
                const slider = document.getElementById('temp-slider');
                const display = document.getElementById('temp-display');

                slider.addEventListener('input', (e) => {
                    const temp = parseFloat(e.target.value);
                    const celsius = temp - 273.15;
                    display.textContent = `${temp} K (${celsius.toFixed(1)}°C)`;
                    
                    // 更新吉布斯自由能输入框
                    document.getElementById('gibbs-temperature').value = temp;
                });
            }

            calculateEnthalpy() {
                const r1H = parseFloat(document.getElementById('reactant1-enthalpy').value) || 0;
                const r2H = parseFloat(document.getElementById('reactant2-enthalpy').value) || 0;
                const p1H = parseFloat(document.getElementById('product1-enthalpy').value) || 0;
                const p2H = parseFloat(document.getElementById('product2-enthalpy').value) || 0;

                const r1Coeff = parseFloat(document.getElementById('reactant1-coeff').value) || 1;
                const r2Coeff = parseFloat(document.getElementById('reactant2-coeff').value) || 1;
                const p1Coeff = parseFloat(document.getElementById('product1-coeff').value) || 1;
                const p2Coeff = parseFloat(document.getElementById('product2-coeff').value) || 1;

                // ΔH = Σ(ΔHf°产物) - Σ(ΔHf°反应物)
                const productsH = p1Coeff * p1H + p2Coeff * p2H;
                const reactantsH = r1Coeff * r1H + r2Coeff * r2H;
                const deltaH = productsH - reactantsH;

                // 更新结果显示
                document.getElementById('delta-h').textContent = deltaH.toFixed(2);
                
                const reactionType = deltaH < 0 ? '放热反应' : deltaH > 0 ? '吸热反应' : '无热效应';
                document.getElementById('reaction-type').textContent = reactionType;

                // 显示计算步骤
                const steps = `
                    <h5>计算步骤:</h5>
                    <p><strong>ΔH = Σ(ΔHf°产物) - Σ(ΔHf°反应物)</strong></p>
                    <p>产物焓值总和: ${p1Coeff} × ${p1H} + ${p2Coeff} × ${p2H} = ${productsH.toFixed(2)} kJ/mol</p>
                    <p>反应物焓值总和: ${r1Coeff} × ${r1H} + ${r2Coeff} × ${r2H} = ${reactantsH.toFixed(2)} kJ/mol</p>
                    <p>反应焓变: ${productsH.toFixed(2)} - (${reactantsH.toFixed(2)}) = ${deltaH.toFixed(2)} kJ/mol</p>
                `;
                document.getElementById('enthalpy-calculation-steps').innerHTML = steps;
            }

            calculateEntropy() {
                const r1S = parseFloat(document.getElementById('reactant1-entropy').value) || 0;
                const r2S = parseFloat(document.getElementById('reactant2-entropy').value) || 0;
                const p1S = parseFloat(document.getElementById('product1-entropy').value) || 0;
                const p2S = parseFloat(document.getElementById('product2-entropy').value) || 0;

                // 使用焓变计算中的系数
                const r1Coeff = parseFloat(document.getElementById('reactant1-coeff').value) || 1;
                const r2Coeff = parseFloat(document.getElementById('reactant2-coeff').value) || 1;
                const p1Coeff = parseFloat(document.getElementById('product1-coeff').value) || 1;
                const p2Coeff = parseFloat(document.getElementById('product2-coeff').value) || 1;

                // ΔS = Σ(S°产物) - Σ(S°反应物)
                const productsS = p1Coeff * p1S + p2Coeff * p2S;
                const reactantsS = r1Coeff * r1S + r2Coeff * r2S;
                const deltaS = productsS - reactantsS;

                // 更新结果显示
                document.getElementById('delta-s').textContent = deltaS.toFixed(2);
                
                const entropyTrend = deltaS > 0 ? '熵增加' : deltaS < 0 ? '熵减少' : '熵不变';
                document.getElementById('entropy-trend').textContent = entropyTrend;

                // 显示计算步骤
                const steps = `
                    <h5>计算步骤:</h5>
                    <p><strong>ΔS = Σ(S°产物) - Σ(S°反应物)</strong></p>
                    <p>产物熵值总和: ${p1Coeff} × ${p1S} + ${p2Coeff} × ${p2S} = ${productsS.toFixed(2)} J/mol·K</p>
                    <p>反应物熵值总和: ${r1Coeff} × ${r1S} + ${r2Coeff} × ${r2S} = ${reactantsS.toFixed(2)} J/mol·K</p>
                    <p>反应熵变: ${productsS.toFixed(2)} - ${reactantsS.toFixed(2)} = ${deltaS.toFixed(2)} J/mol·K</p>
                `;
                document.getElementById('entropy-calculation-steps').innerHTML = steps;
            }

            calculateGibbs() {
                const deltaH = parseFloat(document.getElementById('gibbs-enthalpy').value);
                const deltaS = parseFloat(document.getElementById('gibbs-entropy').value);
                const temperature = parseFloat(document.getElementById('gibbs-temperature').value) || 298.15;

                let deltaG;
                let calculationMethod;

                if (!isNaN(deltaH) && !isNaN(deltaS)) {
                    // 使用 ΔG = ΔH - TΔS 计算
                    deltaG = deltaH - temperature * deltaS / 1000; // 转换J为kJ
                    calculationMethod = 'ΔG = ΔH - TΔS';
                } else {
                    // 使用ΔGf°值计算
                    const reactantG = parseFloat(document.getElementById('reactant-gibbs').value) || 0;
                    const productG = parseFloat(document.getElementById('product-gibbs').value) || 0;
                    deltaG = productG - reactantG;
                    calculationMethod = 'ΔG = Σ(ΔGf°产物) - Σ(ΔGf°反应物)';
                }

                // 计算平衡常数 K = exp(-ΔG/RT)
                const R = 8.314; // J/mol·K
                const equilibriumConstant = Math.exp(-deltaG * 1000 / (R * temperature));

                // 更新结果显示
                document.getElementById('delta-g').textContent = deltaG.toFixed(2);
                document.getElementById('equilibrium-constant').textContent = 
                    equilibriumConstant > 1e6 ? '>> 1' : 
                    equilibriumConstant < 1e-6 ? '<< 1' : 
                    equilibriumConstant.toExponential(2);

                // 显示计算步骤
                let steps = `<h5>计算步骤:</h5><p><strong>${calculationMethod}</strong></p>`;
                
                if (!isNaN(deltaH) && !isNaN(deltaS)) {
                    steps += `
                        <p>ΔG = ${deltaH} - ${temperature} × (${deltaS}/1000)</p>
                        <p>ΔG = ${deltaH} - ${(temperature * deltaS / 1000).toFixed(2)} = ${deltaG.toFixed(2)} kJ/mol</p>
                    `;
                }
                
                steps += `<p>平衡常数: K = exp(-ΔG/RT) = ${equilibriumConstant.toExponential(2)}</p>`;
                document.getElementById('gibbs-calculation-steps').innerHTML = steps;
            }

            predictSpontaneity() {
                const deltaH = parseFloat(document.getElementById('spont-enthalpy').value);
                const deltaS = parseFloat(document.getElementById('spont-entropy').value);
                const temperature = parseFloat(document.getElementById('spont-temperature').value) || 298.15;

                if (isNaN(deltaH) || isNaN(deltaS)) {
                    alert('请输入完整的热力学参数');
                    return;
                }

                // 计算ΔG
                const deltaG = deltaH - temperature * deltaS / 1000;

                const resultElement = document.getElementById('spontaneity-result');
                const explanationElement = document.getElementById('spontaneity-explanation');

                if (deltaG < -1) {
                    resultElement.textContent = '自发反应';
                    resultElement.className = 'spontaneity-result spontaneous';
                    explanationElement.innerHTML = `
                        <p><strong>ΔG = ${deltaG.toFixed(2)} kJ/mol < 0</strong></p>
                        <p>反应在${temperature} K温度下自发进行</p>
                    `;
                } else if (deltaG > 1) {
                    resultElement.textContent = '非自发反应';
                    resultElement.className = 'spontaneity-result non-spontaneous';
                    explanationElement.innerHTML = `
                        <p><strong>ΔG = ${deltaG.toFixed(2)} kJ/mol > 0</strong></p>
                        <p>反应在${temperature} K温度下不能自发进行</p>
                    `;
                } else {
                    resultElement.textContent = '接近平衡';
                    resultElement.className = 'spontaneity-result equilibrium';
                    explanationElement.innerHTML = `
                        <p><strong>ΔG = ${deltaG.toFixed(2)} kJ/mol ≈ 0</strong></p>
                        <p>反应在${temperature} K温度下接近平衡状态</p>
                    `;
                }

                // 添加温度影响分析
                this.analyzeTemperatureEffect(deltaH, deltaS, explanationElement);
            }

            analyzeTemperatureEffect(deltaH, deltaS, explanationElement) {
                let tempAnalysis = '<h5>温度影响分析:</h5>';

                if (deltaH < 0 && deltaS > 0) {
                    tempAnalysis += '<p>ΔH < 0, ΔS > 0: 所有温度下都自发</p>';
                } else if (deltaH > 0 && deltaS < 0) {
                    tempAnalysis += '<p>ΔH > 0, ΔS < 0: 所有温度下都不自发</p>';
                } else if (deltaH < 0 && deltaS < 0) {
                    const criticalTemp = Math.abs(deltaH * 1000 / deltaS);
                    tempAnalysis += `<p>ΔH < 0, ΔS < 0: T < ${criticalTemp.toFixed(1)} K时自发</p>`;
                } else if (deltaH > 0 && deltaS > 0) {
                    const criticalTemp = deltaH * 1000 / deltaS;
                    tempAnalysis += `<p>ΔH > 0, ΔS > 0: T > ${criticalTemp.toFixed(1)} K时自发</p>`;
                }

                explanationElement.innerHTML += tempAnalysis;
            }

            selectCompound(card) {
                document.querySelectorAll('.compound-card').forEach(c => c.classList.remove('selected'));
                card.classList.add('selected');
                
                const compound = card.dataset.compound;
                this.fillCompoundData(compound);
            }

            fillCompoundData(compound) {
                const compoundData = {
                    'ch4': { enthalpy: -74.8, entropy: 186.3 },
                    'co2': { enthalpy: -393.5, entropy: 213.7 },
                    'h2o-l': { enthalpy: -285.8, entropy: 69.9 },
                    'h2o-g': { enthalpy: -241.8, entropy: 188.8 },
                    'o2': { enthalpy: 0, entropy: 205.1 },
                    'h2': { enthalpy: 0, entropy: 130.7 }
                };

                const data = compoundData[compound];
                if (data) {
                    // 可以根据需要填充到相应的输入框
                    alert(`${compound}的数据:\nΔHf° = ${data.enthalpy} kJ/mol\nS° = ${data.entropy} J/mol·K`);
                }
            }

            resetEnthalpy() {
                document.getElementById('enthalpy-reaction').value = '';
                document.getElementById('reactant1-enthalpy').value = '';
                document.getElementById('reactant2-enthalpy').value = '';
                document.getElementById('product1-enthalpy').value = '';
                document.getElementById('product2-enthalpy').value = '';
                document.getElementById('reactant1-coeff').value = '1';
                document.getElementById('reactant2-coeff').value = '2';
                document.getElementById('product1-coeff').value = '1';
                document.getElementById('product2-coeff').value = '2';
                document.getElementById('delta-h').textContent = '-';
                document.getElementById('reaction-type').textContent = '-';
                document.getElementById('enthalpy-calculation-steps').innerHTML = '';
            }

            resetEntropy() {
                document.getElementById('reactant1-entropy').value = '';
                document.getElementById('reactant2-entropy').value = '';
                document.getElementById('product1-entropy').value = '';
                document.getElementById('product2-entropy').value = '';
                document.getElementById('delta-s').textContent = '-';
                document.getElementById('entropy-trend').textContent = '-';
                document.getElementById('entropy-calculation-steps').innerHTML = '';
            }

            resetGibbs() {
                document.getElementById('gibbs-enthalpy').value = '';
                document.getElementById('gibbs-entropy').value = '';
                document.getElementById('gibbs-temperature').value = '298.15';
                document.getElementById('reactant-gibbs').value = '';
                document.getElementById('product-gibbs').value = '';
                document.getElementById('delta-g').textContent = '-';
                document.getElementById('equilibrium-constant').textContent = '-';
                document.getElementById('gibbs-calculation-steps').innerHTML = '';
                document.getElementById('temp-slider').value = '298.15';
                document.getElementById('temp-display').textContent = '298.15 K (25°C)';
            }

            resetSpontaneity() {
                document.getElementById('spont-enthalpy').value = '';
                document.getElementById('spont-entropy').value = '';
                document.getElementById('spont-temperature').value = '298.15';
                document.getElementById('spontaneity-result').textContent = '请输入参数进行预测';
                document.getElementById('spontaneity-result').className = 'spontaneity-result';
                document.getElementById('spontaneity-explanation').innerHTML = '';
            }
        }

        // 初始化热化学计算器
        let thermoCalculator;
        document.addEventListener('DOMContentLoaded', () => {
            thermoCalculator = new ThermochemistryCalculator();
        });
    </script>
</body>
</html> 