<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŒ–å­¦è®¡ç®—å·¥å…· - åŒ–å­¦å­¦ä¹ åŠ©æ‰‹</title>
    <link rel="icon" href="../../assets/icons/logo_btrfly.ico" type="image/x-icon">
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../../css/components.css">
    <link rel="stylesheet" href="../../css/utilities.css">
    <link rel="stylesheet" href="../../css/responsive.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Mobile First Design */
        .calculator-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }

        .calculator-header {
            text-align: center;
            margin-bottom: 2rem;
            padding: 2rem 1rem;
            background: linear-gradient(135deg, #dc3545 0%, #fd7e14 100%);
            border-radius: 15px;
            color: white;
        }

        .calculator-header h1 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        .calculator-header p {
            font-size: 1rem;
            opacity: 0.9;
        }

        .calculator-tabs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.5rem;
            margin-bottom: 2rem;
            background: white;
            padding: 0.5rem;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .calculator-tab {
            padding: 1rem 0.5rem;
            border: none;
            border-radius: 10px;
            background: transparent;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .calculator-tab:hover {
            background: rgba(220, 53, 69, 0.1);
        }

        .calculator-tab.active {
            background: linear-gradient(135deg, #dc3545, #fd7e14);
            color: white;
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
        }

        .calculator-section {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            display: none;
        }

        .calculator-section.active {
            display: block;
        }

        .calculation-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
        }

        .input-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
        }

        .result-section {
            background: linear-gradient(135deg, rgba(220, 53, 69, 0.05), rgba(253, 126, 20, 0.05));
            border-radius: 10px;
            padding: 1.5rem;
            border-left: 4px solid #dc3545;
        }

        .input-group {
            margin-bottom: 1.5rem;
        }

        .input-label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #2d3748;
        }

        .calc-input {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .calc-input:focus {
            outline: none;
            border-color: #dc3545;
            box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.1);
        }

        .calc-select {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            background: white;
            font-size: 1rem;
            cursor: pointer;
        }

        .calculate-btn {
            width: 100%;
            padding: 1rem 2rem;
            background: linear-gradient(135deg, #dc3545, #fd7e14);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(220, 53, 69, 0.3);
        }

        .result-display {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1rem;
        }

        .result-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #dc3545;
            margin-bottom: 0.5rem;
        }

        .result-label {
            color: #718096;
            font-size: 0.9rem;
        }

        .formula-display {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-weight: 600;
            color: #856404;
        }

        .step-by-step {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .step {
            margin-bottom: 1rem;
            padding: 0.5rem;
            background: white;
            border-radius: 5px;
            border-left: 3px solid #fd7e14;
        }

        .step-title {
            font-weight: 600;
            color: #dc3545;
            margin-bottom: 0.25rem;
        }

        .common-compounds {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .compound-btn {
            padding: 0.8rem;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 0.9rem;
        }

        .compound-btn:hover {
            border-color: #dc3545;
            background: rgba(220, 53, 69, 0.05);
        }

        /* Desktop Responsive */
        @media (min-width: 768px) {
            .calculator-container {
                padding: 2rem;
            }

            .calculator-header h1 {
                font-size: 2.5rem;
            }

            .calculator-header p {
                font-size: 1.1rem;
            }

            .calculator-tabs {
                grid-template-columns: repeat(8, 1fr);
            }

            .calculation-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (min-width: 1024px) {
            .calculation-grid {
                grid-template-columns: 2fr 1fr;
            }
        }

        /* æ–°å¢æ ·å¼ */
        .ph-indicator {
            background: linear-gradient(90deg, 
                #ff0000 0%, #ff4500 14%, #ffa500 28%, 
                #ffff00 42%, #9acd32 57%, #00ff00 71%, 
                #00ced1 85%, #0000ff 100%);
            height: 30px;
            border-radius: 15px;
            position: relative;
            margin: 1rem 0;
        }

        .ph-marker {
            position: absolute;
            top: -10px;
            width: 4px;
            height: 50px;
            background: #333;
            border-radius: 2px;
            transition: left 0.3s ease;
        }

        .ph-scale {
            display: flex;
            justify-content: space-between;
            margin-top: 0.5rem;
            font-size: 0.8rem;
            color: #666;
        }

        .interactive-demo {
            background: #f0f8ff;
            border: 2px dashed #4169e1;
            border-radius: 10px;
            padding: 1rem;
            margin: 1rem 0;
            text-align: center;
        }

        .demo-button {
            background: linear-gradient(135deg, #4169e1, #6495ed);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            margin: 0.5rem;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .demo-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(65, 105, 225, 0.3);
        }

        .calculation-tip {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .tip-icon {
            color: #ffc107;
            margin-right: 0.5rem;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            display: none;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            display: none;
        }

        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #dc3545;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
            display: none;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* å¢å¼ºçš„å“åº”å¼è®¾è®¡ */
        @media (max-width: 480px) {
            .calculator-tabs {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.25rem;
            }
            
            .calculator-tab {
                padding: 0.8rem 0.25rem;
                font-size: 0.8rem;
            }
            
            .common-compounds {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .compound-btn {
                font-size: 0.8rem;
                padding: 0.6rem;
            }
        }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="../../index.html">
                        <i class="fas fa-graduation-cap" style="background: linear-gradient(90deg, #4361ee, #7209b7); -webkit-background-clip: text; background-clip: text; color: transparent;"></i>
                        <span>Alexçš„å­¦ä¹ åŠ©æ‰‹</span>
                    </a>
                </div>
                <nav class="main-nav">
                    <ul>
                        <li><a href="../../index.html">é¦–é¡µ</a></li>
                        <li><a href="main.html">åŒ–å­¦</a></li>
                        <li><a href="../../tts.html">è¯­éŸ³</a></li>
                        <li><a href="../../draw.html">ç»˜å›¾</a></li>
                    </ul>
                </nav>
                <button class="mobile-menu-toggle" aria-label="åˆ‡æ¢èœå•">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </header>

    <main class="calculator-container">
        <div class="calculator-header">
            <h1><i class="fas fa-calculator"></i> åŒ–å­¦è®¡ç®—å·¥å…·</h1>
            <p>è¿›è¡Œæ‘©å°”è®¡ç®—ã€æµ“åº¦æ¢ç®—ã€åŒ–å­¦è®¡é‡å­¦ç­‰å¸¸ç”¨åŒ–å­¦è®¡ç®—</p>
            
            <!-- å­¦ä¹ æŒ‡å— -->
            <div class="interactive-demo" style="margin-top: 2rem;">
                <h4>ğŸ“š å­¦ä¹ æŒ‡å— - åˆé«˜ä¸­åŒ–å­¦è®¡ç®—å¿…å¤‡æŠ€èƒ½</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem;">
                    <div class="calculation-tip" style="margin: 0;">
                        <strong>ğŸ§ª æ‘©å°”æµ“åº¦</strong><br>
                        <small>é…åˆ¶æº¶æ¶²ã€åŒ–å­¦ååº”è®¡ç®—çš„åŸºç¡€</small>
                    </div>
                    <div class="calculation-tip" style="margin: 0;">
                        <strong>âš–ï¸ åŒ–å­¦è®¡é‡å­¦</strong><br>
                        <small>è®¡ç®—ååº”ç‰©ç”¨é‡ã€äº§ç‰©äº§é‡</small>
                    </div>
                    <div class="calculation-tip" style="margin: 0;">
                        <strong>ğŸŒ¡ï¸ pHè®¡ç®—</strong><br>
                        <small>é…¸ç¢±æ€§è´¨åˆ¤æ–­ã€ä¸­å’Œååº”</small>
                    </div>
                    <div class="calculation-tip" style="margin: 0;">
                        <strong>ğŸ’¨ æ°”ä½“å®šå¾‹</strong><br>
                        <small>æ°”ä½“å‹å¼ºã€ä½“ç§¯ã€æ¸©åº¦å…³ç³»</small>
                    </div>
                    <div class="calculation-tip" style="margin: 0;">
                        <strong>ğŸ’§ æº¶è§£åº¦</strong><br>
                        <small>ç»“æ™¶æå‡ºã€é¥±å’Œæº¶æ¶²è®¡ç®—</small>
                    </div>
                    <div class="calculation-tip" style="margin: 0;">
                        <strong>â±ï¸ ååº”é€Ÿç‡</strong><br>
                        <small>åŒ–å­¦ååº”å¿«æ…¢çš„å®šé‡æè¿°</small>
                    </div>
                </div>
                <p style="margin-top: 1rem; color: #666;">
                    ğŸ’¡ å°æç¤ºï¼šæ¯ä¸ªè®¡ç®—æ¨¡å—éƒ½åŒ…å«è¯¦ç»†æ­¥éª¤å’Œå®ä¾‹ï¼Œé€‚åˆåˆä¸­ã€é«˜ä¸­å­¦ç”Ÿå­¦ä¹ ä½¿ç”¨
                </p>
            </div>
        </div>

        <!-- è®¡ç®—å™¨æ ‡ç­¾ -->
        <div class="calculator-tabs">
            <button class="calculator-tab active" data-tab="molarity">æ‘©å°”æµ“åº¦</button>
            <button class="calculator-tab" data-tab="stoichiometry">åŒ–å­¦è®¡é‡å­¦</button>
            <button class="calculator-tab" data-tab="composition">ç»„æˆè®¡ç®—</button>
            <button class="calculator-tab" data-tab="gas">æ°”ä½“å®šå¾‹</button>
            <button class="calculator-tab" data-tab="dilution">ç¨€é‡Šè®¡ç®—</button>
            <button class="calculator-tab" data-tab="ph">pHè®¡ç®—</button>
            <button class="calculator-tab" data-tab="solubility">æº¶è§£åº¦</button>
            <button class="calculator-tab" data-tab="rate">ååº”é€Ÿç‡</button>
        </div>

        <!-- æ‘©å°”æµ“åº¦è®¡ç®—å™¨ -->
        <div class="calculator-section active" id="molarity">
            <h3><i class="fas fa-flask"></i> æ‘©å°”æµ“åº¦è®¡ç®—</h3>
            <div class="formula-display">
                M = n / V  æˆ–  M = m / (MW Ã— V)
            </div>
            
            <div class="calculation-grid">
                <div class="input-section">
                    <div class="input-group">
                        <label class="input-label">è®¡ç®—ç±»å‹</label>
                        <select id="molarityType" class="calc-select">
                            <option value="molarity">è®¡ç®—æ‘©å°”æµ“åº¦ (M)</option>
                            <option value="moles">è®¡ç®—æ‘©å°”æ•° (n)</option>
                            <option value="volume">è®¡ç®—ä½“ç§¯ (V)</option>
                            <option value="mass">è®¡ç®—è´¨é‡ (m)</option>
                        </select>
                    </div>

                    <div id="molarityInputs">
                        <div class="input-group">
                            <label class="input-label">è´¨é‡ (g)</label>
                            <input type="number" id="mass" class="calc-input" placeholder="è¾“å…¥è´¨é‡">
                        </div>
                        <div class="input-group">
                            <label class="input-label">åˆ†å­é‡ (g/mol)</label>
                            <input type="number" id="molecularWeight" class="calc-input" placeholder="è¾“å…¥åˆ†å­é‡">
                        </div>
                        <div class="input-group">
                            <label class="input-label">ä½“ç§¯ (L)</label>
                            <input type="number" id="volume" class="calc-input" placeholder="è¾“å…¥ä½“ç§¯">
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">å¸¸è§åŒ–åˆç‰©</label>
                        <div class="common-compounds">
                            <button class="compound-btn" onclick="setCompound('NaCl', 58.44)">NaCl</button>
                            <button class="compound-btn" onclick="setCompound('H2SO4', 98.08)">Hâ‚‚SOâ‚„</button>
                            <button class="compound-btn" onclick="setCompound('CaCl2', 110.98)">CaClâ‚‚</button>
                            <button class="compound-btn" onclick="setCompound('NaOH', 40.00)">NaOH</button>
                        </div>
                    </div>

                    <!-- è€ƒè¯•çœŸé¢˜ç¤ºä¾‹ -->
                    <div class="interactive-demo">
                        <h5>ğŸ“ è€ƒè¯•çœŸé¢˜ç»ƒä¹ </h5>
                        <button class="demo-button" onclick="examExample('molarity', 1)">çœŸé¢˜1: é…åˆ¶NaClæº¶æ¶²</button>
                        <button class="demo-button" onclick="examExample('molarity', 2)">çœŸé¢˜2: ç¨€é‡Šæµ“ç¡«é…¸</button>
                        <button class="demo-button" onclick="examExample('molarity', 3)">çœŸé¢˜3: ååº”æ¶ˆè€—è®¡ç®—</button>
                    </div>

                    <button class="calculate-btn" onclick="calculateMolarity()">
                        <i class="fas fa-calculator"></i> è®¡ç®—
                    </button>
                </div>

                <div class="result-section">
                    <h4><i class="fas fa-chart-bar"></i> è®¡ç®—ç»“æœ</h4>
                    <div class="result-display" id="molarityResult">
                        <div class="result-value" id="molarityValue">-</div>
                        <div class="result-label" id="molarityLabel">æ‘©å°”æµ“åº¦ (M)</div>
                    </div>
                    <div class="step-by-step" id="molaritySteps" style="display: none;">
                        <!-- è®¡ç®—æ­¥éª¤å°†åŠ¨æ€æ·»åŠ  -->
                    </div>
                </div>
            </div>
        </div>

        <!-- åŒ–å­¦è®¡é‡å­¦è®¡ç®—å™¨ -->
        <div class="calculator-section" id="stoichiometry">
            <h3><i class="fas fa-balance-scale"></i> åŒ–å­¦è®¡é‡å­¦è®¡ç®—</h3>
            <div class="formula-display">
                molâ‚ / coeffâ‚ = molâ‚‚ / coeffâ‚‚
            </div>
            
            <div class="calculation-grid">
                <div class="input-section">
                    <div class="input-group">
                        <label class="input-label">åŒ–å­¦æ–¹ç¨‹å¼</label>
                        <input type="text" id="equation" class="calc-input" placeholder="ä¾‹å¦‚: 2H2 + O2 â†’ 2H2O">
                    </div>

                    <div class="input-group">
                        <label class="input-label">å·²çŸ¥ç‰©è´¨</label>
                        <select id="knownSubstance" class="calc-select">
                            <option value="">é€‰æ‹©å·²çŸ¥ç‰©è´¨</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label class="input-label">å·²çŸ¥é‡ (mol)</label>
                        <input type="number" id="knownAmount" class="calc-input" placeholder="è¾“å…¥å·²çŸ¥æ‘©å°”æ•°">
                    </div>

                    <div class="input-group">
                        <label class="input-label">ç›®æ ‡ç‰©è´¨</label>
                        <select id="targetSubstance" class="calc-select">
                            <option value="">é€‰æ‹©ç›®æ ‡ç‰©è´¨</option>
                        </select>
                    </div>

                    <button class="calculate-btn" onclick="calculateStoichiometry()">
                        <i class="fas fa-calculator"></i> è®¡ç®—
                    </button>
                </div>

                <div class="result-section">
                    <h4><i class="fas fa-chart-bar"></i> è®¡ç®—ç»“æœ</h4>
                    <div class="result-display" id="stoichiometryResult">
                        <div class="result-value" id="stoichiometryValue">-</div>
                        <div class="result-label" id="stoichiometryLabel">ç›®æ ‡ç‰©è´¨æ‘©å°”æ•° (mol)</div>
                    </div>
                    <div class="step-by-step" id="stoichiometrySteps" style="display: none;">
                        <!-- è®¡ç®—æ­¥éª¤å°†åŠ¨æ€æ·»åŠ  -->
                    </div>
                </div>
            </div>
        </div>

        <!-- ç»„æˆè®¡ç®—å™¨ -->
        <div class="calculator-section" id="composition">
            <h3><i class="fas fa-pie-chart"></i> ç™¾åˆ†ç»„æˆè®¡ç®—</h3>
            <div class="formula-display">
                %æˆåˆ† = (åŸå­è´¨é‡ Ã— åŸå­æ•°) / åˆ†å­é‡ Ã— 100%
            </div>
            
            <div class="calculation-grid">
                <div class="input-section">
                    <div class="input-group">
                        <label class="input-label">åŒ–å­¦å¼</label>
                        <input type="text" id="formula" class="calc-input" placeholder="ä¾‹å¦‚: H2SO4">
                    </div>

                    <div class="input-group">
                        <label class="input-label">æˆ–æ‰‹åŠ¨è¾“å…¥å…ƒç´ </label>
                        <div id="elementsInput">
                            <div class="element-row" style="display: grid; grid-template-columns: 1fr 1fr auto; gap: 0.5rem; margin-bottom: 0.5rem;">
                                <input type="text" class="calc-input element-symbol" placeholder="å…ƒç´ ç¬¦å·">
                                <input type="number" class="calc-input element-count" placeholder="åŸå­æ•°">
                                <button class="calculate-btn" style="width: auto; padding: 0.5rem;" onclick="addElement()">+</button>
                            </div>
                        </div>
                    </div>

                    <button class="calculate-btn" onclick="calculateComposition()">
                        <i class="fas fa-calculator"></i> è®¡ç®—
                    </button>
                </div>

                <div class="result-section">
                    <h4><i class="fas fa-chart-bar"></i> ç»„æˆåˆ†æ</h4>
                    <div class="result-display" id="compositionResult">
                        <div class="result-value" id="molecularWeightValue">-</div>
                        <div class="result-label">åˆ†å­é‡ (g/mol)</div>
                    </div>
                    <div id="elementComposition" style="margin-top: 1rem;">
                        <!-- å…ƒç´ ç»„æˆå°†åŠ¨æ€æ·»åŠ  -->
                    </div>
                </div>
            </div>
        </div>

        <!-- æ°”ä½“å®šå¾‹è®¡ç®—å™¨ -->
        <div class="calculator-section" id="gas">
            <h3><i class="fas fa-wind"></i> ç†æƒ³æ°”ä½“å®šå¾‹</h3>
            <div class="formula-display">
                PV = nRT  (R = 0.08206 LÂ·atm/molÂ·K)
            </div>
            
            <div class="calculation-grid">
                <div class="input-section">
                    <div class="input-group">
                        <label class="input-label">è®¡ç®—ç±»å‹</label>
                        <select id="gasType" class="calc-select">
                            <option value="pressure">è®¡ç®—å‹å¼º (P)</option>
                            <option value="volume">è®¡ç®—ä½“ç§¯ (V)</option>
                            <option value="moles">è®¡ç®—æ‘©å°”æ•° (n)</option>
                            <option value="temperature">è®¡ç®—æ¸©åº¦ (T)</option>
                        </select>
                    </div>

                    <div id="gasInputs">
                        <div class="input-group">
                            <label class="input-label">å‹å¼º (atm)</label>
                            <input type="number" id="pressure" class="calc-input" placeholder="è¾“å…¥å‹å¼º">
                        </div>
                        <div class="input-group">
                            <label class="input-label">ä½“ç§¯ (L)</label>
                            <input type="number" id="gasVolume" class="calc-input" placeholder="è¾“å…¥ä½“ç§¯">
                        </div>
                        <div class="input-group">
                            <label class="input-label">æ‘©å°”æ•° (mol)</label>
                            <input type="number" id="gasMoles" class="calc-input" placeholder="è¾“å…¥æ‘©å°”æ•°">
                        </div>
                        <div class="input-group">
                            <label class="input-label">æ¸©åº¦ (K)</label>
                            <input type="number" id="temperature" class="calc-input" placeholder="è¾“å…¥æ¸©åº¦">
                        </div>
                    </div>

                    <button class="calculate-btn" onclick="calculateGas()">
                        <i class="fas fa-calculator"></i> è®¡ç®—
                    </button>
                </div>

                <div class="result-section">
                    <h4><i class="fas fa-chart-bar"></i> è®¡ç®—ç»“æœ</h4>
                    <div class="result-display" id="gasResult">
                        <div class="result-value" id="gasValue">-</div>
                        <div class="result-label" id="gasLabel">-</div>
                    </div>
                    <div class="step-by-step" id="gasSteps" style="display: none;">
                        <!-- è®¡ç®—æ­¥éª¤å°†åŠ¨æ€æ·»åŠ  -->
                    </div>
                </div>
            </div>
        </div>

        <!-- ç¨€é‡Šè®¡ç®—å™¨ -->
        <div class="calculator-section" id="dilution">
            <h3><i class="fas fa-tint"></i> ç¨€é‡Šè®¡ç®—</h3>
            <div class="formula-display">
                Mâ‚Vâ‚ = Mâ‚‚Vâ‚‚
            </div>
            
            <div class="calculation-grid">
                <div class="input-section">
                    <div class="input-group">
                        <label class="input-label">åˆå§‹æµ“åº¦ (M)</label>
                        <input type="number" id="initialConcentration" class="calc-input" placeholder="è¾“å…¥åˆå§‹æµ“åº¦">
                    </div>

                    <div class="input-group">
                        <label class="input-label">åˆå§‹ä½“ç§¯ (mL)</label>
                        <input type="number" id="initialVolume" class="calc-input" placeholder="è¾“å…¥åˆå§‹ä½“ç§¯">
                    </div>

                    <div class="input-group">
                        <label class="input-label">æœ€ç»ˆæµ“åº¦ (M)</label>
                        <input type="number" id="finalConcentration" class="calc-input" placeholder="è¾“å…¥æœ€ç»ˆæµ“åº¦">
                    </div>

                    <div class="input-group">
                        <label class="input-label">æœ€ç»ˆä½“ç§¯ (mL)</label>
                        <input type="number" id="finalVolume" class="calc-input" placeholder="è¾“å…¥æœ€ç»ˆä½“ç§¯">
                    </div>

                    <div class="input-group">
                        <label class="input-label">è®¡ç®—ç±»å‹</label>
                        <select id="dilutionType" class="calc-select">
                            <option value="finalVolume">è®¡ç®—æœ€ç»ˆä½“ç§¯</option>
                            <option value="finalConcentration">è®¡ç®—æœ€ç»ˆæµ“åº¦</option>
                            <option value="initialVolume">è®¡ç®—æ‰€éœ€åˆå§‹ä½“ç§¯</option>
                            <option value="waterVolume">è®¡ç®—æ‰€éœ€åŠ æ°´ä½“ç§¯</option>
                        </select>
                    </div>

                    <button class="calculate-btn" onclick="calculateDilution()">
                        <i class="fas fa-calculator"></i> è®¡ç®—
                    </button>
                </div>

                <div class="result-section">
                    <h4><i class="fas fa-chart-bar"></i> ç¨€é‡Šç»“æœ</h4>
                    <div class="result-display" id="dilutionResult">
                        <div class="result-value" id="dilutionValue">-</div>
                        <div class="result-label" id="dilutionLabel">-</div>
                    </div>
                    <div class="step-by-step" id="dilutionSteps" style="display: none;">
                        <!-- è®¡ç®—æ­¥éª¤å°†åŠ¨æ€æ·»åŠ  -->
                    </div>
                </div>
            </div>
        </div>

        <!-- pHè®¡ç®—å™¨ -->
        <div class="calculator-section" id="ph">
            <h3><i class="fas fa-test-tube"></i> pH & pOH è®¡ç®—</h3>
            <div class="formula-display">
                pH = -log[Hâº]  |  pOH = -log[OHâ»]  |  pH + pOH = 14
            </div>
            
            <div class="calculation-grid">
                <div class="input-section">
                    <div class="input-group">
                        <label class="input-label">è®¡ç®—ç±»å‹</label>
                        <select id="phType" class="calc-select">
                            <option value="fromH">ä»Hâºæµ“åº¦è®¡ç®—pH</option>
                            <option value="fromOH">ä»OHâ»æµ“åº¦è®¡ç®—pOH</option>
                            <option value="toPH">ä»pHè®¡ç®—Hâºæµ“åº¦</option>
                            <option value="toPOH">ä»pOHè®¡ç®—OHâ»æµ“åº¦</option>
                            <option value="acidBase">é…¸ç¢±ä¸­å’Œè®¡ç®—</option>
                        </select>
                    </div>

                    <div id="phInputs">
                        <div class="input-group">
                            <label class="input-label">Hâºæµ“åº¦ (mol/L)</label>
                            <input type="number" id="hConcentration" class="calc-input" placeholder="è¾“å…¥Hâºæµ“åº¦" step="any">
                        </div>
                        <div class="input-group">
                            <label class="input-label">OHâ»æµ“åº¦ (mol/L)</label>
                            <input type="number" id="ohConcentration" class="calc-input" placeholder="è¾“å…¥OHâ»æµ“åº¦" step="any">
                        </div>
                        <div class="input-group">
                            <label class="input-label">pHå€¼</label>
                            <input type="number" id="phValue" class="calc-input" placeholder="è¾“å…¥pHå€¼" step="0.01">
                        </div>
                        <div class="input-group">
                            <label class="input-label">pOHå€¼</label>
                            <input type="number" id="pohValue" class="calc-input" placeholder="è¾“å…¥pOHå€¼" step="0.01">
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">å¸¸è§é…¸ç¢±</label>
                        <div class="common-compounds">
                            <button class="compound-btn" onclick="setAcidBase('HCl', 'strong_acid')">HCl</button>
                            <button class="compound-btn" onclick="setAcidBase('NaOH', 'strong_base')">NaOH</button>
                            <button class="compound-btn" onclick="setAcidBase('CH3COOH', 'weak_acid')">CHâ‚ƒCOOH</button>
                            <button class="compound-btn" onclick="setAcidBase('NH3', 'weak_base')">NHâ‚ƒ</button>
                        </div>
                    </div>

                    <button class="calculate-btn" onclick="calculatePH()">
                        <i class="fas fa-calculator"></i> è®¡ç®—
                    </button>
                </div>

                <div class="result-section">
                    <h4><i class="fas fa-chart-bar"></i> pHç»“æœ</h4>
                    <div class="result-display" id="phResult">
                        <div class="result-value" id="phResultValue">-</div>
                        <div class="result-label" id="phResultLabel">pHå€¼</div>
                    </div>
                    <div class="result-display" id="solutionType" style="margin-top: 1rem;">
                        <div class="result-value" id="solutionTypeValue" style="font-size: 1.2rem;">-</div>
                        <div class="result-label">æº¶æ¶²æ€§è´¨</div>
                    </div>
                    
                    <!-- pHå¯è§†åŒ–æŒ‡ç¤ºå™¨ -->
                    <div class="ph-indicator">
                        <div class="ph-marker" id="phMarker"></div>
                    </div>
                    <div class="ph-scale">
                        <span>0</span><span>1</span><span>2</span><span>3</span><span>4</span><span>5</span><span>6</span>
                        <span>7</span><span>8</span><span>9</span><span>10</span><span>11</span><span>12</span><span>13</span><span>14</span>
                    </div>
                    
                    <!-- è®¡ç®—æç¤º -->
                    <div class="calculation-tip">
                        <i class="fas fa-lightbulb tip-icon"></i>
                        <strong>å°è´´å£«ï¼š</strong>pH < 7ä¸ºé…¸æ€§ï¼ŒpH = 7ä¸ºä¸­æ€§ï¼ŒpH > 7ä¸ºç¢±æ€§ã€‚æ¯ä¸ªpHå•ä½ä»£è¡¨æ°¢ç¦»å­æµ“åº¦10å€çš„å˜åŒ–ã€‚
                    </div>
                    
                    <!-- äº¤äº’å¼ç¤ºä¾‹ -->
                    <div class="interactive-demo">
                        <h5>ğŸ§ª è¯•è¯•è¿™äº›ä¾‹å­ï¼š</h5>
                        <button class="demo-button" onclick="demoCalculation('ph', 'lemon')">æŸ æª¬æ± (pHâ‰ˆ2)</button>
                        <button class="demo-button" onclick="demoCalculation('ph', 'water')">çº¯æ°´ (pH=7)</button>
                        <button class="demo-button" onclick="demoCalculation('ph', 'soap')">è‚¥çš‚æ°´ (pHâ‰ˆ9)</button>
                    </div>
                    
                    <div class="step-by-step" id="phSteps" style="display: none;">
                        <!-- è®¡ç®—æ­¥éª¤å°†åŠ¨æ€æ·»åŠ  -->
                    </div>
                </div>
            </div>
        </div>

        <!-- æº¶è§£åº¦è®¡ç®—å™¨ -->
        <div class="calculator-section" id="solubility">
            <h3><i class="fas fa-flask-vial"></i> æº¶è§£åº¦è®¡ç®—</h3>
            <div class="formula-display">
                æº¶è§£åº¦ = æº¶è´¨è´¨é‡ / æº¶å‰‚è´¨é‡ Ã— 100g
            </div>
            
            <div class="calculation-grid">
                <div class="input-section">
                    <div class="input-group">
                        <label class="input-label">è®¡ç®—ç±»å‹</label>
                        <select id="solubilityType" class="calc-select">
                            <option value="solubility">è®¡ç®—æº¶è§£åº¦</option>
                            <option value="saturated">é¥±å’Œæº¶æ¶²è®¡ç®—</option>
                            <option value="crystallization">ç»“æ™¶æå‡ºè®¡ç®—</option>
                            <option value="solubilityProduct">æº¶åº¦ç§¯è®¡ç®—</option>
                        </select>
                    </div>

                    <div id="solubilityInputs">
                        <div class="input-group">
                            <label class="input-label">æº¶è´¨è´¨é‡ (g)</label>
                            <input type="number" id="soluteMass" class="calc-input" placeholder="è¾“å…¥æº¶è´¨è´¨é‡">
                        </div>
                        <div class="input-group">
                            <label class="input-label">æº¶å‰‚è´¨é‡ (g)</label>
                            <input type="number" id="solventMass" class="calc-input" placeholder="è¾“å…¥æº¶å‰‚è´¨é‡">
                        </div>
                        <div class="input-group">
                            <label class="input-label">æ¸©åº¦ (Â°C)</label>
                            <input type="number" id="temperature" class="calc-input" placeholder="è¾“å…¥æ¸©åº¦" value="20">
                        </div>
                        <div class="input-group">
                            <label class="input-label">æº¶è§£åº¦ (g/100gæ°´)</label>
                            <input type="number" id="givenSolubility" class="calc-input" placeholder="è¾“å…¥å·²çŸ¥æº¶è§£åº¦">
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">å¸¸è§ç‰©è´¨æº¶è§£åº¦(20Â°C)</label>
                        <div class="common-compounds">
                            <button class="compound-btn" onclick="setSolubility('NaCl', 36.0)">NaCl (36g)</button>
                            <button class="compound-btn" onclick="setSolubility('KNO3', 31.6)">KNOâ‚ƒ (31.6g)</button>
                            <button class="compound-btn" onclick="setSolubility('NH4Cl', 37.2)">NHâ‚„Cl (37.2g)</button>
                            <button class="compound-btn" onclick="setSolubility('CaCl2', 74.5)">CaClâ‚‚ (74.5g)</button>
                        </div>
                    </div>

                    <button class="calculate-btn" onclick="calculateSolubility()">
                        <i class="fas fa-calculator"></i> è®¡ç®—
                    </button>
                </div>

                <div class="result-section">
                    <h4><i class="fas fa-chart-bar"></i> æº¶è§£åº¦ç»“æœ</h4>
                    <div class="result-display" id="solubilityResult">
                        <div class="result-value" id="solubilityValue">-</div>
                        <div class="result-label" id="solubilityLabel">æº¶è§£åº¦ (g/100gæ°´)</div>
                    </div>
                    <div class="step-by-step" id="solubilitySteps" style="display: none;">
                        <!-- è®¡ç®—æ­¥éª¤å°†åŠ¨æ€æ·»åŠ  -->
                    </div>
                </div>
            </div>
        </div>

        <!-- ååº”é€Ÿç‡è®¡ç®—å™¨ -->
        <div class="calculator-section" id="rate">
            <h3><i class="fas fa-stopwatch"></i> åŒ–å­¦ååº”é€Ÿç‡è®¡ç®—</h3>
            <div class="formula-display">
                v = Î”c/Î”t  |  Arrheniusæ–¹ç¨‹: k = AÂ·e^(-Ea/RT)
            </div>
            
            <div class="calculation-grid">
                <div class="input-section">
                    <div class="input-group">
                        <label class="input-label">è®¡ç®—ç±»å‹</label>
                        <select id="rateType" class="calc-select">
                            <option value="averageRate">å¹³å‡ååº”é€Ÿç‡</option>
                            <option value="concentration">æµ“åº¦å˜åŒ–è®¡ç®—</option>
                            <option value="halfLife">åŠè¡°æœŸè®¡ç®—</option>
                            <option value="temperature">æ¸©åº¦æ•ˆåº”</option>
                        </select>
                    </div>

                    <div id="rateInputs">
                        <div class="input-group">
                            <label class="input-label">åˆå§‹æµ“åº¦ (mol/L)</label>
                            <input type="number" id="initialConc" class="calc-input" placeholder="è¾“å…¥åˆå§‹æµ“åº¦">
                        </div>
                        <div class="input-group">
                            <label class="input-label">æœ€ç»ˆæµ“åº¦ (mol/L)</label>
                            <input type="number" id="finalConc" class="calc-input" placeholder="è¾“å…¥æœ€ç»ˆæµ“åº¦">
                        </div>
                        <div class="input-group">
                            <label class="input-label">æ—¶é—´é—´éš” (s)</label>
                            <input type="number" id="timeInterval" class="calc-input" placeholder="è¾“å…¥æ—¶é—´é—´éš”">
                        </div>
                        <div class="input-group">
                            <label class="input-label">ååº”çº§æ•°</label>
                            <select id="reactionOrder" class="calc-select">
                                <option value="0">é›¶çº§ååº”</option>
                                <option value="1">ä¸€çº§ååº”</option>
                                <option value="2">äºŒçº§ååº”</option>
                            </select>
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">æ¸©åº¦å½±å“è®¡ç®—</label>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                            <input type="number" id="temp1" class="calc-input" placeholder="åˆå§‹æ¸©åº¦(K)">
                            <input type="number" id="temp2" class="calc-input" placeholder="æœ€ç»ˆæ¸©åº¦(K)">
                        </div>
                    </div>

                    <button class="calculate-btn" onclick="calculateRate()">
                        <i class="fas fa-calculator"></i> è®¡ç®—
                    </button>
                </div>

                <div class="result-section">
                    <h4><i class="fas fa-chart-bar"></i> ååº”é€Ÿç‡ç»“æœ</h4>
                    <div class="result-display" id="rateResult">
                        <div class="result-value" id="rateValue">-</div>
                        <div class="result-label" id="rateLabel">ååº”é€Ÿç‡ (mol/LÂ·s)</div>
                    </div>
                    <div class="step-by-step" id="rateSteps" style="display: none;">
                        <!-- è®¡ç®—æ­¥éª¤å°†åŠ¨æ€æ·»åŠ  -->
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- åŠŸèƒ½ç‰¹è‰²è¯´æ˜ -->
    <div style="background: #f8f9fa; padding: 2rem; margin-top: 2rem;">
        <div class="calculator-container">
            <h3 style="text-align: center; margin-bottom: 2rem; color: #dc3545;">
                <i class="fas fa-star"></i> æ–°å¢åŠŸèƒ½ç‰¹è‰²
            </h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">
                <div class="calculation-tip">
                    <h4><i class="fas fa-test-tube"></i> pHè®¡ç®—å™¨</h4>
                    <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
                        <li>å¯è§†åŒ–pHæŒ‡ç¤ºå™¨ï¼Œç›´è§‚æ˜¾ç¤ºé…¸ç¢±æ€§</li>
                        <li>æ”¯æŒHâºã€OHâ»æµ“åº¦ä¸pHå€¼äº’ç›¸è½¬æ¢</li>
                        <li>åŒ…å«å¸¸è§ç‰©è´¨pHå€¼ç¤ºä¾‹</li>
                        <li>è¯¦ç»†è®¡ç®—æ­¥éª¤å’ŒåŒ–å­¦åŸç†è§£é‡Š</li>
                    </ul>
                </div>
                <div class="calculation-tip">
                    <h4><i class="fas fa-flask-vial"></i> æº¶è§£åº¦è®¡ç®—å™¨</h4>
                    <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
                        <li>æº¶è§£åº¦ã€é¥±å’Œæº¶æ¶²ã€ç»“æ™¶æå‡ºè®¡ç®—</li>
                        <li>å¸¸è§ç‰©è´¨æº¶è§£åº¦æ•°æ®åº“</li>
                        <li>æ¸©åº¦å¯¹æº¶è§£åº¦å½±å“çš„è€ƒè™‘</li>
                        <li>å®é™…ç»“æ™¶æ“ä½œæŒ‡å¯¼</li>
                    </ul>
                </div>
                <div class="calculation-tip">
                    <h4><i class="fas fa-stopwatch"></i> ååº”é€Ÿç‡è®¡ç®—å™¨</h4>
                    <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
                        <li>å¹³å‡ååº”é€Ÿç‡ã€åŠè¡°æœŸè®¡ç®—</li>
                        <li>é›¶çº§ã€ä¸€çº§ã€äºŒçº§ååº”åŠ¨åŠ›å­¦</li>
                        <li>æ¸©åº¦å¯¹ååº”é€Ÿç‡çš„å½±å“</li>
                        <li>èŒƒç‰¹éœå¤«è§„åˆ™åº”ç”¨</li>
                    </ul>
                </div>
                <div class="calculation-tip">
                    <h4><i class="fas fa-graduation-cap"></i> è€ƒè¯•çœŸé¢˜ç»ƒä¹ </h4>
                    <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
                        <li>ä¸­é«˜è€ƒåŒ–å­¦è®¡ç®—çœŸé¢˜ç¤ºä¾‹</li>
                        <li>åˆ†æ­¥è§£é¢˜è¿‡ç¨‹å±•ç¤º</li>
                        <li>å¸¸è€ƒçŸ¥è¯†ç‚¹è¦†ç›–</li>
                        <li>äº’åŠ¨å¼å­¦ä¹ ä½“éªŒ</li>
                    </ul>
                </div>
                <div class="calculation-tip">
                    <h4><i class="fas fa-mobile-alt"></i> å“åº”å¼è®¾è®¡</h4>
                    <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
                        <li>å®Œç¾é€‚é…æ‰‹æœºã€å¹³æ¿ã€ç”µè„‘</li>
                        <li>è§¦æ§ä¼˜åŒ–ï¼Œæ“ä½œæµç•…</li>
                        <li>é”®ç›˜å¿«æ·é”®æ”¯æŒ</li>
                        <li>ç¦»çº¿ä½¿ç”¨åŠŸèƒ½</li>
                    </ul>
                </div>
                <div class="calculation-tip">
                    <h4><i class="fas fa-lightbulb"></i> æ™ºèƒ½å­¦ä¹ åŠ©æ‰‹</h4>
                    <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
                        <li>é”™è¯¯æç¤ºå’Œè¾“å…¥éªŒè¯</li>
                        <li>å­¦ä¹ è´´å£«å’ŒåŒ–å­¦çŸ¥è¯†ç‚¹</li>
                        <li>å…¬å¼æ¨å¯¼è¿‡ç¨‹å±•ç¤º</li>
                        <li>å®éªŒæ“ä½œå®‰å…¨æé†’</li>
                    </ul>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 2rem; padding: 1rem; background: #e3f2fd; border-radius: 10px;">
                <h4 style="color: #1976d2; margin-bottom: 1rem;">
                    <i class="fas fa-rocket"></i> è®©åŒ–å­¦å­¦ä¹ æ›´é«˜æ•ˆã€æ›´æœ‰è¶£ï¼
                </h4>
                <p style="color: #666; margin: 0;">
                    æ¶µç›–åˆé«˜ä¸­åŒ–å­¦è®¡ç®—çš„å„ä¸ªæ–¹é¢ï¼Œä»åŸºç¡€çš„æ‘©å°”æµ“åº¦åˆ°å¤æ‚çš„ååº”é€Ÿç‡ï¼Œ
                    æ¯ä¸ªåŠŸèƒ½éƒ½ç»è¿‡ç²¾å¿ƒè®¾è®¡ï¼Œç¡®ä¿å­¦ç”Ÿèƒ½å¤Ÿè½»æ¾æŒæ¡åŒ–å­¦è®¡ç®—æŠ€èƒ½ã€‚
                </p>
            </div>
        </div>
    </div>

    <footer class="main-footer">
        <div class="container">
            <div class="footer-content">
                <p class="copyright-text">study-llm.meåŸŸåä¸ºAlexæ‰€æœ‰ã€‚ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚</p>
                <div class="profile-section">
                    <button id="profile-button" class="profile-button">
                        <i class="fas fa-user-circle"></i>
                        å­¦ä¹ é˜¶æ®µ
                    </button>
                    <div id="profile-display" class="profile-display"></div>
                </div>
            </div>
        </div>
    </footer>

    <script src="../../js/common.js"></script>
    <script src="../../js/navigation.js"></script>
    <script src="../../js/profile.js"></script>
    <script>
        // å…ƒç´ åŸå­é‡æ•°æ®
        const atomicWeights = {
            'H': 1.008, 'He': 4.003, 'Li': 6.941, 'Be': 9.012, 'B': 10.811, 'C': 12.011,
            'N': 14.007, 'O': 15.999, 'F': 18.998, 'Ne': 20.180, 'Na': 22.990, 'Mg': 24.305,
            'Al': 26.982, 'Si': 28.086, 'P': 30.974, 'S': 32.065, 'Cl': 35.453, 'Ar': 39.948,
            'K': 39.098, 'Ca': 40.078, 'Sc': 44.956, 'Ti': 47.867, 'V': 50.942, 'Cr': 51.996,
            'Mn': 54.938, 'Fe': 55.845, 'Co': 58.933, 'Ni': 58.693, 'Cu': 63.546, 'Zn': 65.38,
            'Ga': 69.723, 'Ge': 72.64, 'As': 74.922, 'Se': 78.96, 'Br': 79.904, 'Kr': 83.798,
            'Rb': 85.468, 'Sr': 87.62, 'Y': 88.906, 'Zr': 91.224, 'Nb': 92.906, 'Mo': 95.96,
            'Tc': 98, 'Ru': 101.07, 'Rh': 102.906, 'Pd': 106.42, 'Ag': 107.868, 'Cd': 112.411,
            'In': 114.818, 'Sn': 118.710, 'Sb': 121.760, 'Te': 127.60, 'I': 126.904, 'Xe': 131.293
        };

        // æ ‡ç­¾åˆ‡æ¢
        document.querySelectorAll('.calculator-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.calculator-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.calculator-section').forEach(s => s.classList.remove('active'));
                
                this.classList.add('active');
                document.getElementById(this.dataset.tab).classList.add('active');
            });
        });

        // è®¾ç½®åŒ–åˆç‰©æ•°æ®
        function setCompound(formula, mw) {
            document.getElementById('molecularWeight').value = mw;
            // å¯ä»¥æ·»åŠ æ›´å¤šè‡ªåŠ¨å¡«å……é€»è¾‘
        }

        // æ‘©å°”æµ“åº¦è®¡ç®—
        function calculateMolarity() {
            const type = document.getElementById('molarityType').value;
            const mass = parseFloat(document.getElementById('mass').value) || 0;
            const mw = parseFloat(document.getElementById('molecularWeight').value) || 0;
            const volume = parseFloat(document.getElementById('volume').value) || 0;

            let result, steps = [];

            switch(type) {
                case 'molarity':
                    if (mass && mw && volume) {
                        const moles = mass / mw;
                        result = moles / volume;
                        steps = [
                            `æ­¥éª¤1: è®¡ç®—æ‘©å°”æ•° n = m / MW = ${mass} / ${mw} = ${moles.toFixed(4)} mol`,
                            `æ­¥éª¤2: è®¡ç®—æ‘©å°”æµ“åº¦ M = n / V = ${moles.toFixed(4)} / ${volume} = ${result.toFixed(4)} M`
                        ];
                    }
                    break;
                case 'moles':
                    const molarity = parseFloat(document.getElementById('molarity').value) || 0;
                    if (molarity && volume) {
                        result = molarity * volume;
                        steps = [`n = M Ã— V = ${molarity} Ã— ${volume} = ${result.toFixed(4)} mol`];
                    }
                    break;
                // å…¶ä»–è®¡ç®—ç±»å‹...
            }

            if (result !== undefined) {
                document.getElementById('molarityValue').textContent = result.toFixed(4);
                document.getElementById('molaritySteps').innerHTML = steps.map(step => 
                    `<div class="step"><div class="step-title">è®¡ç®—æ­¥éª¤</div>${step}</div>`
                ).join('');
                document.getElementById('molaritySteps').style.display = 'block';
            }
        }

        // åŒ–å­¦è®¡é‡å­¦è®¡ç®—
        function calculateStoichiometry() {
            const equation = document.getElementById('equation').value;
            const knownSubstance = document.getElementById('knownSubstance').value;
            const knownAmount = parseFloat(document.getElementById('knownAmount').value) || 0;
            const targetSubstance = document.getElementById('targetSubstance').value;

            // ç®€åŒ–çš„åŒ–å­¦è®¡é‡å­¦è®¡ç®—é€»è¾‘
            // åœ¨å®é™…åº”ç”¨ä¸­éœ€è¦è§£æåŒ–å­¦æ–¹ç¨‹å¼
            if (knownAmount && knownSubstance && targetSubstance) {
                // å‡è®¾1:1çš„åŒ–å­¦è®¡é‡å…³ç³»ä½œä¸ºç¤ºä¾‹
                const result = knownAmount; // ç®€åŒ–è®¡ç®—
                document.getElementById('stoichiometryValue').textContent = result.toFixed(4);
                
                const steps = [
                    `æ ¹æ®åŒ–å­¦æ–¹ç¨‹å¼: ${equation}`,
                    `å·²çŸ¥ ${knownSubstance}: ${knownAmount} mol`,
                    `ç›®æ ‡ ${targetSubstance}: ${result.toFixed(4)} mol`
                ];
                
                document.getElementById('stoichiometrySteps').innerHTML = steps.map(step => 
                    `<div class="step"><div class="step-title">è®¡ç®—æ­¥éª¤</div>${step}</div>`
                ).join('');
                document.getElementById('stoichiometrySteps').style.display = 'block';
            }
        }

        // ç»„æˆè®¡ç®—
        function calculateComposition() {
            const formula = document.getElementById('formula').value;
            
            if (formula) {
                const composition = parseFormula(formula);
                let totalMW = 0;
                let resultHTML = '';

                for (const [element, count] of Object.entries(composition)) {
                    const atomicWeight = atomicWeights[element] || 0;
                    const elementMass = atomicWeight * count;
                    totalMW += elementMass;
                }

                document.getElementById('molecularWeightValue').textContent = totalMW.toFixed(3);

                for (const [element, count] of Object.entries(composition)) {
                    const atomicWeight = atomicWeights[element] || 0;
                    const elementMass = atomicWeight * count;
                    const percentage = (elementMass / totalMW * 100).toFixed(2);
                    
                    resultHTML += `
                        <div class="step">
                            <div class="step-title">${element}</div>
                            ${count} ä¸ªåŸå­ Ã— ${atomicWeight} g/mol = ${elementMass.toFixed(3)} g/mol (${percentage}%)
                        </div>`;
                }

                document.getElementById('elementComposition').innerHTML = resultHTML;
            }
        }

        // è§£æåŒ–å­¦å¼
        function parseFormula(formula) {
            const composition = {};
            const regex = /([A-Z][a-z]?)(\d*)/g;
            let match;

            while ((match = regex.exec(formula)) !== null) {
                const element = match[1];
                const count = parseInt(match[2]) || 1;
                composition[element] = (composition[element] || 0) + count;
            }

            return composition;
        }

        // æ°”ä½“å®šå¾‹è®¡ç®—
        function calculateGas() {
            const type = document.getElementById('gasType').value;
            const P = parseFloat(document.getElementById('pressure').value) || 0;
            const V = parseFloat(document.getElementById('gasVolume').value) || 0;
            const n = parseFloat(document.getElementById('gasMoles').value) || 0;
            const T = parseFloat(document.getElementById('temperature').value) || 0;
            const R = 0.08206; // LÂ·atm/molÂ·K

            let result, label, steps = [];

            switch(type) {
                case 'pressure':
                    if (n && R && T && V) {
                        result = (n * R * T) / V;
                        label = 'å‹å¼º (atm)';
                        steps = [`P = nRT/V = ${n} Ã— ${R} Ã— ${T} / ${V} = ${result.toFixed(4)} atm`];
                    }
                    break;
                case 'volume':
                    if (n && R && T && P) {
                        result = (n * R * T) / P;
                        label = 'ä½“ç§¯ (L)';
                        steps = [`V = nRT/P = ${n} Ã— ${R} Ã— ${T} / ${P} = ${result.toFixed(4)} L`];
                    }
                    break;
                case 'moles':
                    if (P && V && R && T) {
                        result = (P * V) / (R * T);
                        label = 'æ‘©å°”æ•° (mol)';
                        steps = [`n = PV/RT = ${P} Ã— ${V} / (${R} Ã— ${T}) = ${result.toFixed(4)} mol`];
                    }
                    break;
                case 'temperature':
                    if (P && V && n && R) {
                        result = (P * V) / (n * R);
                        label = 'æ¸©åº¦ (K)';
                        steps = [`T = PV/nR = ${P} Ã— ${V} / (${n} Ã— ${R}) = ${result.toFixed(4)} K`];
                    }
                    break;
            }

            if (result !== undefined) {
                document.getElementById('gasValue').textContent = result.toFixed(4);
                document.getElementById('gasLabel').textContent = label;
                document.getElementById('gasSteps').innerHTML = steps.map(step => 
                    `<div class="step"><div class="step-title">è®¡ç®—æ­¥éª¤</div>${step}</div>`
                ).join('');
                document.getElementById('gasSteps').style.display = 'block';
            }
        }

        // ç¨€é‡Šè®¡ç®—
        function calculateDilution() {
            const type = document.getElementById('dilutionType').value;
            const M1 = parseFloat(document.getElementById('initialConcentration').value) || 0;
            const V1 = parseFloat(document.getElementById('initialVolume').value) || 0;
            const M2 = parseFloat(document.getElementById('finalConcentration').value) || 0;
            const V2 = parseFloat(document.getElementById('finalVolume').value) || 0;

            let result, label, steps = [];

            switch(type) {
                case 'finalVolume':
                    if (M1 && V1 && M2) {
                        result = (M1 * V1) / M2;
                        label = 'æœ€ç»ˆä½“ç§¯ (mL)';
                        steps = [
                            `ä½¿ç”¨ç¨€é‡Šå…¬å¼: Mâ‚Vâ‚ = Mâ‚‚Vâ‚‚`,
                            `Vâ‚‚ = Mâ‚Vâ‚/Mâ‚‚ = ${M1} Ã— ${V1} / ${M2} = ${result.toFixed(2)} mL`
                        ];
                    }
                    break;
                case 'finalConcentration':
                    if (M1 && V1 && V2) {
                        result = (M1 * V1) / V2;
                        label = 'æœ€ç»ˆæµ“åº¦ (M)';
                        steps = [
                            `ä½¿ç”¨ç¨€é‡Šå…¬å¼: Mâ‚Vâ‚ = Mâ‚‚Vâ‚‚`,
                            `Mâ‚‚ = Mâ‚Vâ‚/Vâ‚‚ = ${M1} Ã— ${V1} / ${V2} = ${result.toFixed(4)} M`
                        ];
                    }
                    break;
                case 'initialVolume':
                    if (M1 && M2 && V2) {
                        result = (M2 * V2) / M1;
                        label = 'æ‰€éœ€åˆå§‹ä½“ç§¯ (mL)';
                        steps = [
                            `ä½¿ç”¨ç¨€é‡Šå…¬å¼: Mâ‚Vâ‚ = Mâ‚‚Vâ‚‚`,
                            `Vâ‚ = Mâ‚‚Vâ‚‚/Mâ‚ = ${M2} Ã— ${V2} / ${M1} = ${result.toFixed(2)} mL`
                        ];
                    }
                    break;
                case 'waterVolume':
                    if (M1 && V1 && M2) {
                        const finalVolume = (M1 * V1) / M2;
                        result = finalVolume - V1;
                        label = 'æ‰€éœ€åŠ æ°´ä½“ç§¯ (mL)';
                        steps = [
                            `æœ€ç»ˆä½“ç§¯: Vâ‚‚ = Mâ‚Vâ‚/Mâ‚‚ = ${M1} Ã— ${V1} / ${M2} = ${finalVolume.toFixed(2)} mL`,
                            `åŠ æ°´ä½“ç§¯ = Vâ‚‚ - Vâ‚ = ${finalVolume.toFixed(2)} - ${V1} = ${result.toFixed(2)} mL`
                        ];
                    }
                    break;
            }

            if (result !== undefined) {
                document.getElementById('dilutionValue').textContent = result.toFixed(2);
                document.getElementById('dilutionLabel').textContent = label;
                document.getElementById('dilutionSteps').innerHTML = steps.map(step => 
                    `<div class="step"><div class="step-title">è®¡ç®—æ­¥éª¤</div>${step}</div>`
                ).join('');
                document.getElementById('dilutionSteps').style.display = 'block';
            }
        }

        // æ·»åŠ å…ƒç´ è¾“å…¥è¡Œ
        function addElement() {
            const container = document.getElementById('elementsInput');
            const newRow = document.createElement('div');
            newRow.className = 'element-row';
            newRow.style.cssText = 'display: grid; grid-template-columns: 1fr 1fr auto; gap: 0.5rem; margin-bottom: 0.5rem;';
            newRow.innerHTML = `
                <input type="text" class="calc-input element-symbol" placeholder="å…ƒç´ ç¬¦å·">
                <input type="number" class="calc-input element-count" placeholder="åŸå­æ•°">
                <button class="calculate-btn" style="width: auto; padding: 0.5rem;" onclick="removeElement(this)">-</button>
            `;
            container.appendChild(newRow);
        }

        // ç§»é™¤å…ƒç´ è¾“å…¥è¡Œ
        function removeElement(button) {
            button.parentElement.remove();
        }

        // å“åº”å¼å¤„ç†
        window.addEventListener('resize', function() {
            // å¤„ç†å“åº”å¼å¸ƒå±€å˜åŒ–
        });

        // pHè®¡ç®—
        function calculatePH() {
            const type = document.getElementById('phType').value;
            const hConc = parseFloat(document.getElementById('hConcentration').value) || 0;
            const ohConc = parseFloat(document.getElementById('ohConcentration').value) || 0;
            const ph = parseFloat(document.getElementById('phValue').value) || 0;
            const poh = parseFloat(document.getElementById('pohValue').value) || 0;

            let result, label, steps = [], solutionType = '';

            switch(type) {
                case 'fromH':
                    if (hConc > 0) {
                        result = -Math.log10(hConc);
                        label = 'pHå€¼';
                        steps = [`pH = -log[Hâº] = -log(${hConc}) = ${result.toFixed(2)}`];
                        solutionType = result < 7 ? 'é…¸æ€§' : result > 7 ? 'ç¢±æ€§' : 'ä¸­æ€§';
                    }
                    break;
                case 'fromOH':
                    if (ohConc > 0) {
                        result = -Math.log10(ohConc);
                        const phValue = 14 - result;
                        label = 'pOHå€¼';
                        steps = [
                            `pOH = -log[OHâ»] = -log(${ohConc}) = ${result.toFixed(2)}`,
                            `pH = 14 - pOH = 14 - ${result.toFixed(2)} = ${phValue.toFixed(2)}`
                        ];
                        solutionType = phValue < 7 ? 'é…¸æ€§' : phValue > 7 ? 'ç¢±æ€§' : 'ä¸­æ€§';
                    }
                    break;
                case 'toPH':
                    if (ph >= 0 && ph <= 14) {
                        result = Math.pow(10, -ph);
                        label = 'Hâºæµ“åº¦ (mol/L)';
                        steps = [`[Hâº] = 10^(-pH) = 10^(${-ph}) = ${result.toExponential(2)} mol/L`];
                        solutionType = ph < 7 ? 'é…¸æ€§' : ph > 7 ? 'ç¢±æ€§' : 'ä¸­æ€§';
                    }
                    break;
                case 'toPOH':
                    if (poh >= 0 && poh <= 14) {
                        result = Math.pow(10, -poh);
                        const phValue = 14 - poh;
                        label = 'OHâ»æµ“åº¦ (mol/L)';
                        steps = [
                            `[OHâ»] = 10^(-pOH) = 10^(${-poh}) = ${result.toExponential(2)} mol/L`,
                            `pH = 14 - pOH = 14 - ${poh} = ${phValue.toFixed(2)}`
                        ];
                        solutionType = phValue < 7 ? 'é…¸æ€§' : phValue > 7 ? 'ç¢±æ€§' : 'ä¸­æ€§';
                    }
                    break;
            }

            if (result !== undefined) {
                document.getElementById('phResultValue').textContent = 
                    typeof result === 'number' && result < 0.001 ? result.toExponential(2) : result.toFixed(4);
                document.getElementById('phResultLabel').textContent = label;
                document.getElementById('solutionTypeValue').textContent = solutionType;
                document.getElementById('phSteps').innerHTML = steps.map(step => 
                    `<div class="step"><div class="step-title">è®¡ç®—æ­¥éª¤</div>${step}</div>`
                ).join('');
                document.getElementById('phSteps').style.display = 'block';
            }
        }

        // è®¾ç½®é…¸ç¢±æ•°æ®
        function setAcidBase(formula, type) {
            // å¯ä»¥æ ¹æ®typeè®¾ç½®ç›¸åº”çš„é»˜è®¤å€¼
            switch(type) {
                case 'strong_acid':
                    document.getElementById('hConcentration').value = '0.1';
                    break;
                case 'strong_base':
                    document.getElementById('ohConcentration').value = '0.1';
                    break;
            }
        }

        // æº¶è§£åº¦è®¡ç®—
        function calculateSolubility() {
            const type = document.getElementById('solubilityType').value;
            const soluteMass = parseFloat(document.getElementById('soluteMass').value) || 0;
            const solventMass = parseFloat(document.getElementById('solventMass').value) || 0;
            const temp = parseFloat(document.getElementById('temperature').value) || 20;
            const givenSolubility = parseFloat(document.getElementById('givenSolubility').value) || 0;

            let result, label, steps = [];

            switch(type) {
                case 'solubility':
                    if (soluteMass && solventMass) {
                        result = (soluteMass / solventMass) * 100;
                        label = 'æº¶è§£åº¦ (g/100gæ°´)';
                        steps = [
                            `æº¶è§£åº¦ = (æº¶è´¨è´¨é‡ / æº¶å‰‚è´¨é‡) Ã— 100g`,
                            `æº¶è§£åº¦ = (${soluteMass}g / ${solventMass}g) Ã— 100g = ${result.toFixed(2)}g/100gæ°´`
                        ];
                    }
                    break;
                case 'saturated':
                    if (givenSolubility && solventMass) {
                        result = (givenSolubility * solventMass) / 100;
                        label = 'é¥±å’Œæ—¶æº¶è´¨è´¨é‡ (g)';
                        steps = [
                            `åœ¨${temp}Â°Cæ—¶ï¼Œ${solventMass}gæ°´ä¸­æœ€å¤šèƒ½æº¶è§£çš„æº¶è´¨è´¨é‡ï¼š`,
                            `è´¨é‡ = æº¶è§£åº¦ Ã— æº¶å‰‚è´¨é‡ / 100g = ${givenSolubility} Ã— ${solventMass} / 100 = ${result.toFixed(2)}g`
                        ];
                    }
                    break;
                case 'crystallization':
                    if (soluteMass && solventMass && givenSolubility) {
                        const maxSoluble = (givenSolubility * solventMass) / 100;
                        result = Math.max(0, soluteMass - maxSoluble);
                        label = 'æå‡ºæ™¶ä½“è´¨é‡ (g)';
                        steps = [
                            `å½“å‰æ¸©åº¦ä¸‹æœ€å¤§æº¶è§£è´¨é‡ = ${givenSolubility} Ã— ${solventMass} / 100 = ${maxSoluble.toFixed(2)}g`,
                            `æå‡ºè´¨é‡ = æ€»æº¶è´¨ - æœ€å¤§æº¶è§£è´¨é‡ = ${soluteMass} - ${maxSoluble.toFixed(2)} = ${result.toFixed(2)}g`
                        ];
                    }
                    break;
            }

            if (result !== undefined) {
                document.getElementById('solubilityValue').textContent = result.toFixed(2);
                document.getElementById('solubilityLabel').textContent = label;
                document.getElementById('solubilitySteps').innerHTML = steps.map(step => 
                    `<div class="step"><div class="step-title">è®¡ç®—æ­¥éª¤</div>${step}</div>`
                ).join('');
                document.getElementById('solubilitySteps').style.display = 'block';
            }
        }

        // è®¾ç½®æº¶è§£åº¦æ•°æ®
        function setSolubility(compound, solubility) {
            document.getElementById('givenSolubility').value = solubility;
        }

        // ååº”é€Ÿç‡è®¡ç®—
        function calculateRate() {
            const type = document.getElementById('rateType').value;
            const initialConc = parseFloat(document.getElementById('initialConc').value) || 0;
            const finalConc = parseFloat(document.getElementById('finalConc').value) || 0;
            const timeInterval = parseFloat(document.getElementById('timeInterval').value) || 0;
            const order = parseInt(document.getElementById('reactionOrder').value);
            const temp1 = parseFloat(document.getElementById('temp1').value) || 0;
            const temp2 = parseFloat(document.getElementById('temp2').value) || 0;

            let result, label, steps = [];

            switch(type) {
                case 'averageRate':
                    if (initialConc && finalConc && timeInterval) {
                        result = Math.abs(finalConc - initialConc) / timeInterval;
                        label = 'å¹³å‡ååº”é€Ÿç‡ (mol/LÂ·s)';
                        steps = [
                            `å¹³å‡ååº”é€Ÿç‡ = |Î”c| / Î”t`,
                            `v = |${finalConc} - ${initialConc}| / ${timeInterval} = ${result.toFixed(6)} mol/LÂ·s`
                        ];
                    }
                    break;
                case 'concentration':
                    if (initialConc && timeInterval) {
                        // ç®€åŒ–çš„æµ“åº¦è®¡ç®—ï¼Œå‡è®¾ååº”é€Ÿç‡å¸¸æ•°k=0.01
                        const k = 0.01;
                        switch(order) {
                            case 0:
                                result = initialConc - k * timeInterval;
                                steps = [
                                    `é›¶çº§ååº”: [A] = [A]â‚€ - kt`,
                                    `[A] = ${initialConc} - ${k} Ã— ${timeInterval} = ${result.toFixed(4)} mol/L`
                                ];
                                break;
                            case 1:
                                result = initialConc * Math.exp(-k * timeInterval);
                                steps = [
                                    `ä¸€çº§ååº”: [A] = [A]â‚€ Ã— e^(-kt)`,
                                    `[A] = ${initialConc} Ã— e^(-${k} Ã— ${timeInterval}) = ${result.toFixed(4)} mol/L`
                                ];
                                break;
                            case 2:
                                result = initialConc / (1 + k * initialConc * timeInterval);
                                steps = [
                                    `äºŒçº§ååº”: 1/[A] = 1/[A]â‚€ + kt`,
                                    `[A] = ${initialConc} / (1 + ${k} Ã— ${initialConc} Ã— ${timeInterval}) = ${result.toFixed(4)} mol/L`
                                ];
                                break;
                        }
                        label = 'ååº”åæµ“åº¦ (mol/L)';
                    }
                    break;
                case 'halfLife':
                    if (initialConc) {
                        const k = 0.01; // å‡è®¾ååº”é€Ÿç‡å¸¸æ•°
                        switch(order) {
                            case 0:
                                result = initialConc / (2 * k);
                                steps = [`é›¶çº§ååº”åŠè¡°æœŸ: tâ‚/â‚‚ = [A]â‚€ / (2k) = ${initialConc} / (2 Ã— ${k}) = ${result.toFixed(2)} s`];
                                break;
                            case 1:
                                result = Math.log(2) / k;
                                steps = [`ä¸€çº§ååº”åŠè¡°æœŸ: tâ‚/â‚‚ = ln(2) / k = 0.693 / ${k} = ${result.toFixed(2)} s`];
                                break;
                            case 2:
                                result = 1 / (k * initialConc);
                                steps = [`äºŒçº§ååº”åŠè¡°æœŸ: tâ‚/â‚‚ = 1 / (k[A]â‚€) = 1 / (${k} Ã— ${initialConc}) = ${result.toFixed(2)} s`];
                                break;
                        }
                        label = 'åŠè¡°æœŸ (s)';
                    }
                    break;
                case 'temperature':
                    if (temp1 && temp2) {
                        // èŒƒç‰¹éœå¤«è§„åˆ™ï¼šæ¸©åº¦æ¯å‡é«˜10Kï¼Œååº”é€Ÿç‡çº¦å¢åŠ 2-4å€
                        const tempDiff = temp2 - temp1;
                        const factor = Math.pow(2.5, tempDiff / 10); // å‡è®¾æ¯10Kå¢åŠ 2.5å€
                        result = factor;
                        label = 'é€Ÿç‡å˜åŒ–å€æ•°';
                        steps = [
                            `æ ¹æ®èŒƒç‰¹éœå¤«è§„åˆ™ï¼Œæ¸©åº¦ä»${temp1}Kå‡è‡³${temp2}K`,
                            `æ¸©åº¦å·® = ${tempDiff}K`,
                            `é€Ÿç‡å˜åŒ–å€æ•° â‰ˆ 2.5^(${tempDiff}/10) = ${result.toFixed(2)}å€`
                        ];
                    }
                    break;
            }

            if (result !== undefined) {
                document.getElementById('rateValue').textContent = result.toFixed(4);
                document.getElementById('rateLabel').textContent = label;
                document.getElementById('rateSteps').innerHTML = steps.map(step => 
                    `<div class="step"><div class="step-title">è®¡ç®—æ­¥éª¤</div>${step}</div>`
                ).join('');
                document.getElementById('rateSteps').style.display = 'block';
            }
        }

        // æ›´æ–°pHæŒ‡ç¤ºå™¨
        function updatePHIndicator(phValue) {
            const marker = document.getElementById('phMarker');
            if (marker && phValue >= 0 && phValue <= 14) {
                const percentage = (phValue / 14) * 100;
                marker.style.left = `calc(${percentage}% - 2px)`;
            }
        }

        // æ¼”ç¤ºè®¡ç®—åŠŸèƒ½
        function demoCalculation(type, example) {
            switch(type) {
                case 'ph':
                    switch(example) {
                        case 'lemon':
                            document.getElementById('hConcentration').value = '0.01';
                            document.getElementById('phType').value = 'fromH';
                            calculatePH();
                            break;
                        case 'water':
                            document.getElementById('hConcentration').value = '0.0000001';
                            document.getElementById('phType').value = 'fromH';
                            calculatePH();
                            break;
                        case 'soap':
                            document.getElementById('ohConcentration').value = '0.000001';
                            document.getElementById('phType').value = 'fromOH';
                            calculatePH();
                            break;
                    }
                    break;
            }
        }

        // è€ƒè¯•çœŸé¢˜ç¤ºä¾‹
        function examExample(type, questionNumber) {
            switch(type) {
                case 'molarity':
                    switch(questionNumber) {
                        case 1:
                            // çœŸé¢˜1: é…åˆ¶250mL 0.1mol/Lçš„NaClæº¶æ¶²ï¼Œéœ€è¦å¤šå°‘å…‹NaClï¼Ÿ
                            document.getElementById('molarityType').value = 'mass';
                            document.getElementById('volume').value = '0.25';
                            document.getElementById('molecularWeight').value = '58.44';
                            showSuccess('çœŸé¢˜1: é…åˆ¶250mL 0.1mol/Lçš„NaClæº¶æ¶²ï¼Œéœ€è¦å¤šå°‘å…‹NaClï¼Ÿ');
                            // è®¾ç½®æ‘©å°”æµ“åº¦
                            setTimeout(() => {
                                // æ¨¡æ‹Ÿè®¾ç½®æµ“åº¦å¹¶è®¡ç®—
                                const n = 0.1 * 0.25; // æ‘©å°”æ•°
                                const mass = n * 58.44;
                                document.getElementById('molarityValue').textContent = mass.toFixed(2);
                                document.getElementById('molarityLabel').textContent = 'æ‰€éœ€NaClè´¨é‡ (g)';
                                document.getElementById('molaritySteps').innerHTML = `
                                    <div class="step"><div class="step-title">è§£é¢˜æ­¥éª¤</div>
                                    æ­¥éª¤1: è®¡ç®—æ‰€éœ€æ‘©å°”æ•° n = M Ã— V = 0.1 Ã— 0.25 = 0.025 mol<br>
                                    æ­¥éª¤2: è®¡ç®—è´¨é‡ m = n Ã— Mr = 0.025 Ã— 58.44 = 1.46 g
                                    </div>`;
                                document.getElementById('molaritySteps').style.display = 'block';
                            }, 1000);
                            break;
                        case 2:
                            // çœŸé¢˜2: å°†98%çš„æµ“ç¡«é…¸(å¯†åº¦1.84g/mL)ç¨€é‡Šè‡³0.5mol/Lï¼Œæ±‚åŸæº¶æ¶²çš„æ‘©å°”æµ“åº¦
                            showSuccess('çœŸé¢˜2: 98%æµ“ç¡«é…¸(å¯†åº¦1.84g/mL)çš„æ‘©å°”æµ“åº¦æ˜¯å¤šå°‘ï¼Ÿ');
                            setTimeout(() => {
                                // æµ“ç¡«é…¸æ‘©å°”æµ“åº¦è®¡ç®—
                                const density = 1.84; // g/mL
                                const percentage = 0.98;
                                const molarMass = 98.08;
                                const molarity = (density * 1000 * percentage) / molarMass;
                                document.getElementById('molarityValue').textContent = molarity.toFixed(2);
                                document.getElementById('molarityLabel').textContent = 'æµ“ç¡«é…¸æ‘©å°”æµ“åº¦ (mol/L)';
                                document.getElementById('molaritySteps').innerHTML = `
                                    <div class="step"><div class="step-title">è§£é¢˜æ­¥éª¤</div>
                                    æ­¥éª¤1: 1Læº¶æ¶²è´¨é‡ = 1000mL Ã— 1.84g/mL = 1840g<br>
                                    æ­¥éª¤2: Hâ‚‚SOâ‚„è´¨é‡ = 1840g Ã— 98% = 1803.2g<br>
                                    æ­¥éª¤3: æ‘©å°”æµ“åº¦ = 1803.2g Ã· 98.08g/mol = ${molarity.toFixed(2)} mol/L
                                    </div>`;
                                document.getElementById('molaritySteps').style.display = 'block';
                            }, 1000);
                            break;
                        case 3:
                            // çœŸé¢˜3: ä¸­å’Œååº”è®¡ç®—
                            showSuccess('çœŸé¢˜3: ç”¨0.2mol/L NaOHæº¶æ¶²ä¸­å’Œ0.1mol/L Hâ‚‚SOâ‚„ï¼Œä½“ç§¯æ¯”æ˜¯å¤šå°‘ï¼Ÿ');
                            setTimeout(() => {
                                // Hâ‚‚SOâ‚„ + 2NaOH â†’ Naâ‚‚SOâ‚„ + 2Hâ‚‚O
                                const ratioMol = 2; // æ‘©å°”æ¯” NaOH:Hâ‚‚SOâ‚„ = 2:1
                                const ratioConc = 0.2 / 0.1; // æµ“åº¦æ¯”
                                const volumeRatio = ratioMol / ratioConc; // ä½“ç§¯æ¯”
                                document.getElementById('molarityValue').textContent = volumeRatio.toFixed(1);
                                document.getElementById('molarityLabel').textContent = 'NaOH:Hâ‚‚SOâ‚„ä½“ç§¯æ¯”';
                                document.getElementById('molaritySteps').innerHTML = `
                                    <div class="step"><div class="step-title">è§£é¢˜æ­¥éª¤</div>
                                    æ­¥éª¤1: ååº”æ–¹ç¨‹å¼ Hâ‚‚SOâ‚„ + 2NaOH â†’ Naâ‚‚SOâ‚„ + 2Hâ‚‚O<br>
                                    æ­¥éª¤2: æ‘©å°”æ¯” n(NaOH):n(Hâ‚‚SOâ‚„) = 2:1<br>
                                    æ­¥éª¤3: ä½“ç§¯æ¯” V(NaOH):V(Hâ‚‚SOâ‚„) = (2Ã—0.1):(1Ã—0.2) = 1:1
                                    </div>`;
                                document.getElementById('molaritySteps').style.display = 'block';
                            }, 1000);
                            break;
                    }
                    break;
            }
        }

        // é”™è¯¯å¤„ç†å’ŒéªŒè¯
        function validateInput(inputId, min, max) {
            const input = document.getElementById(inputId);
            const value = parseFloat(input.value);
            
            if (value < min || value > max) {
                showError(`${inputId}çš„å€¼åº”åœ¨${min}åˆ°${max}ä¹‹é—´`);
                return false;
            }
            return true;
        }

        function showError(message) {
            const errorDiv = document.querySelector('.error-message');
            if (errorDiv) {
                errorDiv.textContent = message;
                errorDiv.style.display = 'block';
                setTimeout(() => {
                    errorDiv.style.display = 'none';
                }, 3000);
            }
        }

        function showSuccess(message) {
            const successDiv = document.querySelector('.success-message');
            if (successDiv) {
                successDiv.textContent = message;
                successDiv.style.display = 'block';
                setTimeout(() => {
                    successDiv.style.display = 'none';
                }, 3000);
            }
        }

        // æ·»åŠ å­¦ä¹ æ¨¡å¼åŠŸèƒ½
        function toggleLearningMode() {
            const tips = document.querySelectorAll('.calculation-tip');
            const demos = document.querySelectorAll('.interactive-demo');
            
            tips.forEach(tip => {
                tip.style.display = tip.style.display === 'none' ? 'block' : 'none';
            });
            
            demos.forEach(demo => {
                demo.style.display = demo.style.display === 'none' ? 'block' : 'none';
            });
        }

        // é”®ç›˜å¿«æ·é”®æ”¯æŒ
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'Enter':
                        e.preventDefault();
                        // æ‰§è¡Œå½“å‰æ´»è·ƒæ ‡ç­¾çš„è®¡ç®—
                        const activeTab = document.querySelector('.calculator-tab.active');
                        if (activeTab) {
                            const tabType = activeTab.dataset.tab;
                            switch(tabType) {
                                case 'molarity': calculateMolarity(); break;
                                case 'stoichiometry': calculateStoichiometry(); break;
                                case 'composition': calculateComposition(); break;
                                case 'gas': calculateGas(); break;
                                case 'dilution': calculateDilution(); break;
                                case 'ph': calculatePH(); break;
                                case 'solubility': calculateSolubility(); break;
                                case 'rate': calculateRate(); break;
                            }
                        }
                        break;
                }
            }
        });

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // æ·»åŠ é”™è¯¯å’ŒæˆåŠŸæ¶ˆæ¯å®¹å™¨
            const container = document.querySelector('.calculator-container');
            if (container && !document.querySelector('.error-message')) {
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-message';
                container.appendChild(errorDiv);
                
                const successDiv = document.createElement('div');
                successDiv.className = 'success-message';
                container.appendChild(successDiv);
            }
        });
    </script>
</body>
</html> 