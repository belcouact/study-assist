<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>化学计算工具 - 化学学习助手</title>
    <link rel="icon" href="../../assets/icons/logo_btrfly.ico" type="image/x-icon">
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../../css/components.css">
    <link rel="stylesheet" href="../../css/utilities.css">
    <link rel="stylesheet" href="../../css/responsive.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Mobile First Design */
        .calculator-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }

        .calculator-header {
            text-align: center;
            margin-bottom: 2rem;
            padding: 2rem 1rem;
            background: linear-gradient(135deg, #dc3545 0%, #fd7e14 100%);
            border-radius: 15px;
            color: white;
        }

        .calculator-header h1 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        .calculator-header p {
            font-size: 1rem;
            opacity: 0.9;
        }

        .calculator-tabs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.5rem;
            margin-bottom: 2rem;
            background: white;
            padding: 0.5rem;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .calculator-tab {
            padding: 1rem 0.5rem;
            border: none;
            border-radius: 10px;
            background: transparent;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .calculator-tab:hover {
            background: rgba(220, 53, 69, 0.1);
        }

        .calculator-tab.active {
            background: linear-gradient(135deg, #dc3545, #fd7e14);
            color: white;
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
        }

        .calculator-section {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            display: none;
        }

        .calculator-section.active {
            display: block;
        }

        .calculation-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
        }

        .input-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
        }

        .result-section {
            background: linear-gradient(135deg, rgba(220, 53, 69, 0.05), rgba(253, 126, 20, 0.05));
            border-radius: 10px;
            padding: 1.5rem;
            border-left: 4px solid #dc3545;
        }

        .input-group {
            margin-bottom: 1.5rem;
        }

        .input-label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #2d3748;
        }

        .calc-input {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .calc-input:focus {
            outline: none;
            border-color: #dc3545;
            box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.1);
        }

        .calc-select {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            background: white;
            font-size: 1rem;
            cursor: pointer;
        }

        .calculate-btn {
            width: 100%;
            padding: 1rem 2rem;
            background: linear-gradient(135deg, #dc3545, #fd7e14);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(220, 53, 69, 0.3);
        }

        .result-display {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1rem;
        }

        .result-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #dc3545;
            margin-bottom: 0.5rem;
        }

        .result-label {
            color: #718096;
            font-size: 0.9rem;
        }

        .formula-display {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-weight: 600;
            color: #856404;
        }

        .step-by-step {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .step {
            margin-bottom: 1rem;
            padding: 0.5rem;
            background: white;
            border-radius: 5px;
            border-left: 3px solid #fd7e14;
        }

        .step-title {
            font-weight: 600;
            color: #dc3545;
            margin-bottom: 0.25rem;
        }

        .common-compounds {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .compound-btn {
            padding: 0.8rem;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 0.9rem;
        }

        .compound-btn:hover {
            border-color: #dc3545;
            background: rgba(220, 53, 69, 0.05);
        }

        /* Desktop Responsive */
        @media (min-width: 768px) {
            .calculator-container {
                padding: 2rem;
            }

            .calculator-header h1 {
                font-size: 2.5rem;
            }

            .calculator-header p {
                font-size: 1.1rem;
            }

            .calculator-tabs {
                grid-template-columns: repeat(8, 1fr);
            }

            .calculation-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (min-width: 1024px) {
            .calculation-grid {
                grid-template-columns: 2fr 1fr;
            }
        }

        /* 新增样式 */
        .ph-indicator {
            background: linear-gradient(90deg, 
                #ff0000 0%, #ff4500 14%, #ffa500 28%, 
                #ffff00 42%, #9acd32 57%, #00ff00 71%, 
                #00ced1 85%, #0000ff 100%);
            height: 30px;
            border-radius: 15px;
            position: relative;
            margin: 1rem 0;
        }

        .ph-marker {
            position: absolute;
            top: -10px;
            width: 4px;
            height: 50px;
            background: #333;
            border-radius: 2px;
            transition: left 0.3s ease;
        }

        .ph-scale {
            display: flex;
            justify-content: space-between;
            margin-top: 0.5rem;
            font-size: 0.8rem;
            color: #666;
        }

        .interactive-demo {
            background: #f0f8ff;
            border: 2px dashed #4169e1;
            border-radius: 10px;
            padding: 1rem;
            margin: 1rem 0;
            text-align: center;
        }

        .demo-button {
            background: linear-gradient(135deg, #4169e1, #6495ed);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            margin: 0.5rem;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .demo-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(65, 105, 225, 0.3);
        }

        .calculation-tip {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .tip-icon {
            color: #ffc107;
            margin-right: 0.5rem;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            display: none;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            display: none;
        }

        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #dc3545;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
            display: none;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* 增强的响应式设计 */
        @media (max-width: 480px) {
            .calculator-tabs {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.25rem;
            }
            
            .calculator-tab {
                padding: 0.8rem 0.25rem;
                font-size: 0.8rem;
            }
            
            .common-compounds {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .compound-btn {
                font-size: 0.8rem;
                padding: 0.6rem;
            }
        }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="../../index.html">
                        <i class="fas fa-graduation-cap" style="background: linear-gradient(90deg, #4361ee, #7209b7); -webkit-background-clip: text; background-clip: text; color: transparent;"></i>
                        <span>Alex的学习助手</span>
                    </a>
                </div>
                <nav class="main-nav">
                    <ul>
                        <li><a href="../../index.html">首页</a></li>
                        <li><a href="main.html">化学</a></li>
                        <li><a href="../../tts.html">语音</a></li>
                        <li><a href="../../draw.html">绘图</a></li>
                    </ul>
                </nav>
                <button class="mobile-menu-toggle" aria-label="切换菜单">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </header>

    <main class="calculator-container">
        <div class="calculator-header">
            <h1><i class="fas fa-calculator"></i> 化学计算工具</h1>
            <p>进行摩尔计算、浓度换算、化学计量学等常用化学计算</p>
            
            <!-- 学习指南 -->
            <div class="interactive-demo" style="margin-top: 2rem;">
                <h4>📚 学习指南 - 初高中化学计算必备技能</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem;">
                    <div class="calculation-tip" style="margin: 0;">
                        <strong>🧪 摩尔浓度</strong><br>
                        <small>配制溶液、化学反应计算的基础</small>
                    </div>
                    <div class="calculation-tip" style="margin: 0;">
                        <strong>⚖️ 化学计量学</strong><br>
                        <small>计算反应物用量、产物产量</small>
                    </div>
                    <div class="calculation-tip" style="margin: 0;">
                        <strong>🌡️ pH计算</strong><br>
                        <small>酸碱性质判断、中和反应</small>
                    </div>
                    <div class="calculation-tip" style="margin: 0;">
                        <strong>💨 气体定律</strong><br>
                        <small>气体压强、体积、温度关系</small>
                    </div>
                    <div class="calculation-tip" style="margin: 0;">
                        <strong>💧 溶解度</strong><br>
                        <small>结晶析出、饱和溶液计算</small>
                    </div>
                    <div class="calculation-tip" style="margin: 0;">
                        <strong>⏱️ 反应速率</strong><br>
                        <small>化学反应快慢的定量描述</small>
                    </div>
                </div>
                <p style="margin-top: 1rem; color: #666;">
                    💡 小提示：每个计算模块都包含详细步骤和实例，适合初中、高中学生学习使用
                </p>
            </div>
        </div>

        <!-- 计算器标签 -->
        <div class="calculator-tabs">
            <button class="calculator-tab active" data-tab="molarity">摩尔浓度</button>
            <button class="calculator-tab" data-tab="stoichiometry">化学计量学</button>
            <button class="calculator-tab" data-tab="composition">组成计算</button>
            <button class="calculator-tab" data-tab="gas">气体定律</button>
            <button class="calculator-tab" data-tab="dilution">稀释计算</button>
            <button class="calculator-tab" data-tab="ph">pH计算</button>
            <button class="calculator-tab" data-tab="solubility">溶解度</button>
            <button class="calculator-tab" data-tab="rate">反应速率</button>
        </div>

        <!-- 摩尔浓度计算器 -->
        <div class="calculator-section active" id="molarity">
            <h3><i class="fas fa-flask"></i> 摩尔浓度计算</h3>
            <div class="formula-display">
                M = n / V  或  M = m / (MW × V)
            </div>
            
            <div class="calculation-grid">
                <div class="input-section">
                    <div class="input-group">
                        <label class="input-label">计算类型</label>
                        <select id="molarityType" class="calc-select">
                            <option value="molarity">计算摩尔浓度 (M)</option>
                            <option value="moles">计算摩尔数 (n)</option>
                            <option value="volume">计算体积 (V)</option>
                            <option value="mass">计算质量 (m)</option>
                        </select>
                    </div>

                    <div id="molarityInputs">
                        <div class="input-group">
                            <label class="input-label">质量 (g)</label>
                            <input type="number" id="mass" class="calc-input" placeholder="输入质量">
                        </div>
                        <div class="input-group">
                            <label class="input-label">分子量 (g/mol)</label>
                            <input type="number" id="molecularWeight" class="calc-input" placeholder="输入分子量">
                        </div>
                        <div class="input-group">
                            <label class="input-label">体积 (L)</label>
                            <input type="number" id="volume" class="calc-input" placeholder="输入体积">
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">常见化合物</label>
                        <div class="common-compounds">
                            <button class="compound-btn" onclick="setCompound('NaCl', 58.44)">NaCl</button>
                            <button class="compound-btn" onclick="setCompound('H2SO4', 98.08)">H₂SO₄</button>
                            <button class="compound-btn" onclick="setCompound('CaCl2', 110.98)">CaCl₂</button>
                            <button class="compound-btn" onclick="setCompound('NaOH', 40.00)">NaOH</button>
                        </div>
                    </div>

                    <!-- 考试真题示例 -->
                    <div class="interactive-demo">
                        <h5>📝 考试真题练习</h5>
                        <button class="demo-button" onclick="examExample('molarity', 1)">真题1: 配制NaCl溶液</button>
                        <button class="demo-button" onclick="examExample('molarity', 2)">真题2: 稀释浓硫酸</button>
                        <button class="demo-button" onclick="examExample('molarity', 3)">真题3: 反应消耗计算</button>
                    </div>

                    <!-- 详细考试真题练习 -->
                    <div class="calculation-tip" style="margin-top: 1.5rem;">
                        <h5><i class="fas fa-book-open"></i> 中高考真题详解</h5>
                        <div style="margin-top: 1rem;">
                            <div class="step" style="background: #fff; border: 1px solid #ddd; margin-bottom: 1rem;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题1】配制溶液计算</div>
                                <p><strong>题目：</strong>现要配制250mL 0.2mol/L的NaCl溶液，需要NaCl固体多少克？需要水多少毫升？</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①确定所需溶质的物质的量：n = c×V = 0.2mol/L × 0.25L = 0.05mol</p>
                                <p>②计算NaCl的质量：m = n×M = 0.05mol × 58.5g/mol = 2.925g</p>
                                <p>③配制步骤：称取2.925g NaCl，溶解后定容至250mL</p>
                                <p><strong>答案：</strong>需要NaCl 2.925g，水约230mL</p>
                            </div>
                            
                            <div class="step" style="background: #fff; border: 1px solid #ddd; margin-bottom: 1rem;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题2】溶液稀释计算</div>
                                <p><strong>题目：</strong>将100mL 3mol/L的H₂SO₄溶液稀释成0.5mol/L，需要加入多少毫升水？</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①应用稀释定律：c₁V₁ = c₂V₂</p>
                                <p>②计算稀释后总体积：V₂ = c₁V₁/c₂ = 3×100/0.5 = 600mL</p>
                                <p>③计算需加水体积：V(水) = V₂ - V₁ = 600 - 100 = 500mL</p>
                                <p><strong>答案：</strong>需要加入500mL水</p>
                            </div>
                            
                            <div class="step" style="background: #fff; border: 1px solid #ddd;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题3】反应中浓度计算</div>
                                <p><strong>题目：</strong>在反应CaCO₃ + 2HCl → CaCl₂ + H₂O + CO₂↑中，用2mol/L的HCl溶液50mL，最多能与多少克CaCO₃反应？</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①计算HCl的物质的量：n(HCl) = 2mol/L × 0.05L = 0.1mol</p>
                                <p>②根据方程式确定物质的量关系：n(CaCO₃) = ½n(HCl) = 0.05mol</p>
                                <p>③计算CaCO₃质量：m = n×M = 0.05mol × 100g/mol = 5g</p>
                                <p><strong>答案：</strong>最多能与5g CaCO₃反应</p>
                            </div>
                        </div>
                    </div>

                    <button class="calculate-btn" onclick="calculateMolarity()">
                        <i class="fas fa-calculator"></i> 计算
                    </button>
                </div>

                <div class="result-section">
                    <h4><i class="fas fa-chart-bar"></i> 计算结果</h4>
                    <div class="result-display" id="molarityResult">
                        <div class="result-value" id="molarityValue">-</div>
                        <div class="result-label" id="molarityLabel">摩尔浓度 (M)</div>
                    </div>
                    <div class="step-by-step" id="molaritySteps" style="display: none;">
                        <!-- 计算步骤将动态添加 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 化学计量学计算器 -->
        <div class="calculator-section" id="stoichiometry">
            <h3><i class="fas fa-balance-scale"></i> 化学计量学计算</h3>
            <div class="formula-display">
                mol₁ / coeff₁ = mol₂ / coeff₂
            </div>
            
            <div class="calculation-grid">
                <div class="input-section">
                    <div class="input-group">
                        <label class="input-label">化学方程式</label>
                        <input type="text" id="equation" class="calc-input" placeholder="例如: 2H2 + O2 → 2H2O">
                    </div>

                    <div class="input-group">
                        <label class="input-label">已知物质</label>
                        <select id="knownSubstance" class="calc-select">
                            <option value="">选择已知物质</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label class="input-label">已知量 (mol)</label>
                        <input type="number" id="knownAmount" class="calc-input" placeholder="输入已知摩尔数">
                    </div>

                    <div class="input-group">
                        <label class="input-label">目标物质</label>
                        <select id="targetSubstance" class="calc-select">
                            <option value="">选择目标物质</option>
                        </select>
                    </div>

                    <!-- 考试真题练习 -->
                    <div class="calculation-tip" style="margin-top: 1.5rem;">
                        <h5><i class="fas fa-book-open"></i> 中高考真题详解</h5>
                        <div style="margin-top: 1rem;">
                            <div class="step" style="background: #fff; border: 1px solid #ddd; margin-bottom: 1rem;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题1】燃烧反应计算</div>
                                <p><strong>题目：</strong>完全燃烧2.3g乙醇(C₂H₅OH)，需要消耗多少升O₂(标准状况)？生成多少克CO₂？</p>
                                <p><strong>化学方程式：</strong>C₂H₅OH + 3O₂ → 2CO₂ + 3H₂O</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①计算乙醇摩尔数：n(C₂H₅OH) = 2.3g ÷ 46g/mol = 0.05mol</p>
                                <p>②根据化学计量比：n(O₂) = 3n(C₂H₅OH) = 3 × 0.05 = 0.15mol</p>
                                <p>③计算O₂体积：V(O₂) = 0.15mol × 22.4L/mol = 3.36L</p>
                                <p>④计算CO₂质量：n(CO₂) = 2n(C₂H₅OH) = 0.1mol，m(CO₂) = 0.1 × 44 = 4.4g</p>
                                <p><strong>答案：</strong>需要O₂ 3.36L，生成CO₂ 4.4g</p>
                            </div>
                            
                            <div class="step" style="background: #fff; border: 1px solid #ddd; margin-bottom: 1rem;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题2】金属与酸反应</div>
                                <p><strong>题目：</strong>将6.5g锌投入足量稀硫酸中，计算生成氢气的体积(标准状况)和消耗H₂SO₄的质量。</p>
                                <p><strong>化学方程式：</strong>Zn + H₂SO₄ → ZnSO₄ + H₂↑</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①计算锌的摩尔数：n(Zn) = 6.5g ÷ 65g/mol = 0.1mol</p>
                                <p>②根据1:1:1计量关系：n(H₂) = n(H₂SO₄) = n(Zn) = 0.1mol</p>
                                <p>③计算H₂体积：V(H₂) = 0.1mol × 22.4L/mol = 2.24L</p>
                                <p>④计算H₂SO₄质量：m(H₂SO₄) = 0.1mol × 98g/mol = 9.8g</p>
                                <p><strong>答案：</strong>生成H₂ 2.24L，消耗H₂SO₄ 9.8g</p>
                            </div>
                            
                            <div class="step" style="background: #fff; border: 1px solid #ddd;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题3】沉淀反应计算</div>
                                <p><strong>题目：</strong>向AgNO₃溶液中加入1.17g NaCl，完全反应后生成多少克AgCl沉淀？</p>
                                <p><strong>化学方程式：</strong>AgNO₃ + NaCl → AgCl↓ + NaNO₃</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①计算NaCl摩尔数：n(NaCl) = 1.17g ÷ 58.5g/mol = 0.02mol</p>
                                <p>②根据1:1计量关系：n(AgCl) = n(NaCl) = 0.02mol</p>
                                <p>③计算AgCl质量：m(AgCl) = 0.02mol × 143.5g/mol = 2.87g</p>
                                <p><strong>答案：</strong>生成AgCl沉淀2.87g</p>
                            </div>
                        </div>
                    </div>

                    <button class="calculate-btn" onclick="calculateStoichiometry()">
                        <i class="fas fa-calculator"></i> 计算
                    </button>
                </div>

                <div class="result-section">
                    <h4><i class="fas fa-chart-bar"></i> 计算结果</h4>
                    <div class="result-display" id="stoichiometryResult">
                        <div class="result-value" id="stoichiometryValue">-</div>
                        <div class="result-label" id="stoichiometryLabel">目标物质摩尔数 (mol)</div>
                    </div>
                    <div class="step-by-step" id="stoichiometrySteps" style="display: none;">
                        <!-- 计算步骤将动态添加 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 组成计算器 -->
        <div class="calculator-section" id="composition">
            <h3><i class="fas fa-pie-chart"></i> 百分组成计算</h3>
            <div class="formula-display">
                %成分 = (原子质量 × 原子数) / 分子量 × 100%
            </div>
            
            <div class="calculation-grid">
                <div class="input-section">
                    <div class="input-group">
                        <label class="input-label">化学式</label>
                        <input type="text" id="formula" class="calc-input" placeholder="例如: H2SO4">
                    </div>

                    <div class="input-group">
                        <label class="input-label">或手动输入元素</label>
                        <div id="elementsInput">
                            <div class="element-row" style="display: grid; grid-template-columns: 1fr 1fr auto; gap: 0.5rem; margin-bottom: 0.5rem;">
                                <input type="text" class="calc-input element-symbol" placeholder="元素符号">
                                <input type="number" class="calc-input element-count" placeholder="原子数">
                                <button class="calculate-btn" style="width: auto; padding: 0.5rem;" onclick="addElement()">+</button>
                            </div>
                        </div>
                    </div>

                    <!-- 考试真题练习 -->
                    <div class="calculation-tip" style="margin-top: 1.5rem;">
                        <h5><i class="fas fa-book-open"></i> 中高考真题详解</h5>
                        <div style="margin-top: 1rem;">
                            <div class="step" style="background: #fff; border: 1px solid #ddd; margin-bottom: 1rem;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题1】硫酸分子组成</div>
                                <p><strong>题目：</strong>计算硫酸(H₂SO₄)中各元素的质量分数。</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①计算分子量：Mr(H₂SO₄) = 2×1 + 1×32 + 4×16 = 98 g/mol</p>
                                <p>②计算各元素质量分数：</p>
                                <p>　　w(H) = (2×1)/98 × 100% = 2.04%</p>
                                <p>　　w(S) = (1×32)/98 × 100% = 32.65%</p>
                                <p>　　w(O) = (4×16)/98 × 100% = 65.31%</p>
                                <p><strong>答案：</strong>H: 2.04%, S: 32.65%, O: 65.31%</p>
                            </div>
                            
                            <div class="step" style="background: #fff; border: 1px solid #ddd; margin-bottom: 1rem;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题2】确定化学式</div>
                                <p><strong>题目：</strong>某化合物含C 40%，H 6.67%，O 53.33%，求其最简式。(相对原子质量：C-12，H-1，O-16)</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①设化合物质量为100g，则：m(C)=40g，m(H)=6.67g，m(O)=53.33g</p>
                                <p>②计算各元素原子数目比：</p>
                                <p>　　n(C) : n(H) : n(O) = 40/12 : 6.67/1 : 53.33/16</p>
                                <p>　　= 3.33 : 6.67 : 3.33 = 1 : 2 : 1</p>
                                <p><strong>答案：</strong>最简式为CH₂O</p>
                            </div>
                            
                            <div class="step" style="background: #fff; border: 1px solid #ddd;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题3】含量计算</div>
                                <p><strong>题目：</strong>要制取32g CuSO₄·5H₂O，需要多少克CuSO₄？</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①计算CuSO₄·5H₂O的分子量：</p>
                                <p>　　Mr = 64 + 32 + 64 + 90 = 250 g/mol</p>
                                <p>②计算CuSO₄在其中的质量分数：</p>
                                <p>　　w(CuSO₄) = 160/250 × 100% = 64%</p>
                                <p>③计算所需CuSO₄质量：m = 32g × 64% = 20.48g</p>
                                <p><strong>答案：</strong>需要CuSO₄ 20.48g</p>
                            </div>
                        </div>
                    </div>

                    <button class="calculate-btn" onclick="calculateComposition()">
                        <i class="fas fa-calculator"></i> 计算
                    </button>
                </div>

                <div class="result-section">
                    <h4><i class="fas fa-chart-bar"></i> 组成分析</h4>
                    <div class="result-display" id="compositionResult">
                        <div class="result-value" id="molecularWeightValue">-</div>
                        <div class="result-label">分子量 (g/mol)</div>
                    </div>
                    <div id="elementComposition" style="margin-top: 1rem;">
                        <!-- 元素组成将动态添加 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 气体定律计算器 -->
        <div class="calculator-section" id="gas">
            <h3><i class="fas fa-wind"></i> 理想气体定律</h3>
            <div class="formula-display">
                PV = nRT  (R = 0.08206 L·atm/mol·K)
            </div>
            
            <div class="calculation-grid">
                <div class="input-section">
                    <div class="input-group">
                        <label class="input-label">计算类型</label>
                        <select id="gasType" class="calc-select">
                            <option value="pressure">计算压强 (P)</option>
                            <option value="volume">计算体积 (V)</option>
                            <option value="moles">计算摩尔数 (n)</option>
                            <option value="temperature">计算温度 (T)</option>
                        </select>
                    </div>

                    <div id="gasInputs">
                        <div class="input-group">
                            <label class="input-label">压强 (atm)</label>
                            <input type="number" id="pressure" class="calc-input" placeholder="输入压强">
                        </div>
                        <div class="input-group">
                            <label class="input-label">体积 (L)</label>
                            <input type="number" id="gasVolume" class="calc-input" placeholder="输入体积">
                        </div>
                        <div class="input-group">
                            <label class="input-label">摩尔数 (mol)</label>
                            <input type="number" id="gasMoles" class="calc-input" placeholder="输入摩尔数">
                        </div>
                        <div class="input-group">
                            <label class="input-label">温度 (K)</label>
                            <input type="number" id="temperature" class="calc-input" placeholder="输入温度">
                        </div>
                    </div>

                    <!-- 考试真题练习 -->
                    <div class="calculation-tip" style="margin-top: 1.5rem;">
                        <h5><i class="fas fa-book-open"></i> 中高考真题详解</h5>
                        <div style="margin-top: 1rem;">
                            <div class="step" style="background: #fff; border: 1px solid #ddd; margin-bottom: 1rem;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题1】标准状况气体体积</div>
                                <p><strong>题目：</strong>在标准状况下，1.7g NH₃占有的体积是多少？</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①计算NH₃的摩尔数：n = m/M = 1.7g ÷ 17g/mol = 0.1mol</p>
                                <p>②应用标准状况摩尔体积：V = n × 22.4L/mol = 0.1 × 22.4 = 2.24L</p>
                                <p><strong>公式：</strong>标准状况下，V = n × 22.4L/mol</p>
                                <p><strong>答案：</strong>体积为2.24L</p>
                            </div>
                            
                            <div class="step" style="background: #fff; border: 1px solid #ddd; margin-bottom: 1rem;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题2】气体状态方程</div>
                                <p><strong>题目：</strong>某气体在27°C、2atm下体积为11.2L，求该气体在标准状况下的体积。</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①初始条件：T₁ = 27+273 = 300K，P₁ = 2atm，V₁ = 11.2L</p>
                                <p>②标准状况：T₂ = 273K，P₂ = 1atm，V₂ = ?</p>
                                <p>③应用理想气体定律：P₁V₁/T₁ = P₂V₂/T₂</p>
                                <p>④求解：V₂ = P₁V₁T₂/(P₂T₁) = 2×11.2×273/(1×300) = 20.38L</p>
                                <p><strong>答案：</strong>标准状况下体积为20.38L</p>
                            </div>
                            
                            <div class="step" style="background: #fff; border: 1px solid #ddd;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题3】混合气体计算</div>
                                <p><strong>题目：</strong>在相同条件下，H₂和O₂的体积比为2:1，求混合后气体的平均分子量。</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①设H₂体积为2V，O₂体积为V，总体积为3V</p>
                                <p>②相同条件下，体积比等于摩尔数比：n(H₂):n(O₂) = 2:1</p>
                                <p>③设n(H₂) = 2mol，n(O₂) = 1mol，总摩尔数 = 3mol</p>
                                <p>④总质量 = 2×2 + 1×32 = 36g</p>
                                <p>⑤平均分子量 = 36g ÷ 3mol = 12g/mol</p>
                                <p><strong>答案：</strong>平均分子量为12g/mol</p>
                            </div>
                        </div>
                    </div>

                    <button class="calculate-btn" onclick="calculateGas()">
                        <i class="fas fa-calculator"></i> 计算
                    </button>
                </div>

                <div class="result-section">
                    <h4><i class="fas fa-chart-bar"></i> 计算结果</h4>
                    <div class="result-display" id="gasResult">
                        <div class="result-value" id="gasValue">-</div>
                        <div class="result-label" id="gasLabel">-</div>
                    </div>
                    <div class="step-by-step" id="gasSteps" style="display: none;">
                        <!-- 计算步骤将动态添加 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 稀释计算器 -->
        <div class="calculator-section" id="dilution">
            <h3><i class="fas fa-tint"></i> 稀释计算</h3>
            <div class="formula-display">
                M₁V₁ = M₂V₂
            </div>
            
            <div class="calculation-grid">
                <div class="input-section">
                    <div class="input-group">
                        <label class="input-label">初始浓度 (M)</label>
                        <input type="number" id="initialConcentration" class="calc-input" placeholder="输入初始浓度">
                    </div>

                    <div class="input-group">
                        <label class="input-label">初始体积 (mL)</label>
                        <input type="number" id="initialVolume" class="calc-input" placeholder="输入初始体积">
                    </div>

                    <div class="input-group">
                        <label class="input-label">最终浓度 (M)</label>
                        <input type="number" id="finalConcentration" class="calc-input" placeholder="输入最终浓度">
                    </div>

                    <div class="input-group">
                        <label class="input-label">最终体积 (mL)</label>
                        <input type="number" id="finalVolume" class="calc-input" placeholder="输入最终体积">
                    </div>

                    <div class="input-group">
                        <label class="input-label">计算类型</label>
                        <select id="dilutionType" class="calc-select">
                            <option value="finalVolume">计算最终体积</option>
                            <option value="finalConcentration">计算最终浓度</option>
                            <option value="initialVolume">计算所需初始体积</option>
                            <option value="waterVolume">计算所需加水体积</option>
                        </select>
                    </div>

                    <!-- 考试真题练习 -->
                    <div class="calculation-tip" style="margin-top: 1.5rem;">
                        <h5><i class="fas fa-book-open"></i> 中高考真题详解</h5>
                        <div style="margin-top: 1rem;">
                            <div class="step" style="background: #fff; border: 1px solid #ddd; margin-bottom: 1rem;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题1】配制稀溶液</div>
                                <p><strong>题目：</strong>用18mol/L的浓硫酸配制500mL 2mol/L的稀硫酸，需要浓硫酸多少毫升？加水多少毫升？</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①应用稀释公式：c₁V₁ = c₂V₂</p>
                                <p>②求浓硫酸体积：V₁ = c₂V₂/c₁ = 2×500/18 = 55.6mL</p>
                                <p>③求加水体积：V(水) = V₂ - V₁ = 500 - 55.6 = 444.4mL</p>
                                <p><strong>操作提醒：</strong>稀释浓硫酸时，一定要将浓硫酸缓慢倒入水中，边倒边搅拌！</p>
                                <p><strong>答案：</strong>需要浓硫酸55.6mL，加水444.4mL</p>
                            </div>
                            
                            <div class="step" style="background: #fff; border: 1px solid #ddd; margin-bottom: 1rem;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题2】混合溶液计算</div>
                                <p><strong>题目：</strong>将100mL 3mol/L的NaCl溶液与200mL 1mol/L的NaCl溶液混合，求混合后溶液的浓度。</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①计算各溶液的溶质摩尔数：</p>
                                <p>　　n₁ = c₁V₁ = 3 × 0.1 = 0.3mol</p>
                                <p>　　n₂ = c₂V₂ = 1 × 0.2 = 0.2mol</p>
                                <p>②计算混合后总摩尔数：n总 = 0.3 + 0.2 = 0.5mol</p>
                                <p>③计算混合后总体积：V总 = 100 + 200 = 300mL = 0.3L</p>
                                <p>④计算混合后浓度：c混 = n总/V总 = 0.5/0.3 = 1.67mol/L</p>
                                <p><strong>答案：</strong>混合后浓度为1.67mol/L</p>
                            </div>
                            
                            <div class="step" style="background: #fff; border: 1px solid #ddd;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题3】蒸发浓缩计算</div>
                                <p><strong>题目：</strong>200mL 0.5mol/L的NaOH溶液经加热蒸发掉50mL水后，求溶液的浓度。</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①计算溶质摩尔数（蒸发过程中溶质不变）：</p>
                                <p>　　n(NaOH) = 0.5mol/L × 0.2L = 0.1mol</p>
                                <p>②计算蒸发后溶液体积：V₂ = 200 - 50 = 150mL = 0.15L</p>
                                <p>③计算蒸发后浓度：c₂ = n/V₂ = 0.1mol/0.15L = 0.67mol/L</p>
                                <p><strong>答案：</strong>蒸发后浓度为0.67mol/L</p>
                            </div>
                        </div>
                    </div>

                    <button class="calculate-btn" onclick="calculateDilution()">
                        <i class="fas fa-calculator"></i> 计算
                    </button>
                </div>

                <div class="result-section">
                    <h4><i class="fas fa-chart-bar"></i> 稀释结果</h4>
                    <div class="result-display" id="dilutionResult">
                        <div class="result-value" id="dilutionValue">-</div>
                        <div class="result-label" id="dilutionLabel">-</div>
                    </div>
                    <div class="step-by-step" id="dilutionSteps" style="display: none;">
                        <!-- 计算步骤将动态添加 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- pH计算器 -->
        <div class="calculator-section" id="ph">
            <h3><i class="fas fa-test-tube"></i> pH & pOH 计算</h3>
            <div class="formula-display">
                pH = -log[H⁺]  |  pOH = -log[OH⁻]  |  pH + pOH = 14
            </div>
            
            <div class="calculation-grid">
                <div class="input-section">
                    <div class="input-group">
                        <label class="input-label">计算类型</label>
                        <select id="phType" class="calc-select">
                            <option value="fromH">从H⁺浓度计算pH</option>
                            <option value="fromOH">从OH⁻浓度计算pOH</option>
                            <option value="toPH">从pH计算H⁺浓度</option>
                            <option value="toPOH">从pOH计算OH⁻浓度</option>
                            <option value="acidBase">酸碱中和计算</option>
                        </select>
                    </div>

                    <div id="phInputs">
                        <div class="input-group">
                            <label class="input-label">H⁺浓度 (mol/L)</label>
                            <input type="number" id="hConcentration" class="calc-input" placeholder="输入H⁺浓度" step="any">
                        </div>
                        <div class="input-group">
                            <label class="input-label">OH⁻浓度 (mol/L)</label>
                            <input type="number" id="ohConcentration" class="calc-input" placeholder="输入OH⁻浓度" step="any">
                        </div>
                        <div class="input-group">
                            <label class="input-label">pH值</label>
                            <input type="number" id="phValue" class="calc-input" placeholder="输入pH值" step="0.01">
                        </div>
                        <div class="input-group">
                            <label class="input-label">pOH值</label>
                            <input type="number" id="pohValue" class="calc-input" placeholder="输入pOH值" step="0.01">
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">常见酸碱</label>
                        <div class="common-compounds">
                            <button class="compound-btn" onclick="setAcidBase('HCl', 'strong_acid')">HCl</button>
                            <button class="compound-btn" onclick="setAcidBase('NaOH', 'strong_base')">NaOH</button>
                            <button class="compound-btn" onclick="setAcidBase('CH3COOH', 'weak_acid')">CH₃COOH</button>
                            <button class="compound-btn" onclick="setAcidBase('NH3', 'weak_base')">NH₃</button>
                        </div>
                    </div>

                    <!-- 考试真题练习 -->
                    <div class="calculation-tip" style="margin-top: 1.5rem;">
                        <h5><i class="fas fa-book-open"></i> 中高考真题详解</h5>
                        <div style="margin-top: 1rem;">
                            <div class="step" style="background: #fff; border: 1px solid #ddd; margin-bottom: 1rem;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题1】强酸pH计算</div>
                                <p><strong>题目：</strong>0.01mol/L的HCl溶液的pH值是多少？</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①HCl是强酸，完全电离：HCl → H⁺ + Cl⁻</p>
                                <p>②因此 [H⁺] = [HCl] = 0.01mol/L = 1×10⁻²mol/L</p>
                                <p>③pH = -lg[H⁺] = -lg(1×10⁻²) = 2</p>
                                <p><strong>答案：</strong>pH = 2，溶液呈强酸性</p>
                            </div>
                            
                            <div class="step" style="background: #fff; border: 1px solid #ddd; margin-bottom: 1rem;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题2】强碱pH计算</div>
                                <p><strong>题目：</strong>0.05mol/L的Ba(OH)₂溶液的pH值是多少？</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①Ba(OH)₂是强碱，完全电离：Ba(OH)₂ → Ba²⁺ + 2OH⁻</p>
                                <p>②因此 [OH⁻] = 2×[Ba(OH)₂] = 2×0.05 = 0.1mol/L</p>
                                <p>③pOH = -lg[OH⁻] = -lg(0.1) = 1</p>
                                <p>④pH = 14 - pOH = 14 - 1 = 13</p>
                                <p><strong>答案：</strong>pH = 13，溶液呈强碱性</p>
                            </div>
                            
                            <div class="step" style="background: #fff; border: 1px solid #ddd;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题3】酸碱中和pH计算</div>
                                <p><strong>题目：</strong>用0.1mol/L的NaOH溶液中和20mL 0.1mol/L的HCl溶液，需要NaOH溶液多少毫升？中和后溶液pH是多少？</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①反应方程式：HCl + NaOH → NaCl + H₂O</p>
                                <p>②计算HCl摩尔数：n(HCl) = 0.1 × 0.02 = 0.002mol</p>
                                <p>③根据1:1计量关系：n(NaOH) = n(HCl) = 0.002mol</p>
                                <p>④计算NaOH体积：V(NaOH) = 0.002 ÷ 0.1 = 0.02L = 20mL</p>
                                <p>⑤完全中和后生成NaCl，pH = 7（中性）</p>
                                <p><strong>答案：</strong>需要NaOH 20mL，中和后pH = 7</p>
                            </div>
                        </div>
                    </div>

                    <button class="calculate-btn" onclick="calculatePH()">
                        <i class="fas fa-calculator"></i> 计算
                    </button>
                </div>

                <div class="result-section">
                    <h4><i class="fas fa-chart-bar"></i> pH结果</h4>
                    <div class="result-display" id="phResult">
                        <div class="result-value" id="phResultValue">-</div>
                        <div class="result-label" id="phResultLabel">pH值</div>
                    </div>
                    <div class="result-display" id="solutionType" style="margin-top: 1rem;">
                        <div class="result-value" id="solutionTypeValue" style="font-size: 1.2rem;">-</div>
                        <div class="result-label">溶液性质</div>
                    </div>
                    
                    <!-- pH可视化指示器 -->
                    <div class="ph-indicator">
                        <div class="ph-marker" id="phMarker"></div>
                    </div>
                    <div class="ph-scale">
                        <span>0</span><span>1</span><span>2</span><span>3</span><span>4</span><span>5</span><span>6</span>
                        <span>7</span><span>8</span><span>9</span><span>10</span><span>11</span><span>12</span><span>13</span><span>14</span>
                    </div>
                    
                    <!-- 计算提示 -->
                    <div class="calculation-tip">
                        <i class="fas fa-lightbulb tip-icon"></i>
                        <strong>小贴士：</strong>pH < 7为酸性，pH = 7为中性，pH > 7为碱性。每个pH单位代表氢离子浓度10倍的变化。
                    </div>
                    
                    <!-- 交互式示例 -->
                    <div class="interactive-demo">
                        <h5>🧪 试试这些例子：</h5>
                        <button class="demo-button" onclick="demoCalculation('ph', 'lemon')">柠檬汁 (pH≈2)</button>
                        <button class="demo-button" onclick="demoCalculation('ph', 'water')">纯水 (pH=7)</button>
                        <button class="demo-button" onclick="demoCalculation('ph', 'soap')">肥皂水 (pH≈9)</button>
                    </div>
                    
                    <div class="step-by-step" id="phSteps" style="display: none;">
                        <!-- 计算步骤将动态添加 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 溶解度计算器 -->
        <div class="calculator-section" id="solubility">
            <h3><i class="fas fa-flask-vial"></i> 溶解度计算</h3>
            <div class="formula-display">
                溶解度 = 溶质质量 / 溶剂质量 × 100g
            </div>
            
            <div class="calculation-grid">
                <div class="input-section">
                    <div class="input-group">
                        <label class="input-label">计算类型</label>
                        <select id="solubilityType" class="calc-select">
                            <option value="solubility">计算溶解度</option>
                            <option value="saturated">饱和溶液计算</option>
                            <option value="crystallization">结晶析出计算</option>
                            <option value="solubilityProduct">溶度积计算</option>
                        </select>
                    </div>

                    <div id="solubilityInputs">
                        <div class="input-group">
                            <label class="input-label">溶质质量 (g)</label>
                            <input type="number" id="soluteMass" class="calc-input" placeholder="输入溶质质量">
                        </div>
                        <div class="input-group">
                            <label class="input-label">溶剂质量 (g)</label>
                            <input type="number" id="solventMass" class="calc-input" placeholder="输入溶剂质量">
                        </div>
                        <div class="input-group">
                            <label class="input-label">温度 (°C)</label>
                            <input type="number" id="temperature" class="calc-input" placeholder="输入温度" value="20">
                        </div>
                        <div class="input-group">
                            <label class="input-label">溶解度 (g/100g水)</label>
                            <input type="number" id="givenSolubility" class="calc-input" placeholder="输入已知溶解度">
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">常见物质溶解度(20°C)</label>
                        <div class="common-compounds">
                            <button class="compound-btn" onclick="setSolubility('NaCl', 36.0)">NaCl (36g)</button>
                            <button class="compound-btn" onclick="setSolubility('KNO3', 31.6)">KNO₃ (31.6g)</button>
                            <button class="compound-btn" onclick="setSolubility('NH4Cl', 37.2)">NH₄Cl (37.2g)</button>
                            <button class="compound-btn" onclick="setSolubility('CaCl2', 74.5)">CaCl₂ (74.5g)</button>
                        </div>
                    </div>

                    <!-- 考试真题练习 -->
                    <div class="calculation-tip" style="margin-top: 1.5rem;">
                        <h5><i class="fas fa-book-open"></i> 中高考真题详解</h5>
                        <div style="margin-top: 1rem;">
                            <div class="step" style="background: #fff; border: 1px solid #ddd; margin-bottom: 1rem;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题1】结晶析出计算</div>
                                <p><strong>题目：</strong>20°C时KNO₃的溶解度为31.6g，现有100g该温度下的饱和溶液，降温至10°C时（溶解度为20.9g），析出多少克晶体？</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①计算20°C饱和溶液中的溶质和溶剂：</p>
                                <p>　　设水的质量为x，则KNO₃质量为31.6x/100</p>
                                <p>　　总质量：x + 31.6x/100 = 100，解得x = 75.99g</p>
                                <p>　　KNO₃质量：31.6×75.99/100 = 24.01g</p>
                                <p>②10°C时最大溶解质量：20.9×75.99/100 = 15.88g</p>
                                <p>③析出晶体质量：24.01 - 15.88 = 8.13g</p>
                                <p><strong>答案：</strong>析出KNO₃晶体8.13g</p>
                            </div>
                            
                            <div class="step" style="background: #fff; border: 1px solid #ddd; margin-bottom: 1rem;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题2】溶解度曲线应用</div>
                                <p><strong>题目：</strong>20°C时，将20g NaCl放入50g水中，能否全部溶解？(NaCl在20°C的溶解度为36g)</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①根据溶解度定义：20°C时，100g水最多溶解36g NaCl</p>
                                <p>②计算50g水最多溶解的NaCl质量：</p>
                                <p>　　最大溶解量 = 36g × 50g/100g = 18g</p>
                                <p>③比较：需要溶解20g > 最大溶解18g</p>
                                <p>④不能全部溶解，剩余固体：20 - 18 = 2g</p>
                                <p><strong>答案：</strong>不能全部溶解，剩余2g固体NaCl</p>
                            </div>
                            
                            <div class="step" style="background: #fff; border: 1px solid #ddd;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题3】重结晶提纯</div>
                                <p><strong>题目：</strong>100g含有杂质的KNO₃固体中，KNO₃占90%。用重结晶法提纯，若操作过程中损失为5%，能得到多少克纯KNO₃？</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①计算原料中KNO₃的质量：100g × 90% = 90g</p>
                                <p>②考虑操作损失：实际可得 = 90g × (1 - 5%) = 90g × 95% = 85.5g</p>
                                <p>③重结晶后得到的是纯KNO₃（杂质被除去）</p>
                                <p><strong>答案：</strong>能得到85.5g纯KNO₃</p>
                            </div>
                        </div>
                    </div>

                    <button class="calculate-btn" onclick="calculateSolubility()">
                        <i class="fas fa-calculator"></i> 计算
                    </button>
                </div>

                <div class="result-section">
                    <h4><i class="fas fa-chart-bar"></i> 溶解度结果</h4>
                    <div class="result-display" id="solubilityResult">
                        <div class="result-value" id="solubilityValue">-</div>
                        <div class="result-label" id="solubilityLabel">溶解度 (g/100g水)</div>
                    </div>
                    <div class="step-by-step" id="solubilitySteps" style="display: none;">
                        <!-- 计算步骤将动态添加 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 反应速率计算器 -->
        <div class="calculator-section" id="rate">
            <h3><i class="fas fa-stopwatch"></i> 化学反应速率计算</h3>
            <div class="formula-display">
                v = Δc/Δt  |  Arrhenius方程: k = A·e^(-Ea/RT)
            </div>
            
            <div class="calculation-grid">
                <div class="input-section">
                    <div class="input-group">
                        <label class="input-label">计算类型</label>
                        <select id="rateType" class="calc-select">
                            <option value="averageRate">平均反应速率</option>
                            <option value="concentration">浓度变化计算</option>
                            <option value="halfLife">半衰期计算</option>
                            <option value="temperature">温度效应</option>
                        </select>
                    </div>

                    <div id="rateInputs">
                        <div class="input-group">
                            <label class="input-label">初始浓度 (mol/L)</label>
                            <input type="number" id="initialConc" class="calc-input" placeholder="输入初始浓度">
                        </div>
                        <div class="input-group">
                            <label class="input-label">最终浓度 (mol/L)</label>
                            <input type="number" id="finalConc" class="calc-input" placeholder="输入最终浓度">
                        </div>
                        <div class="input-group">
                            <label class="input-label">时间间隔 (s)</label>
                            <input type="number" id="timeInterval" class="calc-input" placeholder="输入时间间隔">
                        </div>
                        <div class="input-group">
                            <label class="input-label">反应级数</label>
                            <select id="reactionOrder" class="calc-select">
                                <option value="0">零级反应</option>
                                <option value="1">一级反应</option>
                                <option value="2">二级反应</option>
                            </select>
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">温度影响计算</label>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                            <input type="number" id="temp1" class="calc-input" placeholder="初始温度(K)">
                            <input type="number" id="temp2" class="calc-input" placeholder="最终温度(K)">
                        </div>
                    </div>

                    <!-- 考试真题练习 -->
                    <div class="calculation-tip" style="margin-top: 1.5rem;">
                        <h5><i class="fas fa-book-open"></i> 中高考真题详解</h5>
                        <div style="margin-top: 1rem;">
                            <div class="step" style="background: #fff; border: 1px solid #ddd; margin-bottom: 1rem;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题1】平均反应速率</div>
                                <p><strong>题目：</strong>反应A + B → C中，A的浓度在2分钟内从0.8mol/L降至0.6mol/L，求A的平均反应速率。</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①确定浓度变化：Δc(A) = 0.6 - 0.8 = -0.2mol/L</p>
                                <p>②确定时间间隔：Δt = 2min = 120s</p>
                                <p>③计算平均反应速率：v(A) = |Δc(A)|/Δt = 0.2/120 = 0.00167mol/(L·s)</p>
                                <p><strong>注意：</strong>反应速率取绝对值，表示浓度变化的快慢</p>
                                <p><strong>答案：</strong>A的平均反应速率为0.00167mol/(L·s)</p>
                            </div>
                            
                            <div class="step" style="background: #fff; border: 1px solid #ddd; margin-bottom: 1rem;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题2】温度对反应速率的影响</div>
                                <p><strong>题目：</strong>某反应在20°C时的反应速率为v₁，温度升高到30°C时反应速率为v₂。若该反应每升高10°C，反应速率增加为原来的3倍，求v₂/v₁。</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①温度变化：ΔT = 30 - 20 = 10°C</p>
                                <p>②根据范特霍夫规则：温度每升高10°C，反应速率增加3倍</p>
                                <p>③因此：v₂ = 3v₁</p>
                                <p>④速率比：v₂/v₁ = 3</p>
                                <p><strong>答案：</strong>v₂/v₁ = 3</p>
                            </div>
                            
                            <div class="step" style="background: #fff; border: 1px solid #ddd;">
                                <div class="step-title" style="color: #dc3545; font-size: 1rem;">【真题3】催化剂对反应速率的影响</div>
                                <p><strong>题目：</strong>在有催化剂和无催化剂的条件下，某反应的活化能分别为50kJ/mol和80kJ/mol。在相同温度下，催化剂使反应速率增加多少倍？(简化计算)</p>
                                <p><strong>解题步骤：</strong></p>
                                <p>①催化剂降低活化能：ΔEa = 80 - 50 = 30kJ/mol</p>
                                <p>②根据阿伦尼乌斯方程，活化能降低会显著提高反应速率</p>
                                <p>③催化剂只改变反应路径，不改变反应物和产物的能量</p>
                                <p>④催化剂可以使反应速率提高数千倍到数万倍</p>
                                <p><strong>答案：</strong>催化剂显著提高反应速率（具体倍数需更多数据计算）</p>
                            </div>
                        </div>
                    </div>

                    <button class="calculate-btn" onclick="calculateRate()">
                        <i class="fas fa-calculator"></i> 计算
                    </button>
                </div>

                <div class="result-section">
                    <h4><i class="fas fa-chart-bar"></i> 反应速率结果</h4>
                    <div class="result-display" id="rateResult">
                        <div class="result-value" id="rateValue">-</div>
                        <div class="result-label" id="rateLabel">反应速率 (mol/L·s)</div>
                    </div>
                    <div class="step-by-step" id="rateSteps" style="display: none;">
                        <!-- 计算步骤将动态添加 -->
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="main-footer">
        <div class="container">
            <div class="footer-content">
                <p class="copyright-text">study-llm.me域名为Alex所有。保留所有权利。</p>
                <div class="profile-section">
                    <button id="profile-button" class="profile-button">
                        <i class="fas fa-user-circle"></i>
                        学习阶段
                    </button>
                    <div id="profile-display" class="profile-display"></div>
                </div>
            </div>
        </div>
    </footer>

    <script src="../../js/common.js"></script>
    <script src="../../js/navigation.js"></script>
    <script src="../../js/profile.js"></script>
    <script>
        // 元素原子量数据
        const atomicWeights = {
            'H': 1.008, 'He': 4.003, 'Li': 6.941, 'Be': 9.012, 'B': 10.811, 'C': 12.011,
            'N': 14.007, 'O': 15.999, 'F': 18.998, 'Ne': 20.180, 'Na': 22.990, 'Mg': 24.305,
            'Al': 26.982, 'Si': 28.086, 'P': 30.974, 'S': 32.065, 'Cl': 35.453, 'Ar': 39.948,
            'K': 39.098, 'Ca': 40.078, 'Sc': 44.956, 'Ti': 47.867, 'V': 50.942, 'Cr': 51.996,
            'Mn': 54.938, 'Fe': 55.845, 'Co': 58.933, 'Ni': 58.693, 'Cu': 63.546, 'Zn': 65.38,
            'Ga': 69.723, 'Ge': 72.64, 'As': 74.922, 'Se': 78.96, 'Br': 79.904, 'Kr': 83.798,
            'Rb': 85.468, 'Sr': 87.62, 'Y': 88.906, 'Zr': 91.224, 'Nb': 92.906, 'Mo': 95.96,
            'Tc': 98, 'Ru': 101.07, 'Rh': 102.906, 'Pd': 106.42, 'Ag': 107.868, 'Cd': 112.411,
            'In': 114.818, 'Sn': 118.710, 'Sb': 121.760, 'Te': 127.60, 'I': 126.904, 'Xe': 131.293
        };

        // 标签切换
        document.querySelectorAll('.calculator-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.calculator-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.calculator-section').forEach(s => s.classList.remove('active'));
                
                this.classList.add('active');
                document.getElementById(this.dataset.tab).classList.add('active');
            });
        });

        // 设置化合物数据
        function setCompound(formula, mw) {
            document.getElementById('molecularWeight').value = mw;
            // 可以添加更多自动填充逻辑
        }

        // 摩尔浓度计算
        function calculateMolarity() {
            const type = document.getElementById('molarityType').value;
            const mass = parseFloat(document.getElementById('mass').value) || 0;
            const mw = parseFloat(document.getElementById('molecularWeight').value) || 0;
            const volume = parseFloat(document.getElementById('volume').value) || 0;

            let result, steps = [];

            switch(type) {
                case 'molarity':
                    if (mass && mw && volume) {
                        const moles = mass / mw;
                        result = moles / volume;
                        steps = [
                            `步骤1: 计算摩尔数 n = m / MW = ${mass} / ${mw} = ${moles.toFixed(4)} mol`,
                            `步骤2: 计算摩尔浓度 M = n / V = ${moles.toFixed(4)} / ${volume} = ${result.toFixed(4)} M`
                        ];
                    }
                    break;
                case 'moles':
                    const molarity = parseFloat(document.getElementById('molarity').value) || 0;
                    if (molarity && volume) {
                        result = molarity * volume;
                        steps = [`n = M × V = ${molarity} × ${volume} = ${result.toFixed(4)} mol`];
                    }
                    break;
                // 其他计算类型...
            }

            if (result !== undefined) {
                document.getElementById('molarityValue').textContent = result.toFixed(4);
                document.getElementById('molaritySteps').innerHTML = steps.map(step => 
                    `<div class="step"><div class="step-title">计算步骤</div>${step}</div>`
                ).join('');
                document.getElementById('molaritySteps').style.display = 'block';
            }
        }

        // 化学计量学计算
        function calculateStoichiometry() {
            const equation = document.getElementById('equation').value;
            const knownSubstance = document.getElementById('knownSubstance').value;
            const knownAmount = parseFloat(document.getElementById('knownAmount').value) || 0;
            const targetSubstance = document.getElementById('targetSubstance').value;

            // 简化的化学计量学计算逻辑
            // 在实际应用中需要解析化学方程式
            if (knownAmount && knownSubstance && targetSubstance) {
                // 假设1:1的化学计量关系作为示例
                const result = knownAmount; // 简化计算
                document.getElementById('stoichiometryValue').textContent = result.toFixed(4);
                
                const steps = [
                    `根据化学方程式: ${equation}`,
                    `已知 ${knownSubstance}: ${knownAmount} mol`,
                    `目标 ${targetSubstance}: ${result.toFixed(4)} mol`
                ];
                
                document.getElementById('stoichiometrySteps').innerHTML = steps.map(step => 
                    `<div class="step"><div class="step-title">计算步骤</div>${step}</div>`
                ).join('');
                document.getElementById('stoichiometrySteps').style.display = 'block';
            }
        }

        // 组成计算
        function calculateComposition() {
            const formula = document.getElementById('formula').value;
            
            if (formula) {
                const composition = parseFormula(formula);
                let totalMW = 0;
                let resultHTML = '';

                for (const [element, count] of Object.entries(composition)) {
                    const atomicWeight = atomicWeights[element] || 0;
                    const elementMass = atomicWeight * count;
                    totalMW += elementMass;
                }

                document.getElementById('molecularWeightValue').textContent = totalMW.toFixed(3);

                for (const [element, count] of Object.entries(composition)) {
                    const atomicWeight = atomicWeights[element] || 0;
                    const elementMass = atomicWeight * count;
                    const percentage = (elementMass / totalMW * 100).toFixed(2);
                    
                    resultHTML += `
                        <div class="step">
                            <div class="step-title">${element}</div>
                            ${count} 个原子 × ${atomicWeight} g/mol = ${elementMass.toFixed(3)} g/mol (${percentage}%)
                        </div>`;
                }

                document.getElementById('elementComposition').innerHTML = resultHTML;
            }
        }

        // 解析化学式
        function parseFormula(formula) {
            const composition = {};
            const regex = /([A-Z][a-z]?)(\d*)/g;
            let match;

            while ((match = regex.exec(formula)) !== null) {
                const element = match[1];
                const count = parseInt(match[2]) || 1;
                composition[element] = (composition[element] || 0) + count;
            }

            return composition;
        }

        // 气体定律计算
        function calculateGas() {
            const type = document.getElementById('gasType').value;
            const P = parseFloat(document.getElementById('pressure').value) || 0;
            const V = parseFloat(document.getElementById('gasVolume').value) || 0;
            const n = parseFloat(document.getElementById('gasMoles').value) || 0;
            const T = parseFloat(document.getElementById('temperature').value) || 0;
            const R = 0.08206; // L·atm/mol·K

            let result, label, steps = [];

            switch(type) {
                case 'pressure':
                    if (n && R && T && V) {
                        result = (n * R * T) / V;
                        label = '压强 (atm)';
                        steps = [`P = nRT/V = ${n} × ${R} × ${T} / ${V} = ${result.toFixed(4)} atm`];
                    }
                    break;
                case 'volume':
                    if (n && R && T && P) {
                        result = (n * R * T) / P;
                        label = '体积 (L)';
                        steps = [`V = nRT/P = ${n} × ${R} × ${T} / ${P} = ${result.toFixed(4)} L`];
                    }
                    break;
                case 'moles':
                    if (P && V && R && T) {
                        result = (P * V) / (R * T);
                        label = '摩尔数 (mol)';
                        steps = [`n = PV/RT = ${P} × ${V} / (${R} × ${T}) = ${result.toFixed(4)} mol`];
                    }
                    break;
                case 'temperature':
                    if (P && V && n && R) {
                        result = (P * V) / (n * R);
                        label = '温度 (K)';
                        steps = [`T = PV/nR = ${P} × ${V} / (${n} × ${R}) = ${result.toFixed(4)} K`];
                    }
                    break;
            }

            if (result !== undefined) {
                document.getElementById('gasValue').textContent = result.toFixed(4);
                document.getElementById('gasLabel').textContent = label;
                document.getElementById('gasSteps').innerHTML = steps.map(step => 
                    `<div class="step"><div class="step-title">计算步骤</div>${step}</div>`
                ).join('');
                document.getElementById('gasSteps').style.display = 'block';
            }
        }

        // 稀释计算
        function calculateDilution() {
            const type = document.getElementById('dilutionType').value;
            const M1 = parseFloat(document.getElementById('initialConcentration').value) || 0;
            const V1 = parseFloat(document.getElementById('initialVolume').value) || 0;
            const M2 = parseFloat(document.getElementById('finalConcentration').value) || 0;
            const V2 = parseFloat(document.getElementById('finalVolume').value) || 0;

            let result, label, steps = [];

            switch(type) {
                case 'finalVolume':
                    if (M1 && V1 && M2) {
                        result = (M1 * V1) / M2;
                        label = '最终体积 (mL)';
                        steps = [
                            `使用稀释公式: M₁V₁ = M₂V₂`,
                            `V₂ = M₁V₁/M₂ = ${M1} × ${V1} / ${M2} = ${result.toFixed(2)} mL`
                        ];
                    }
                    break;
                case 'finalConcentration':
                    if (M1 && V1 && V2) {
                        result = (M1 * V1) / V2;
                        label = '最终浓度 (M)';
                        steps = [
                            `使用稀释公式: M₁V₁ = M₂V₂`,
                            `M₂ = M₁V₁/V₂ = ${M1} × ${V1} / ${V2} = ${result.toFixed(4)} M`
                        ];
                    }
                    break;
                case 'initialVolume':
                    if (M1 && M2 && V2) {
                        result = (M2 * V2) / M1;
                        label = '所需初始体积 (mL)';
                        steps = [
                            `使用稀释公式: M₁V₁ = M₂V₂`,
                            `V₁ = M₂V₂/M₁ = ${M2} × ${V2} / ${M1} = ${result.toFixed(2)} mL`
                        ];
                    }
                    break;
                case 'waterVolume':
                    if (M1 && V1 && M2) {
                        const finalVolume = (M1 * V1) / M2;
                        result = finalVolume - V1;
                        label = '所需加水体积 (mL)';
                        steps = [
                            `最终体积: V₂ = M₁V₁/M₂ = ${M1} × ${V1} / ${M2} = ${finalVolume.toFixed(2)} mL`,
                            `加水体积 = V₂ - V₁ = ${finalVolume.toFixed(2)} - ${V1} = ${result.toFixed(2)} mL`
                        ];
                    }
                    break;
            }

            if (result !== undefined) {
                document.getElementById('dilutionValue').textContent = result.toFixed(2);
                document.getElementById('dilutionLabel').textContent = label;
                document.getElementById('dilutionSteps').innerHTML = steps.map(step => 
                    `<div class="step"><div class="step-title">计算步骤</div>${step}</div>`
                ).join('');
                document.getElementById('dilutionSteps').style.display = 'block';
            }
        }

        // 添加元素输入行
        function addElement() {
            const container = document.getElementById('elementsInput');
            const newRow = document.createElement('div');
            newRow.className = 'element-row';
            newRow.style.cssText = 'display: grid; grid-template-columns: 1fr 1fr auto; gap: 0.5rem; margin-bottom: 0.5rem;';
            newRow.innerHTML = `
                <input type="text" class="calc-input element-symbol" placeholder="元素符号">
                <input type="number" class="calc-input element-count" placeholder="原子数">
                <button class="calculate-btn" style="width: auto; padding: 0.5rem;" onclick="removeElement(this)">-</button>
            `;
            container.appendChild(newRow);
        }

        // 移除元素输入行
        function removeElement(button) {
            button.parentElement.remove();
        }

        // 响应式处理
        window.addEventListener('resize', function() {
            // 处理响应式布局变化
        });

        // pH计算
        function calculatePH() {
            const type = document.getElementById('phType').value;
            const hConc = parseFloat(document.getElementById('hConcentration').value) || 0;
            const ohConc = parseFloat(document.getElementById('ohConcentration').value) || 0;
            const ph = parseFloat(document.getElementById('phValue').value) || 0;
            const poh = parseFloat(document.getElementById('pohValue').value) || 0;

            let result, label, steps = [], solutionType = '';

            switch(type) {
                case 'fromH':
                    if (hConc > 0) {
                        result = -Math.log10(hConc);
                        label = 'pH值';
                        steps = [`pH = -log[H⁺] = -log(${hConc}) = ${result.toFixed(2)}`];
                        solutionType = result < 7 ? '酸性' : result > 7 ? '碱性' : '中性';
                    }
                    break;
                case 'fromOH':
                    if (ohConc > 0) {
                        result = -Math.log10(ohConc);
                        const phValue = 14 - result;
                        label = 'pOH值';
                        steps = [
                            `pOH = -log[OH⁻] = -log(${ohConc}) = ${result.toFixed(2)}`,
                            `pH = 14 - pOH = 14 - ${result.toFixed(2)} = ${phValue.toFixed(2)}`
                        ];
                        solutionType = phValue < 7 ? '酸性' : phValue > 7 ? '碱性' : '中性';
                    }
                    break;
                case 'toPH':
                    if (ph >= 0 && ph <= 14) {
                        result = Math.pow(10, -ph);
                        label = 'H⁺浓度 (mol/L)';
                        steps = [`[H⁺] = 10^(-pH) = 10^(${-ph}) = ${result.toExponential(2)} mol/L`];
                        solutionType = ph < 7 ? '酸性' : ph > 7 ? '碱性' : '中性';
                    }
                    break;
                case 'toPOH':
                    if (poh >= 0 && poh <= 14) {
                        result = Math.pow(10, -poh);
                        const phValue = 14 - poh;
                        label = 'OH⁻浓度 (mol/L)';
                        steps = [
                            `[OH⁻] = 10^(-pOH) = 10^(${-poh}) = ${result.toExponential(2)} mol/L`,
                            `pH = 14 - pOH = 14 - ${poh} = ${phValue.toFixed(2)}`
                        ];
                        solutionType = phValue < 7 ? '酸性' : phValue > 7 ? '碱性' : '中性';
                    }
                    break;
            }

            if (result !== undefined) {
                document.getElementById('phResultValue').textContent = 
                    typeof result === 'number' && result < 0.001 ? result.toExponential(2) : result.toFixed(4);
                document.getElementById('phResultLabel').textContent = label;
                document.getElementById('solutionTypeValue').textContent = solutionType;
                document.getElementById('phSteps').innerHTML = steps.map(step => 
                    `<div class="step"><div class="step-title">计算步骤</div>${step}</div>`
                ).join('');
                document.getElementById('phSteps').style.display = 'block';
            }
        }

        // 设置酸碱数据
        function setAcidBase(formula, type) {
            // 可以根据type设置相应的默认值
            switch(type) {
                case 'strong_acid':
                    document.getElementById('hConcentration').value = '0.1';
                    break;
                case 'strong_base':
                    document.getElementById('ohConcentration').value = '0.1';
                    break;
            }
        }

        // 溶解度计算
        function calculateSolubility() {
            const type = document.getElementById('solubilityType').value;
            const soluteMass = parseFloat(document.getElementById('soluteMass').value) || 0;
            const solventMass = parseFloat(document.getElementById('solventMass').value) || 0;
            const temp = parseFloat(document.getElementById('temperature').value) || 20;
            const givenSolubility = parseFloat(document.getElementById('givenSolubility').value) || 0;

            let result, label, steps = [];

            switch(type) {
                case 'solubility':
                    if (soluteMass && solventMass) {
                        result = (soluteMass / solventMass) * 100;
                        label = '溶解度 (g/100g水)';
                        steps = [
                            `溶解度 = (溶质质量 / 溶剂质量) × 100g`,
                            `溶解度 = (${soluteMass}g / ${solventMass}g) × 100g = ${result.toFixed(2)}g/100g水`
                        ];
                    }
                    break;
                case 'saturated':
                    if (givenSolubility && solventMass) {
                        result = (givenSolubility * solventMass) / 100;
                        label = '饱和时溶质质量 (g)';
                        steps = [
                            `在${temp}°C时，${solventMass}g水中最多能溶解的溶质质量：`,
                            `质量 = 溶解度 × 溶剂质量 / 100g = ${givenSolubility} × ${solventMass} / 100 = ${result.toFixed(2)}g`
                        ];
                    }
                    break;
                case 'crystallization':
                    if (soluteMass && solventMass && givenSolubility) {
                        const maxSoluble = (givenSolubility * solventMass) / 100;
                        result = Math.max(0, soluteMass - maxSoluble);
                        label = '析出晶体质量 (g)';
                        steps = [
                            `当前温度下最大溶解质量 = ${givenSolubility} × ${solventMass} / 100 = ${maxSoluble.toFixed(2)}g`,
                            `析出质量 = 总溶质 - 最大溶解质量 = ${soluteMass} - ${maxSoluble.toFixed(2)} = ${result.toFixed(2)}g`
                        ];
                    }
                    break;
            }

            if (result !== undefined) {
                document.getElementById('solubilityValue').textContent = result.toFixed(2);
                document.getElementById('solubilityLabel').textContent = label;
                document.getElementById('solubilitySteps').innerHTML = steps.map(step => 
                    `<div class="step"><div class="step-title">计算步骤</div>${step}</div>`
                ).join('');
                document.getElementById('solubilitySteps').style.display = 'block';
            }
        }

        // 设置溶解度数据
        function setSolubility(compound, solubility) {
            document.getElementById('givenSolubility').value = solubility;
        }

        // 反应速率计算
        function calculateRate() {
            const type = document.getElementById('rateType').value;
            const initialConc = parseFloat(document.getElementById('initialConc').value) || 0;
            const finalConc = parseFloat(document.getElementById('finalConc').value) || 0;
            const timeInterval = parseFloat(document.getElementById('timeInterval').value) || 0;
            const order = parseInt(document.getElementById('reactionOrder').value);
            const temp1 = parseFloat(document.getElementById('temp1').value) || 0;
            const temp2 = parseFloat(document.getElementById('temp2').value) || 0;

            let result, label, steps = [];

            switch(type) {
                case 'averageRate':
                    if (initialConc && finalConc && timeInterval) {
                        result = Math.abs(finalConc - initialConc) / timeInterval;
                        label = '平均反应速率 (mol/L·s)';
                        steps = [
                            `平均反应速率 = |Δc| / Δt`,
                            `v = |${finalConc} - ${initialConc}| / ${timeInterval} = ${result.toFixed(6)} mol/L·s`
                        ];
                    }
                    break;
                case 'concentration':
                    if (initialConc && timeInterval) {
                        // 简化的浓度计算，假设反应速率常数k=0.01
                        const k = 0.01;
                        switch(order) {
                            case 0:
                                result = initialConc - k * timeInterval;
                                steps = [
                                    `零级反应: [A] = [A]₀ - kt`,
                                    `[A] = ${initialConc} - ${k} × ${timeInterval} = ${result.toFixed(4)} mol/L`
                                ];
                                break;
                            case 1:
                                result = initialConc * Math.exp(-k * timeInterval);
                                steps = [
                                    `一级反应: [A] = [A]₀ × e^(-kt)`,
                                    `[A] = ${initialConc} × e^(-${k} × ${timeInterval}) = ${result.toFixed(4)} mol/L`
                                ];
                                break;
                            case 2:
                                result = initialConc / (1 + k * initialConc * timeInterval);
                                steps = [
                                    `二级反应: 1/[A] = 1/[A]₀ + kt`,
                                    `[A] = ${initialConc} / (1 + ${k} × ${initialConc} × ${timeInterval}) = ${result.toFixed(4)} mol/L`
                                ];
                                break;
                        }
                        label = '反应后浓度 (mol/L)';
                    }
                    break;
                case 'halfLife':
                    if (initialConc) {
                        const k = 0.01; // 假设反应速率常数
                        switch(order) {
                            case 0:
                                result = initialConc / (2 * k);
                                steps = [`零级反应半衰期: t₁/₂ = [A]₀ / (2k) = ${initialConc} / (2 × ${k}) = ${result.toFixed(2)} s`];
                                break;
                            case 1:
                                result = Math.log(2) / k;
                                steps = [`一级反应半衰期: t₁/₂ = ln(2) / k = 0.693 / ${k} = ${result.toFixed(2)} s`];
                                break;
                            case 2:
                                result = 1 / (k * initialConc);
                                steps = [`二级反应半衰期: t₁/₂ = 1 / (k[A]₀) = 1 / (${k} × ${initialConc}) = ${result.toFixed(2)} s`];
                                break;
                        }
                        label = '半衰期 (s)';
                    }
                    break;
                case 'temperature':
                    if (temp1 && temp2) {
                        // 范特霍夫规则：温度每升高10K，反应速率约增加2-4倍
                        const tempDiff = temp2 - temp1;
                        const factor = Math.pow(2.5, tempDiff / 10); // 假设每10K增加2.5倍
                        result = factor;
                        label = '速率变化倍数';
                        steps = [
                            `根据范特霍夫规则，温度从${temp1}K升至${temp2}K`,
                            `温度差 = ${tempDiff}K`,
                            `速率变化倍数 ≈ 2.5^(${tempDiff}/10) = ${result.toFixed(2)}倍`
                        ];
                    }
                    break;
            }

            if (result !== undefined) {
                document.getElementById('rateValue').textContent = result.toFixed(4);
                document.getElementById('rateLabel').textContent = label;
                document.getElementById('rateSteps').innerHTML = steps.map(step => 
                    `<div class="step"><div class="step-title">计算步骤</div>${step}</div>`
                ).join('');
                document.getElementById('rateSteps').style.display = 'block';
            }
        }

        // 更新pH指示器
        function updatePHIndicator(phValue) {
            const marker = document.getElementById('phMarker');
            if (marker && phValue >= 0 && phValue <= 14) {
                const percentage = (phValue / 14) * 100;
                marker.style.left = `calc(${percentage}% - 2px)`;
            }
        }

        // 演示计算功能
        function demoCalculation(type, example) {
            switch(type) {
                case 'ph':
                    switch(example) {
                        case 'lemon':
                            document.getElementById('hConcentration').value = '0.01';
                            document.getElementById('phType').value = 'fromH';
                            calculatePH();
                            break;
                        case 'water':
                            document.getElementById('hConcentration').value = '0.0000001';
                            document.getElementById('phType').value = 'fromH';
                            calculatePH();
                            break;
                        case 'soap':
                            document.getElementById('ohConcentration').value = '0.000001';
                            document.getElementById('phType').value = 'fromOH';
                            calculatePH();
                            break;
                    }
                    break;
            }
        }

        // 考试真题示例
        function examExample(type, questionNumber) {
            switch(type) {
                case 'molarity':
                    switch(questionNumber) {
                        case 1:
                            // 真题1: 配制250mL 0.1mol/L的NaCl溶液，需要多少克NaCl？
                            document.getElementById('molarityType').value = 'mass';
                            document.getElementById('volume').value = '0.25';
                            document.getElementById('molecularWeight').value = '58.44';
                            showSuccess('真题1: 配制250mL 0.1mol/L的NaCl溶液，需要多少克NaCl？');
                            // 设置摩尔浓度
                            setTimeout(() => {
                                // 模拟设置浓度并计算
                                const n = 0.1 * 0.25; // 摩尔数
                                const mass = n * 58.44;
                                document.getElementById('molarityValue').textContent = mass.toFixed(2);
                                document.getElementById('molarityLabel').textContent = '所需NaCl质量 (g)';
                                document.getElementById('molaritySteps').innerHTML = `
                                    <div class="step"><div class="step-title">解题步骤</div>
                                    步骤1: 计算所需摩尔数 n = M × V = 0.1 × 0.25 = 0.025 mol<br>
                                    步骤2: 计算质量 m = n × Mr = 0.025 × 58.44 = 1.46 g
                                    </div>`;
                                document.getElementById('molaritySteps').style.display = 'block';
                            }, 1000);
                            break;
                        case 2:
                            // 真题2: 将98%的浓硫酸(密度1.84g/mL)稀释至0.5mol/L，求原溶液的摩尔浓度
                            showSuccess('真题2: 98%浓硫酸(密度1.84g/mL)的摩尔浓度是多少？');
                            setTimeout(() => {
                                // 浓硫酸摩尔浓度计算
                                const density = 1.84; // g/mL
                                const percentage = 0.98;
                                const molarMass = 98.08;
                                const molarity = (density * 1000 * percentage) / molarMass;
                                document.getElementById('molarityValue').textContent = molarity.toFixed(2);
                                document.getElementById('molarityLabel').textContent = '浓硫酸摩尔浓度 (mol/L)';
                                document.getElementById('molaritySteps').innerHTML = `
                                    <div class="step"><div class="step-title">解题步骤</div>
                                    步骤1: 1L溶液质量 = 1000mL × 1.84g/mL = 1840g<br>
                                    步骤2: H₂SO₄质量 = 1840g × 98% = 1803.2g<br>
                                    步骤3: 摩尔浓度 = 1803.2g ÷ 98.08g/mol = ${molarity.toFixed(2)} mol/L
                                    </div>`;
                                document.getElementById('molaritySteps').style.display = 'block';
                            }, 1000);
                            break;
                        case 3:
                            // 真题3: 中和反应计算
                            showSuccess('真题3: 用0.2mol/L NaOH溶液中和0.1mol/L H₂SO₄，体积比是多少？');
                            setTimeout(() => {
                                // H₂SO₄ + 2NaOH → Na₂SO₄ + 2H₂O
                                const ratioMol = 2; // 摩尔比 NaOH:H₂SO₄ = 2:1
                                const ratioConc = 0.2 / 0.1; // 浓度比
                                const volumeRatio = ratioMol / ratioConc; // 体积比
                                document.getElementById('molarityValue').textContent = volumeRatio.toFixed(1);
                                document.getElementById('molarityLabel').textContent = 'NaOH:H₂SO₄体积比';
                                document.getElementById('molaritySteps').innerHTML = `
                                    <div class="step"><div class="step-title">解题步骤</div>
                                    步骤1: 反应方程式 H₂SO₄ + 2NaOH → Na₂SO₄ + 2H₂O<br>
                                    步骤2: 摩尔比 n(NaOH):n(H₂SO₄) = 2:1<br>
                                    步骤3: 体积比 V(NaOH):V(H₂SO₄) = (2×0.1):(1×0.2) = 1:1
                                    </div>`;
                                document.getElementById('molaritySteps').style.display = 'block';
                            }, 1000);
                            break;
                    }
                    break;
            }
        }

        // 错误处理和验证
        function validateInput(inputId, min, max) {
            const input = document.getElementById(inputId);
            const value = parseFloat(input.value);
            
            if (value < min || value > max) {
                showError(`${inputId}的值应在${min}到${max}之间`);
                return false;
            }
            return true;
        }

        function showError(message) {
            const errorDiv = document.querySelector('.error-message');
            if (errorDiv) {
                errorDiv.textContent = message;
                errorDiv.style.display = 'block';
                setTimeout(() => {
                    errorDiv.style.display = 'none';
                }, 3000);
            }
        }

        function showSuccess(message) {
            const successDiv = document.querySelector('.success-message');
            if (successDiv) {
                successDiv.textContent = message;
                successDiv.style.display = 'block';
                setTimeout(() => {
                    successDiv.style.display = 'none';
                }, 3000);
            }
        }

        // 添加学习模式功能
        function toggleLearningMode() {
            const tips = document.querySelectorAll('.calculation-tip');
            const demos = document.querySelectorAll('.interactive-demo');
            
            tips.forEach(tip => {
                tip.style.display = tip.style.display === 'none' ? 'block' : 'none';
            });
            
            demos.forEach(demo => {
                demo.style.display = demo.style.display === 'none' ? 'block' : 'none';
            });
        }

        // 键盘快捷键支持
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'Enter':
                        e.preventDefault();
                        // 执行当前活跃标签的计算
                        const activeTab = document.querySelector('.calculator-tab.active');
                        if (activeTab) {
                            const tabType = activeTab.dataset.tab;
                            switch(tabType) {
                                case 'molarity': calculateMolarity(); break;
                                case 'stoichiometry': calculateStoichiometry(); break;
                                case 'composition': calculateComposition(); break;
                                case 'gas': calculateGas(); break;
                                case 'dilution': calculateDilution(); break;
                                case 'ph': calculatePH(); break;
                                case 'solubility': calculateSolubility(); break;
                                case 'rate': calculateRate(); break;
                            }
                        }
                        break;
                }
            }
        });

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 添加错误和成功消息容器
            const container = document.querySelector('.calculator-container');
            if (container && !document.querySelector('.error-message')) {
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-message';
                container.appendChild(errorDiv);
                
                const successDiv = document.createElement('div');
                successDiv.className = 'success-message';
                container.appendChild(successDiv);
            }
        });
    </script>
</body>
</html> 