<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>气候与天气 - 地理学习助手</title>
    <link rel="icon" href="../../assets/icons/logo_btrfly.ico" type="image/x-icon">
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../../css/components.css">
    <link rel="stylesheet" href="../../css/utilities.css">
    <link rel="stylesheet" href="../../css/responsive.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        .climate-page {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 2rem 0;
        }

        .climate-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            margin: 2rem auto;
            max-width: 1600px;
            width: 100%;
        }

        .climate-header {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 2rem;
            text-align: center;
        }

        .climate-header h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 700;
        }

        .climate-header p {
            margin: 1rem 0 0 0;
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .climate-tabs {
            background: #f8f9fa;
            padding: 0;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            overflow-x: auto;
        }

        .climate-tab {
            padding: 1rem 2rem;
            background: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            color: #666;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
        }

        .climate-tab.active {
            color: #28a745;
            border-bottom-color: #28a745;
            background: white;
        }

        .climate-tab:hover {
            color: #28a745;
            background: #f0f8ff;
        }

        .climate-content {
            padding: 2rem;
            min-height: 600px;
        }

        .tab-panel {
            display: none;
        }

        .tab-panel.active {
            display: block;
        }

        .weather-workspace {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 2rem;
            min-height: 400px;
            height: auto;
        }

        .weather-display {
            background: #f8f9fa;
            border-radius: 15px;
            position: relative;
            overflow: hidden;
            border: 2px solid #e9ecef;
            min-height: 400px;
        }

        .weather-canvas {
            width: 100%;
            height: 100%;
            display: block;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            min-height: 400px;
        }

        .weather-controls {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            height: fit-content;
            border: 1px solid #e9ecef;
            overflow-y: auto;
            max-height: 80vh;
        }

        .weather-controls h3 {
            margin: 0 0 1rem 0;
            color: #28a745;
            font-size: 1.2rem;
        }

        .weather-data {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .data-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            border: 1px solid #e9ecef;
            text-align: center;
            transition: all 0.3s ease;
        }

        .data-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(40, 167, 69, 0.15);
        }

        .data-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #28a745;
            margin-bottom: 0.5rem;
        }

        .data-label {
            font-size: 0.9rem;
            color: #666;
        }

        .data-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: #28a745;
        }

        .climate-zones {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 2rem;
        }

        .zone-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .zone-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            border: 1px solid #e9ecef;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .zone-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(40, 167, 69, 0.15);
        }

        .zone-card h4 {
            color: #28a745;
            margin: 0 0 1rem 0;
        }

        .zone-card p {
            color: #666;
            margin: 0;
            line-height: 1.5;
        }

        .zone-features {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .zone-feature {
            background: linear-gradient(135deg, rgba(40, 167, 69, 0.1), rgba(32, 201, 151, 0.1));
            color: #28a745;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .weather-patterns {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 2rem;
        }

        .pattern-selector {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .pattern-btn {
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .pattern-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }

        .pattern-btn.secondary {
            background: linear-gradient(135deg, #6c757d, #495057);
        }

        .pattern-display {
            background: white;
            border-radius: 10px;
            padding: 2rem;
            border: 1px solid #e9ecef;
            min-height: 300px;
        }

        .pattern-animation {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-radius: 10px;
            position: relative;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .cloud {
            position: absolute;
            background: white;
            border-radius: 50px;
            opacity: 0.8;
            animation: float 6s ease-in-out infinite;
        }

        .cloud::before,
        .cloud::after {
            content: '';
            position: absolute;
            background: white;
            border-radius: 50px;
        }

        .cloud1 {
            width: 60px;
            height: 30px;
            top: 20px;
            left: -60px;
            animation: drift 15s linear infinite;
        }

        .cloud1::before {
            width: 40px;
            height: 40px;
            top: -20px;
            left: 10px;
        }

        .cloud1::after {
            width: 30px;
            height: 30px;
            top: -10px;
            right: 10px;
        }

        .rain {
            position: absolute;
            width: 2px;
            height: 20px;
            background: #4fc3f7;
            border-radius: 1px;
            animation: fall 1s linear infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes drift {
            0% { left: -60px; }
            100% { left: 100%; }
        }

        @keyframes fall {
            0% { top: -20px; opacity: 1; }
            100% { top: 200px; opacity: 0; }
        }

        .forecast-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 2rem;
        }

        .forecast-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .forecast-card {
            background: white;
            border-radius: 10px;
            padding: 1rem;
            text-align: center;
            border: 1px solid #e9ecef;
        }

        .forecast-day {
            font-weight: 600;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .forecast-icon {
            font-size: 2rem;
            margin: 0.5rem 0;
            color: #28a745;
        }

        .forecast-temp {
            font-size: 1.2rem;
            font-weight: bold;
            color: #28a745;
        }

        .forecast-desc {
            font-size: 0.8rem;
            color: #666;
            margin-top: 0.5rem;
        }

        @media (max-width: 1024px) {
            .weather-workspace {
                grid-template-columns: 1fr 280px;
                gap: 1rem;
            }
            
            .weather-controls {
                padding: 1rem;
            }
        }

        @media (max-width: 768px) {
            .climate-page {
                padding: 1rem 0;
            }
            
            .climate-container {
                margin: 1rem;
                border-radius: 15px;
            }
            
            .climate-header {
                padding: 1.5rem 1rem;
            }
            
            .climate-header h1 {
                font-size: 2rem;
            }
            
            .climate-content {
                padding: 1rem;
            }
            
            .weather-workspace {
                grid-template-columns: 1fr;
                gap: 1rem;
                min-height: auto;
            }
            
            .weather-display {
                min-height: 300px;
                order: 2;
            }
            
            .weather-canvas {
                min-height: 300px;
            }
            
            .weather-controls {
                order: 1;
                max-height: none;
                overflow-y: visible;
            }
            
            .climate-tabs {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                scrollbar-width: none;
                -ms-overflow-style: none;
            }
            
            .climate-tabs::-webkit-scrollbar {
                display: none;
            }
            
            .climate-tab {
                text-align: center;
                padding: 0.75rem 1.5rem;
                font-size: 0.9rem;
            }
            
            .weather-data {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.75rem;
            }
            
            .data-card {
                padding: 1rem;
            }
            
            .data-icon {
                font-size: 1.5rem;
                margin-bottom: 0.5rem;
            }
            
            .data-value {
                font-size: 1.4rem;
            }
            
            .zone-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .zone-card {
                padding: 1rem;
            }
            
            .pattern-selector {
                flex-wrap: wrap;
                gap: 0.5rem;
            }
            
            .pattern-btn {
                padding: 0.5rem 1rem;
                font-size: 0.9rem;
                flex: 1;
                min-width: 120px;
            }
            
            .forecast-grid {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
                gap: 0.75rem;
            }
            
            .forecast-card {
                padding: 0.75rem;
            }
        }

        @media (max-width: 480px) {
            .climate-header h1 {
                font-size: 1.75rem;
            }
            
            .climate-header p {
                font-size: 1rem;
            }
            
            .weather-data {
                grid-template-columns: 1fr;
            }
            
            .data-card {
                padding: 0.75rem;
            }
            
            .pattern-btn {
                min-width: 100px;
                padding: 0.5rem 0.75rem;
                font-size: 0.85rem;
            }
            
            .forecast-grid {
                grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            }
        }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="../../index.html">
                        <i class="fas fa-graduation-cap" style="background: linear-gradient(90deg, #4361ee, #7209b7); -webkit-background-clip: text; background-clip: text; color: transparent;"></i>
                        <span>Alex的学习助手</span>
                    </a>
                </div>
                <nav class="main-nav">
                    <ul>
                        <li><a href="../../index.html">首页</a></li>
                        <li><a href="main.html">地理</a></li>
                        <li><a href="../../index.html#subjects">科目</a></li>
                        <li><a href="../../tts.html">语音</a></li>
                        <li><a href="../../draw.html">绘图</a></li>
                    </ul>
                </nav>
                <button class="mobile-menu-toggle" aria-label="切换菜单">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </header>

    <main class="climate-page">
        <div class="container">
            <div class="climate-container">
                <div class="climate-header">
                    <h1><i class="fas fa-cloud-sun"></i> 气候与天气</h1>
                    <p>探索全球气候模式、天气现象和大气科学</p>
                </div>

                <div class="climate-tabs">
                    <button class="climate-tab active" data-tab="weather">天气监测</button>
                    <button class="climate-tab" data-tab="climate">气候带</button>
                    <button class="climate-tab" data-tab="patterns">天气模式</button>
                    <button class="climate-tab" data-tab="forecast">天气预报</button>
                </div>

                <div class="climate-content">
                    <!-- 天气监测标签页 -->
                    <div class="tab-panel active" id="weather-panel">
                        <div class="weather-workspace">
                            <div class="weather-display">
                                <canvas class="weather-canvas" id="weather-canvas"></canvas>
                            </div>
                            
                            <div class="weather-controls">
                                <h3><i class="fas fa-thermometer-half"></i> 实时天气数据</h3>
                                
                                <div class="weather-data">
                                    <div class="data-card">
                                        <div class="data-icon">
                                            <i class="fas fa-thermometer-half"></i>
                                        </div>
                                        <div class="data-value" id="temperature">22°C</div>
                                        <div class="data-label">温度</div>
                                    </div>
                                    
                                    <div class="data-card">
                                        <div class="data-icon">
                                            <i class="fas fa-tint"></i>
                                        </div>
                                        <div class="data-value" id="humidity">65%</div>
                                        <div class="data-label">湿度</div>
                                    </div>
                                    
                                    <div class="data-card">
                                        <div class="data-icon">
                                            <i class="fas fa-wind"></i>
                                        </div>
                                        <div class="data-value" id="wind-speed">12 km/h</div>
                                        <div class="data-label">风速</div>
                                    </div>
                                    
                                    <div class="data-card">
                                        <div class="data-icon">
                                            <i class="fas fa-compress-arrows-alt"></i>
                                        </div>
                                        <div class="data-value" id="pressure">1013 hPa</div>
                                        <div class="data-label">气压</div>
                                    </div>
                                </div>

                                <div class="pattern-selector">
                                    <button class="pattern-btn" id="update-weather">更新数据</button>
                                    <button class="pattern-btn secondary" id="reset-weather">重置</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 气候带标签页 -->
                    <div class="tab-panel" id="climate-panel">
                        <h2>全球气候带分布</h2>
                        <div class="climate-zones">
                            <div class="zone-grid">
                                <div class="zone-card" data-zone="tropical">
                                    <h4>🌴 热带气候</h4>
                                    <p>全年高温多雨，年平均气温在20°C以上，降水量丰富，季节变化不明显。</p>
                                    <div class="zone-features">
                                        <span class="zone-feature">高温</span>
                                        <span class="zone-feature">多雨</span>
                                        <span class="zone-feature">湿润</span>
                                    </div>
                                </div>
                                
                                <div class="zone-card" data-zone="subtropical">
                                    <h4>🌞 亚热带气候</h4>
                                    <p>夏季炎热多雨，冬季温和少雨，四季分明，适宜农业发展。</p>
                                    <div class="zone-features">
                                        <span class="zone-feature">四季分明</span>
                                        <span class="zone-feature">雨热同期</span>
                                        <span class="zone-feature">适宜农业</span>
                                    </div>
                                </div>
                                
                                <div class="zone-card" data-zone="temperate">
                                    <h4>🍂 温带气候</h4>
                                    <p>四季变化明显，夏季温暖，冬季寒冷，降水适中，分布广泛。</p>
                                    <div class="zone-features">
                                        <span class="zone-feature">四季明显</span>
                                        <span class="zone-feature">降水适中</span>
                                        <span class="zone-feature">分布广泛</span>
                                    </div>
                                </div>
                                
                                <div class="zone-card" data-zone="continental">
                                    <h4>🏔️ 大陆性气候</h4>
                                    <p>夏季炎热，冬季严寒，昼夜温差大，降水较少，主要分布在内陆地区。</p>
                                    <div class="zone-features">
                                        <span class="zone-feature">温差大</span>
                                        <span class="zone-feature">降水少</span>
                                        <span class="zone-feature">内陆分布</span>
                                    </div>
                                </div>
                                
                                <div class="zone-card" data-zone="polar">
                                    <h4>❄️ 极地气候</h4>
                                    <p>全年严寒，降水稀少，主要为雪，植被稀少，分布在极地地区。</p>
                                    <div class="zone-features">
                                        <span class="zone-feature">严寒</span>
                                        <span class="zone-feature">降雪</span>
                                        <span class="zone-feature">植被稀少</span>
                                    </div>
                                </div>
                                
                                <div class="zone-card" data-zone="desert">
                                    <h4>🏜️ 干旱气候</h4>
                                    <p>降水极少，蒸发强烈，昼夜温差极大，植被稀疏，沙漠广布。</p>
                                    <div class="zone-features">
                                        <span class="zone-feature">极度干旱</span>
                                        <span class="zone-feature">温差极大</span>
                                        <span class="zone-feature">沙漠化</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 天气模式标签页 -->
                    <div class="tab-panel" id="patterns-panel">
                        <h2>天气现象模拟</h2>
                        <div class="weather-patterns">
                            <div class="pattern-selector">
                                <button class="pattern-btn" id="show-rain">降雨</button>
                                <button class="pattern-btn" id="show-snow">降雪</button>
                                <button class="pattern-btn" id="show-storm">雷暴</button>
                                <button class="pattern-btn" id="show-wind">大风</button>
                                <button class="pattern-btn secondary" id="clear-pattern">清除</button>
                            </div>
                            
                            <div class="pattern-display">
                                <div class="pattern-animation" id="pattern-animation">
                                    <div class="cloud cloud1"></div>
                                </div>
                                
                                <div id="pattern-description">
                                    <h4>天气现象说明</h4>
                                    <p>选择上方按钮查看不同天气现象的形成过程和特征。</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 天气预报标签页 -->
                    <div class="tab-panel" id="forecast-panel">
                        <h2>7天天气预报</h2>
                        <div class="forecast-section">
                            <div class="forecast-grid" id="forecast-grid">
                                <div class="forecast-card">
                                    <div class="forecast-day">今天</div>
                                    <div class="forecast-icon"><i class="fas fa-sun"></i></div>
                                    <div class="forecast-temp">25°C</div>
                                    <div class="forecast-desc">晴朗</div>
                                </div>
                                
                                <div class="forecast-card">
                                    <div class="forecast-day">明天</div>
                                    <div class="forecast-icon"><i class="fas fa-cloud-sun"></i></div>
                                    <div class="forecast-temp">23°C</div>
                                    <div class="forecast-desc">多云</div>
                                </div>
                                
                                <div class="forecast-card">
                                    <div class="forecast-day">后天</div>
                                    <div class="forecast-icon"><i class="fas fa-cloud-rain"></i></div>
                                    <div class="forecast-temp">20°C</div>
                                    <div class="forecast-desc">小雨</div>
                                </div>
                                
                                <div class="forecast-card">
                                    <div class="forecast-day">周四</div>
                                    <div class="forecast-icon"><i class="fas fa-cloud-rain"></i></div>
                                    <div class="forecast-temp">18°C</div>
                                    <div class="forecast-desc">中雨</div>
                                </div>
                                
                                <div class="forecast-card">
                                    <div class="forecast-day">周五</div>
                                    <div class="forecast-icon"><i class="fas fa-cloud"></i></div>
                                    <div class="forecast-temp">21°C</div>
                                    <div class="forecast-desc">阴天</div>
                                </div>
                                
                                <div class="forecast-card">
                                    <div class="forecast-day">周六</div>
                                    <div class="forecast-icon"><i class="fas fa-cloud-sun"></i></div>
                                    <div class="forecast-temp">24°C</div>
                                    <div class="forecast-desc">多云</div>
                                </div>
                                
                                <div class="forecast-card">
                                    <div class="forecast-day">周日</div>
                                    <div class="forecast-icon"><i class="fas fa-sun"></i></div>
                                    <div class="forecast-temp">26°C</div>
                                    <div class="forecast-desc">晴朗</div>
                                </div>
                            </div>

                            <div class="pattern-selector">
                                <button class="pattern-btn" id="generate-forecast">生成新预报</button>
                                <button class="pattern-btn secondary" id="export-forecast">导出数据</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="main-footer">
        <div class="container">
            <div class="footer-content">
                <p class="copyright-text">study-llm.me域名为Alex所有。保留所有权利。</p>
            </div>
        </div>
    </footer>

    <script src="../../js/common.js"></script>
    <script src="../../js/navigation.js"></script>
    <script>
        // 气候与天气功能
        class ClimateWeather {
            constructor() {
                this.canvas = document.getElementById('weather-canvas');
                this.ctx = this.canvas.getContext('2d');
                this.animationId = null;
                this.weatherData = this.initializeWeatherData();
                
                this.initializeEventListeners();
                this.setupCanvasResponsiveness();
                this.drawWeatherMap();
                this.startWeatherAnimation();
            }

            setupCanvasResponsiveness() {
                const resizeCanvas = () => {
                    const container = this.canvas.parentElement;
                    const rect = container.getBoundingClientRect();
                    
                    // Set canvas size to match container
                    this.canvas.width = rect.width;
                    this.canvas.height = rect.height;
                    
                    // Redraw after resize
                    this.drawWeatherMap();
                };

                // Initial resize
                resizeCanvas();

                // Resize on window resize
                window.addEventListener('resize', resizeCanvas);

                // Resize when tab becomes active
                const observer = new MutationObserver((mutations) => {
                    mutations.forEach((mutation) => {
                        if (mutation.type === 'attributes' && 
                            mutation.attributeName === 'class' &&
                            mutation.target.classList.contains('active')) {
                            setTimeout(resizeCanvas, 100);
                        }
                    });
                });

                observer.observe(document.getElementById('weather-panel'), {
                    attributes: true,
                    attributeFilter: ['class']
                });
            }

            initializeWeatherData() {
                return {
                    temperature: 22,
                    humidity: 65,
                    windSpeed: 12,
                    pressure: 1013,
                    conditions: 'sunny'
                };
            }

            initializeEventListeners() {
                // 标签页切换
                document.querySelectorAll('.climate-tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        this.switchTab(e.target.dataset.tab);
                    });
                });

                // 天气控制
                document.getElementById('update-weather').addEventListener('click', () => {
                    this.updateWeatherData();
                });

                document.getElementById('reset-weather').addEventListener('click', () => {
                    this.resetWeatherData();
                });

                // 气候带选择
                document.querySelectorAll('.zone-card').forEach(card => {
                    card.addEventListener('click', (e) => {
                        this.selectClimateZone(e.currentTarget.dataset.zone);
                    });
                });

                // 天气模式
                document.getElementById('show-rain').addEventListener('click', () => {
                    this.showWeatherPattern('rain');
                });

                document.getElementById('show-snow').addEventListener('click', () => {
                    this.showWeatherPattern('snow');
                });

                document.getElementById('show-storm').addEventListener('click', () => {
                    this.showWeatherPattern('storm');
                });

                document.getElementById('show-wind').addEventListener('click', () => {
                    this.showWeatherPattern('wind');
                });

                document.getElementById('clear-pattern').addEventListener('click', () => {
                    this.clearWeatherPattern();
                });

                // 天气预报
                document.getElementById('generate-forecast').addEventListener('click', () => {
                    this.generateForecast();
                });

                document.getElementById('export-forecast').addEventListener('click', () => {
                    this.exportForecast();
                });
            }

            switchTab(tabName) {
                // 更新标签页状态
                document.querySelectorAll('.climate-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

                // 显示对应面板
                document.querySelectorAll('.tab-panel').forEach(panel => {
                    panel.classList.remove('active');
                });
                document.getElementById(`${tabName}-panel`).classList.add('active');
            }

            drawWeatherMap() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);

                // 绘制天空背景
                const gradient = this.ctx.createLinearGradient(0, 0, 0, this.canvas.height);
                gradient.addColorStop(0, '#87CEEB');
                gradient.addColorStop(1, '#E0F6FF');
                this.ctx.fillStyle = gradient;
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);

                // 绘制太阳
                this.ctx.fillStyle = '#FFD700';
                this.ctx.beginPath();
                this.ctx.arc(150, 100, 40, 0, 2 * Math.PI);
                this.ctx.fill();

                // 绘制太阳光线
                this.ctx.strokeStyle = '#FFD700';
                this.ctx.lineWidth = 3;
                for (let i = 0; i < 8; i++) {
                    const angle = (i * Math.PI) / 4;
                    const x1 = 150 + Math.cos(angle) * 60;
                    const y1 = 100 + Math.sin(angle) * 60;
                    const x2 = 150 + Math.cos(angle) * 80;
                    const y2 = 100 + Math.sin(angle) * 80;
                    
                    this.ctx.beginPath();
                    this.ctx.moveTo(x1, y1);
                    this.ctx.lineTo(x2, y2);
                    this.ctx.stroke();
                }

                // 绘制云朵
                this.drawCloud(400, 120, 80, '#FFFFFF');
                this.drawCloud(600, 80, 60, '#F0F0F0');

                // 绘制地面
                this.ctx.fillStyle = '#90EE90';
                this.ctx.fillRect(0, this.canvas.height - 100, this.canvas.width, 100);

                // 绘制山脉
                this.ctx.fillStyle = '#8B7355';
                this.ctx.beginPath();
                this.ctx.moveTo(0, this.canvas.height - 100);
                this.ctx.lineTo(200, this.canvas.height - 200);
                this.ctx.lineTo(400, this.canvas.height - 150);
                this.ctx.lineTo(600, this.canvas.height - 180);
                this.ctx.lineTo(800, this.canvas.height - 120);
                this.ctx.lineTo(800, this.canvas.height - 100);
                this.ctx.closePath();
                this.ctx.fill();

                // 绘制温度和风向指示
                this.ctx.fillStyle = '#333';
                this.ctx.font = '16px Arial';
                this.ctx.fillText(`温度: ${this.weatherData.temperature}°C`, 20, 30);
                this.ctx.fillText(`湿度: ${this.weatherData.humidity}%`, 20, 50);
                this.ctx.fillText(`风速: ${this.weatherData.windSpeed} km/h`, 20, 70);
            }

            drawCloud(x, y, size, color) {
                this.ctx.fillStyle = color;
                
                // 主体
                this.ctx.beginPath();
                this.ctx.arc(x, y, size * 0.5, 0, 2 * Math.PI);
                this.ctx.fill();
                
                // 左侧
                this.ctx.beginPath();
                this.ctx.arc(x - size * 0.3, y, size * 0.4, 0, 2 * Math.PI);
                this.ctx.fill();
                
                // 右侧
                this.ctx.beginPath();
                this.ctx.arc(x + size * 0.3, y, size * 0.4, 0, 2 * Math.PI);
                this.ctx.fill();
                
                // 顶部
                this.ctx.beginPath();
                this.ctx.arc(x, y - size * 0.2, size * 0.3, 0, 2 * Math.PI);
                this.ctx.fill();
            }

            startWeatherAnimation() {
                const animate = () => {
                    // 简单的动画效果，可以添加云朵移动等
                    this.animationId = requestAnimationFrame(animate);
                };
                animate();
            }

            updateWeatherData() {
                // 模拟天气数据更新
                this.weatherData.temperature = Math.round(15 + Math.random() * 20);
                this.weatherData.humidity = Math.round(40 + Math.random() * 40);
                this.weatherData.windSpeed = Math.round(5 + Math.random() * 20);
                this.weatherData.pressure = Math.round(990 + Math.random() * 40);

                // 更新显示
                document.getElementById('temperature').textContent = `${this.weatherData.temperature}°C`;
                document.getElementById('humidity').textContent = `${this.weatherData.humidity}%`;
                document.getElementById('wind-speed').textContent = `${this.weatherData.windSpeed} km/h`;
                document.getElementById('pressure').textContent = `${this.weatherData.pressure} hPa`;

                this.drawWeatherMap();
            }

            resetWeatherData() {
                this.weatherData = this.initializeWeatherData();
                document.getElementById('temperature').textContent = `${this.weatherData.temperature}°C`;
                document.getElementById('humidity').textContent = `${this.weatherData.humidity}%`;
                document.getElementById('wind-speed').textContent = `${this.weatherData.windSpeed} km/h`;
                document.getElementById('pressure').textContent = `${this.weatherData.pressure} hPa`;
                this.drawWeatherMap();
            }

            selectClimateZone(zone) {
                // 移除所有选中状态
                document.querySelectorAll('.zone-card').forEach(card => {
                    card.style.borderColor = '#e9ecef';
                });

                // 添加选中状态
                const selectedCard = document.querySelector(`[data-zone="${zone}"]`);
                selectedCard.style.borderColor = '#28a745';
                selectedCard.style.borderWidth = '2px';

                // 显示气候带信息
                const zoneInfo = {
                    'tropical': { temp: '25-30°C', rainfall: '2000-3000mm', desc: '热带雨林和热带草原气候' },
                    'subtropical': { temp: '15-25°C', rainfall: '1000-1500mm', desc: '亚热带季风和地中海气候' },
                    'temperate': { temp: '5-20°C', rainfall: '500-1000mm', desc: '温带大陆性和海洋性气候' },
                    'continental': { temp: '-10-25°C', rainfall: '200-500mm', desc: '大陆性气候，温差大' },
                    'polar': { temp: '-30-0°C', rainfall: '100-200mm', desc: '极地气候，全年严寒' },
                    'desert': { temp: '10-40°C', rainfall: '0-200mm', desc: '干旱和半干旱气候' }
                };

                const info = zoneInfo[zone];
                alert(`${selectedCard.querySelector('h4').textContent}\n\n年均温度: ${info.temp}\n年降水量: ${info.rainfall}\n特征: ${info.desc}`);
            }

            showWeatherPattern(pattern) {
                const animation = document.getElementById('pattern-animation');
                const description = document.getElementById('pattern-description');
                
                // 清除现有动画
                animation.innerHTML = '<div class="cloud cloud1"></div>';
                
                const patterns = {
                    'rain': {
                        animation: () => {
                            // 添加雨滴
                            for (let i = 0; i < 20; i++) {
                                const rain = document.createElement('div');
                                rain.className = 'rain';
                                rain.style.left = Math.random() * 100 + '%';
                                rain.style.animationDelay = Math.random() * 2 + 's';
                                animation.appendChild(rain);
                            }
                        },
                        description: {
                            title: '降雨现象',
                            text: '当空气中的水蒸气达到饱和状态时，水滴在云中凝结并增大，当重力超过上升气流时就会降落形成雨。'
                        }
                    },
                    'snow': {
                        animation: () => {
                            for (let i = 0; i < 15; i++) {
                                const snow = document.createElement('div');
                                snow.style.position = 'absolute';
                                snow.style.width = '6px';
                                snow.style.height = '6px';
                                snow.style.background = 'white';
                                snow.style.borderRadius = '50%';
                                snow.style.left = Math.random() * 100 + '%';
                                snow.style.animation = 'fall 3s linear infinite';
                                snow.style.animationDelay = Math.random() * 3 + 's';
                                animation.appendChild(snow);
                            }
                        },
                        description: {
                            title: '降雪现象',
                            text: '当气温低于0°C时，水蒸气直接凝华成冰晶，冰晶在云中聚集增大形成雪花降落。'
                        }
                    },
                    'storm': {
                        animation: () => {
                            animation.style.background = 'linear-gradient(135deg, #2c3e50 0%, #34495e 100%)';
                            // 添加闪电效果
                            const lightning = document.createElement('div');
                            lightning.style.position = 'absolute';
                            lightning.style.width = '2px';
                            lightning.style.height = '100px';
                            lightning.style.background = '#FFD700';
                            lightning.style.left = '50%';
                            lightning.style.top = '0';
                            lightning.style.animation = 'flash 2s infinite';
                            animation.appendChild(lightning);
                        },
                        description: {
                            title: '雷暴现象',
                            text: '强烈的对流运动产生积雨云，云中正负电荷分离形成强电场，当电压足够高时产生闪电和雷声。'
                        }
                    },
                    'wind': {
                        animation: () => {
                            // 添加风的视觉效果
                            for (let i = 0; i < 10; i++) {
                                const windLine = document.createElement('div');
                                windLine.style.position = 'absolute';
                                windLine.style.width = '30px';
                                windLine.style.height = '2px';
                                windLine.style.background = 'rgba(255,255,255,0.7)';
                                windLine.style.top = Math.random() * 100 + '%';
                                windLine.style.left = '-30px';
                                windLine.style.animation = 'drift 2s linear infinite';
                                windLine.style.animationDelay = Math.random() * 2 + 's';
                                animation.appendChild(windLine);
                            }
                        },
                        description: {
                            title: '大风现象',
                            text: '由于气压差异产生的空气流动。高压区的空气向低压区流动，形成风。风速受气压梯度、地形等因素影响。'
                        }
                    }
                };

                if (patterns[pattern]) {
                    patterns[pattern].animation();
                    description.innerHTML = `
                        <h4>${patterns[pattern].description.title}</h4>
                        <p>${patterns[pattern].description.text}</p>
                    `;
                }
            }

            clearWeatherPattern() {
                const animation = document.getElementById('pattern-animation');
                const description = document.getElementById('pattern-description');
                
                animation.innerHTML = '<div class="cloud cloud1"></div>';
                animation.style.background = 'linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)';
                
                description.innerHTML = `
                    <h4>天气现象说明</h4>
                    <p>选择上方按钮查看不同天气现象的形成过程和特征。</p>
                `;
            }

            generateForecast() {
                const days = ['今天', '明天', '后天', '周四', '周五', '周六', '周日'];
                const conditions = [
                    { icon: 'fas fa-sun', desc: '晴朗' },
                    { icon: 'fas fa-cloud-sun', desc: '多云' },
                    { icon: 'fas fa-cloud', desc: '阴天' },
                    { icon: 'fas fa-cloud-rain', desc: '小雨' },
                    { icon: 'fas fa-cloud-rain', desc: '中雨' }
                ];

                const grid = document.getElementById('forecast-grid');
                grid.innerHTML = '';

                days.forEach(day => {
                    const condition = conditions[Math.floor(Math.random() * conditions.length)];
                    const temp = Math.round(15 + Math.random() * 15);
                    
                    const card = document.createElement('div');
                    card.className = 'forecast-card';
                    card.innerHTML = `
                        <div class="forecast-day">${day}</div>
                        <div class="forecast-icon"><i class="${condition.icon}"></i></div>
                        <div class="forecast-temp">${temp}°C</div>
                        <div class="forecast-desc">${condition.desc}</div>
                    `;
                    grid.appendChild(card);
                });
            }

            exportForecast() {
                const cards = document.querySelectorAll('.forecast-card');
                const forecastData = [];
                
                cards.forEach(card => {
                    forecastData.push({
                        day: card.querySelector('.forecast-day').textContent,
                        temperature: card.querySelector('.forecast-temp').textContent,
                        condition: card.querySelector('.forecast-desc').textContent
                    });
                });

                const dataStr = JSON.stringify(forecastData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'weather_forecast.json';
                link.click();
            }
        }

        // 添加闪电动画
        const style = document.createElement('style');
        style.textContent = `
            @keyframes flash {
                0%, 90%, 100% { opacity: 0; }
                5%, 85% { opacity: 1; }
            }
        `;
        document.head.appendChild(style);

        // 初始化气候天气系统
        let climateWeather;
        document.addEventListener('DOMContentLoaded', () => {
            climateWeather = new ClimateWeather();
        });
    </script>
</body>
</html> 