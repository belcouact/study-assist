<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>History Learning - Study Assist</title>
    <link rel="stylesheet" href="../../css/style.css">
    <link rel="stylesheet" href="../../css/components.css">
    <link rel="stylesheet" href="../../css/responsive.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</head>
<body>
    <header class="main-header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="../../index.html">
                        <img src="../../assets/icons/logo.svg" alt="Study Assist Logo">
                        <span>Study Assist</span>
                    </a>
                </div>
                <nav class="main-nav">
                    <ul>
                        <li><a href="../../index.html">Home</a></li>
                        <li><a href="../../index.html#subjects">Subjects</a></li>
                        <li><a href="../../index.html#features">Features</a></li>
                        <li><a href="../../index.html#about">About</a></li>
                    </ul>
                </nav>
                <div class="profile-section">
                    <button id="profile-button" class="profile-button">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                        学习阶段
                    </button>
                    <div id="profile-display" class="profile-display"></div>
                </div>
                <button class="mobile-menu-toggle" aria-label="Toggle Menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </header>

    <main>
        <!-- Hero Section -->
        <section class="subject-hero">
            <div class="container">
                <div class="subject-hero-content">
                    <h1>Learn History with AI Assistance</h1>
                    <p class="subject-description">Explore historical events, civilizations, and figures with personalized AI guidance. Our platform helps you analyze historical contexts, understand cause and effect relationships, and connect events across time periods.</p>
                    <a href="#ai-assistant" class="btn btn-primary">Start Learning</a>
                </div>
                <div class="subject-hero-image">
                    <img src="../../assets/images/history-image.svg" alt="History Learning">
                </div>
            </div>
        </section>

        <!-- Topics Section -->
        <section class="topics-section">
            <div class="container">
                <div class="section-header">
                    <h2>Historical Topics</h2>
                    <p>Dive into key historical periods and themes with our comprehensive learning resources</p>
                </div>
                <div class="topics-grid">
                    <div class="topic-card">
                        <div class="topic-icon">
                            <i class="fas fa-landmark"></i>
                        </div>
                        <h3>Ancient Civilizations</h3>
                        <p>Explore the earliest human societies, from Mesopotamia and Egypt to Greece and Rome.</p>
                    </div>
                    <div class="topic-card">
                        <div class="topic-icon">
                            <i class="fas fa-crown"></i>
                        </div>
                        <h3>Medieval Period</h3>
                        <p>Study the Middle Ages, feudalism, the rise of kingdoms, and the development of early modern societies.</p>
                    </div>
                    <div class="topic-card">
                        <div class="topic-icon">
                            <i class="fas fa-ship"></i>
                        </div>
                        <h3>Age of Exploration</h3>
                        <p>Discover the voyages that connected continents and the global exchanges that followed.</p>
                    </div>
                    <div class="topic-card">
                        <div class="topic-icon">
                            <i class="fas fa-book"></i>
                        </div>
                        <h3>Revolutionary Era</h3>
                        <p>Analyze the political, industrial, and social revolutions that shaped the modern world.</p>
                    </div>
                    <div class="topic-card">
                        <div class="topic-icon">
                            <i class="fas fa-globe-americas"></i>
                        </div>
                        <h3>World Wars</h3>
                        <p>Understand the causes, events, and impacts of the major global conflicts of the 20th century.</p>
                    </div>
                    <div class="topic-card">
                        <div class="topic-icon">
                            <i class="fas fa-satellite"></i>
                        </div>
                        <h3>Modern History</h3>
                        <p>Examine post-war developments, the Cold War, decolonization, and contemporary global issues.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- AI Assistant Section -->
        <section id="ai-assistant" class="ai-assistant-section">
            <div class="container">
                <div class="section-header">
                    <h2>AI History Assistant</h2>
                    <p>Ask questions about any historical period, event, or figure and receive detailed explanations with contextual information.</p>
                </div>
                
                <div class="assistant-features">
                    <div class="feature-item">
                        <div class="feature-icon">
                            <img src="../../assets/icons/qa-icon.svg" alt="Question Icon">
                        </div>
                        <div class="feature-content">
                            <h4>Historical Inquiry</h4>
                            <p>Ask specific questions about historical events, figures, or periods and receive detailed answers.</p>
                        </div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">
                            <img src="../../assets/icons/history-icon.svg" alt="Timeline Icon">
                        </div>
                        <div class="feature-content">
                            <h4>Timeline Analysis</h4>
                            <p>Understand cause and effect relationships and how events connect across different time periods.</p>
                        </div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">
                            <img src="../../assets/icons/more-icon.svg" alt="Primary Source Icon">
                        </div>
                        <div class="feature-content">
                            <h4>Source Analysis</h4>
                            <p>Learn how to analyze and interpret primary and secondary historical sources.</p>
                        </div>
                    </div>
                </div>

                <div class="chat-container">
                    <div class="chat-header">
                        <img src="../../assets/icons/history-icon.svg" alt="History AI">
                        <h3>History AI Assistant</h3>
                    </div>
                    <div class="chat-messages" id="historyChat">
                        <div class="message message-ai">
                            <p>Welcome to the History AI Assistant. What would you like to learn about today?</p>
                        </div>
                    </div>
                    <div class="chat-input">
                        <input type="text" id="historyChatInput" placeholder="Ask about any historical event, figure, or period...">
                        <button id="sendHistoryQuestion" class="btn btn-primary"><i class="fas fa-paper-plane"></i></button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Quiz Section -->
        <section class="quiz-section">
            <div class="container">
                <div class="section-header">
                    <h2>Test Your Knowledge</h2>
                    <p>Generate personalized history quizzes based on specific time periods, events, or themes.</p>
                </div>
                
                <div class="quiz-generator">
                    <div class="quiz-controls">
                        <div class="form-group">
                            <label for="historyTopic">Historical Period or Theme:</label>
                            <select id="historyTopic" class="form-control">
                                <option value="ancient">Ancient Civilizations</option>
                                <option value="medieval">Medieval Period</option>
                                <option value="renaissance">Renaissance & Reformation</option>
                                <option value="revolution">Age of Revolutions</option>
                                <option value="modern">Modern Era (1900-Present)</option>
                                <option value="comprehensive">Comprehensive History</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="quizDifficulty">Difficulty Level:</label>
                            <select id="quizDifficulty" class="form-control">
                                <option value="easy">Basic (Key Facts)</option>
                                <option value="medium">Intermediate (Connections)</option>
                                <option value="hard">Advanced (Analysis)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="questionCount">Number of Questions:</label>
                            <select id="questionCount" class="form-control">
                                <option value="5">5 Questions</option>
                                <option value="10" selected>10 Questions</option>
                                <option value="15">15 Questions</option>
                                <option value="20">20 Questions</option>
                            </select>
                        </div>
                    </div>
                    <button id="generateHistoryQuiz" class="btn btn-primary">Generate Quiz</button>
                </div>
                
                <div class="quiz-questions" id="historyQuizContainer">
                    <!-- Quiz will be generated here -->
                    <div class="placeholder-content">
                        <p>Your personalized history quiz will appear here after generation.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Timeline Section -->
        <section class="timeline-section">
            <div class="container">
                <div class="section-header">
                    <h2>Interactive Timeline Explorer</h2>
                    <p>Visualize historical events and understand how they connect across time periods.</p>
                </div>
                
                <div class="timeline-filters">
                    <div class="form-group">
                        <label for="timelinePeriod">Time Period:</label>
                        <select id="timelinePeriod" class="form-control">
                            <option value="ancient">Ancient History (3000 BCE - 500 CE)</option>
                            <option value="medieval">Medieval Period (500 - 1500)</option>
                            <option value="early-modern">Early Modern Period (1500 - 1800)</option>
                            <option value="modern">Modern Era (1800 - Present)</option>
                            <option value="custom">Custom Range</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="timelineRegion">Region:</label>
                        <select id="timelineRegion" class="form-control">
                            <option value="global">Global</option>
                            <option value="europe">Europe</option>
                            <option value="asia">Asia</option>
                            <option value="africa">Africa</option>
                            <option value="americas">The Americas</option>
                            <option value="oceania">Oceania</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="timelineFocus">Focus:</label>
                        <select id="timelineFocus" class="form-control">
                            <option value="general">General History</option>
                            <option value="political">Political History</option>
                            <option value="cultural">Cultural History</option>
                            <option value="scientific">Scientific Advances</option>
                            <option value="economic">Economic Developments</option>
                        </select>
                    </div>
                </div>
                
                <div class="timeline-display" id="timelineVisualization">
                    <!-- Timeline visualization will be loaded here -->
                    <div class="placeholder-content">
                        <img src="../../assets/images/timeline-placeholder.svg" alt="Timeline Visualization">
                        <p>Select parameters above to generate an interactive historical timeline.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Historical Sources Section -->
        <section class="sources-section">
            <div class="container">
                <div class="section-header">
                    <h2>Primary Source Analysis</h2>
                    <p>Learn how to analyze and interpret historical documents, artifacts, and other primary sources.</p>
                </div>
                
                <div class="sources-grid">
                    <div class="source-card">
                        <h3>Written Documents</h3>
                        <p>Letters, diaries, speeches, laws, treaties, newspaper articles, and other contemporary accounts.</p>
                        <a href="#" class="btn btn-secondary">Explore Techniques</a>
                    </div>
                    <div class="source-card">
                        <h3>Visual Sources</h3>
                        <p>Paintings, photographs, political cartoons, posters, maps, and architectural drawings.</p>
                        <a href="#" class="btn btn-secondary">Explore Techniques</a>
                    </div>
                    <div class="source-card">
                        <h3>Statistical Data</h3>
                        <p>Census records, economic figures, demographic information, and other quantitative sources.</p>
                        <a href="#" class="btn btn-secondary">Explore Techniques</a>
                    </div>
                    <div class="source-card">
                        <h3>Material Culture</h3>
                        <p>Artifacts, buildings, clothing, tools, and other physical remains from the past.</p>
                        <a href="#" class="btn btn-secondary">Explore Techniques</a>
                    </div>
                </div>
                
                <div class="source-analysis-demo">
                    <h3>Try Source Analysis with AI Assistance</h3>
                    <div class="source-analysis-container">
                        <div class="source-display">
                            <div class="source-placeholder">
                                <p>Select a source type and period to view an example for analysis.</p>
                            </div>
                        </div>
                        <div class="source-controls">
                            <div class="form-group">
                                <label for="sourceType">Source Type:</label>
                                <select id="sourceType" class="form-control">
                                    <option value="document">Written Document</option>
                                    <option value="image">Visual Source</option>
                                    <option value="data">Statistical Data</option>
                                    <option value="artifact">Material Culture</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="sourcePeriod">Historical Period:</label>
                                <select id="sourcePeriod" class="form-control">
                                    <option value="ancient">Ancient History</option>
                                    <option value="medieval">Medieval Period</option>
                                    <option value="early-modern">Early Modern Period</option>
                                    <option value="modern">Modern Era</option>
                                </select>
                            </div>
                            <button id="loadSourceExample" class="btn btn-primary">Load Example</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-bottom">
            <div class="container">
                <p>&copy; 2023 Study Assist. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="../../js/navigation.js"></script>
    <script src="../../js/common.js"></script>
    <script src="../../js/api.js"></script>
    <script src="../../js/profile.js"></script>
    <script>
        // Initialize the history page functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize the API
            initAPI();
            
            // Setup the chat functionality
            document.getElementById('sendHistoryQuestion').addEventListener('click', function() {
                const input = document.getElementById('historyChatInput');
                const question = input.value.trim();
                
                if (question) {
                    // Add user message to chat
                    const chatContainer = document.getElementById('historyChat');
                    const userMessage = document.createElement('div');
                    userMessage.className = 'message message-user';
                    userMessage.innerHTML = `<p>${question}</p>`;
                    chatContainer.appendChild(userMessage);
                    
                    // Clear input
                    input.value = '';
                    
                    // Show loading message
                    const loadingMessage = document.createElement('div');
                    loadingMessage.className = 'message message-loading';
                    loadingMessage.innerHTML = '<p>Thinking</p>';
                    chatContainer.appendChild(loadingMessage);
                    
                    // Scroll to bottom of chat
                    chatContainer.scrollTop = chatContainer.scrollHeight;
                    
                    // Simulate AI response (using the API)
                    askQuestion(question, 'history')
                        .then(response => {
                            // Remove loading message
                            chatContainer.removeChild(loadingMessage);
                            
                            // Add AI response to chat
                            const aiMessage = document.createElement('div');
                            aiMessage.className = 'message message-ai';
                            aiMessage.innerHTML = `<p>${response}</p>`;
                            chatContainer.appendChild(aiMessage);
                            
                            // Scroll to bottom of chat
                            chatContainer.scrollTop = chatContainer.scrollHeight;
                        })
                        .catch(error => {
                            console.error('Error getting response:', error);
                            // Remove loading message
                            chatContainer.removeChild(loadingMessage);
                            
                            // Add error message to chat
                            const errorMessage = document.createElement('div');
                            errorMessage.className = 'message message-error';
                            errorMessage.innerHTML = `<p>Sorry, I couldn't process your question. Please try again.</p>`;
                            chatContainer.appendChild(errorMessage);
                            
                            // Scroll to bottom of chat
                            chatContainer.scrollTop = chatContainer.scrollHeight;
                        });
                }
            });
            
            // Allow pressing Enter to send message
            document.getElementById('historyChatInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    document.getElementById('sendHistoryQuestion').click();
                }
            });
            
            // Quiz generation functionality
            document.getElementById('generateHistoryQuiz').addEventListener('click', function() {
                const topic = document.getElementById('historyTopic').value;
                const difficulty = document.getElementById('quizDifficulty').value;
                const count = document.getElementById('questionCount').value;
                
                // Show loading state
                const quizContainer = document.getElementById('historyQuizContainer');
                quizContainer.innerHTML = '<p class="loading">Generating your quiz...</p>';
                
                // Use the API to generate a quiz
                generateQuiz(topic, difficulty, parseInt(count), 'history')
                    .then(quiz => {
                        // Display the quiz
                        displayHistoryQuiz(quiz, quizContainer);
                    })
                    .catch(error => {
                        console.error('Error generating quiz:', error);
                        quizContainer.innerHTML = '<p class="error">Sorry, there was an error generating your quiz. Please try again.</p>';
                    });
            });
            
            // Timeline visualization functionality
            document.getElementById('timelinePeriod').addEventListener('change', updateTimelinePreview);
            document.getElementById('timelineRegion').addEventListener('change', updateTimelinePreview);
            document.getElementById('timelineFocus').addEventListener('change', updateTimelinePreview);
            
            // Source analysis functionality
            document.getElementById('loadSourceExample').addEventListener('click', function() {
                const sourceType = document.getElementById('sourceType').value;
                const period = document.getElementById('sourcePeriod').value;
                
                // Show loading state
                const sourceDisplay = document.querySelector('.source-display');
                sourceDisplay.innerHTML = '<p class="loading">Loading source example...</p>';
                
                // Simulate loading a source example
                setTimeout(() => {
                    // This would be replaced with actual API call in production
                    sourceDisplay.innerHTML = `
                        <div class="source-example">
                            <h4>Example ${sourceType.charAt(0).toUpperCase() + sourceType.slice(1)} from ${period.charAt(0).toUpperCase() + period.slice(1)} Period</h4>
                            <div class="source-image-placeholder"></div>
                            <p class="source-description">This is a placeholder for a historical source. In the full implementation, this would display an actual historical source with contextual information.</p>
                            <div class="source-analysis">
                                <h5>Analysis Questions:</h5>
                                <ul>
                                    <li>Who created this source and when?</li>
                                    <li>What was the purpose of this source?</li>
                                    <li>Who was the intended audience?</li>
                                    <li>What historical context is important to understand?</li>
                                    <li>How reliable is this source for historical research?</li>
                                </ul>
                            </div>
                        </div>
                    `;
                }, 1000);
            });
        });
        
        // Function to display a generated history quiz
        function displayHistoryQuiz(quiz, container) {
            let html = '<div class="quiz">';
            html += `<h3>${quiz.title}</h3>`;
            
            quiz.questions.forEach((question, index) => {
                html += `
                    <div class="question-item">
                        <h4>${index + 1}. ${question.question}</h4>
                        <div class="options-list">
                `;
                
                question.options.forEach((option, optIndex) => {
                    html += `
                        <div class="option-item" data-question="${index}" data-option="${optIndex}">
                            <input type="radio" id="q${index}_a${optIndex}" name="q${index}" value="${optIndex}">
                            <label for="q${index}_a${optIndex}">${option}</label>
                        </div>
                    `;
                });
                
                html += `
                        </div>
                    </div>
                `;
            });
            
            html += `
                <div class="quiz-actions">
                    <button id="submitQuiz" class="btn btn-primary">Submit Answers</button>
                </div>
            </div>`;
            
            container.innerHTML = html;
            
            // Add event listener to option items
            document.querySelectorAll('.option-item').forEach(item => {
                item.addEventListener('click', function() {
                    const questionIndex = this.getAttribute('data-question');
                    const optionIndex = this.getAttribute('data-option');
                    document.getElementById(`q${questionIndex}_a${optionIndex}`).checked = true;
                    
                    // Remove selected class from all options for this question
                    document.querySelectorAll(`.option-item[data-question="${questionIndex}"]`)
                        .forEach(opt => opt.classList.remove('selected'));
                    
                    // Add selected class to this option
                    this.classList.add('selected');
                });
            });
            
            // Add event listener to submit button
            document.getElementById('submitQuiz').addEventListener('click', function() {
                checkQuizAnswers(quiz);
            });
        }
        
        // Function to check quiz answers
        function checkQuizAnswers(quiz) {
            let score = 0;
            let total = quiz.questions.length;
            
            quiz.questions.forEach((question, index) => {
                const selectedOption = document.querySelector(`input[name="q${index}"]:checked`);
                
                if (selectedOption) {
                    const answerIndex = parseInt(selectedOption.value);
                    const correctIndex = question.correctAnswer;
                    
                    const optionElement = selectedOption.closest('.option-item');
                    
                    if (answerIndex === correctIndex) {
                        score++;
                        optionElement.classList.add('correct');
                    } else {
                        optionElement.classList.add('incorrect');
                        // Highlight correct answer
                        const correctElement = document.querySelector(`#q${index}_a${correctIndex}`).closest('.option-item');
                        correctElement.classList.add('correct');
                    }
                }
            });
            
            // Display score
            const quizContainer = document.getElementById('historyQuizContainer');
            const resultDiv = document.createElement('div');
            resultDiv.className = 'quiz-result';
            resultDiv.innerHTML = `
                <h3>Your Score: ${score}/${total}</h3>
                <p>${getScoreMessage(score, total)}</p>
                <button id="newQuiz" class="btn btn-secondary">Generate New Quiz</button>
            `;
            
            quizContainer.appendChild(resultDiv);
            
            // Scroll to results
            resultDiv.scrollIntoView({ behavior: 'smooth' });
            
            // Disable all inputs
            document.querySelectorAll('#historyQuizContainer input').forEach(input => {
                input.disabled = true;
            });
            
            // Hide submit button
            document.getElementById('submitQuiz').style.display = 'none';
            
            // Add event listener to new quiz button
            document.getElementById('newQuiz').addEventListener('click', function() {
                document.getElementById('generateHistoryQuiz').click();
            });
        }
        
        // Function to get message based on score
        function getScoreMessage(score, total) {
            const percentage = (score / total) * 100;
            
            if (percentage >= 90) {
                return "Excellent! You have a strong understanding of this historical topic.";
            } else if (percentage >= 70) {
                return "Good job! You have a solid grasp of the material, but there's still room to learn more.";
            } else if (percentage >= 50) {
                return "Not bad. You have a basic understanding, but should review this topic more thoroughly.";
            } else {
                return "You might need more study time with this topic. Consider reviewing the material and trying again.";
            }
        }
        
        // Function to update timeline preview
        function updateTimelinePreview() {
            const period = document.getElementById('timelinePeriod').value;
            const region = document.getElementById('timelineRegion').value;
            const focus = document.getElementById('timelineFocus').value;
            
            // In a real implementation, this would call an API to generate the timeline
            // For now, we'll just update the placeholder text
            const timelineContainer = document.getElementById('timelineVisualization');
            timelineContainer.innerHTML = `
                <div class="placeholder-content">
                    <img src="../../assets/images/timeline-placeholder.svg" alt="Timeline Visualization">
                    <p>Timeline for ${period} in ${region} focusing on ${focus} events would appear here.</p>
                </div>
            `;
        }
    </script>
</body>
</html> 