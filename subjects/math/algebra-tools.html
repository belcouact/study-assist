<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»£æ•°å·¥å…· - æ•°å­¦å­¦ä¹ åŠ©æ‰‹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .algebra-workspace {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .tool-tabs {
            background: #f8f9fa;
            padding: 0;
            border-bottom: 2px solid #e9ecef;
            display: flex;
            overflow-x: auto;
        }

        .tab-btn {
            padding: 15px 25px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            color: #495057;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab-btn:hover {
            background: #e9ecef;
            color: #007bff;
        }

        .tab-btn.active {
            color: #007bff;
            border-bottom-color: #007bff;
            background: white;
        }

        .tool-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .tool-section {
            display: none;
        }

        .tool-section.active {
            display: block;
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }

        .input-field {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .input-field:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #007bff;
            color: white;
        }

        .btn-primary:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #545b62;
        }

        .result-area {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            min-height: 100px;
        }

        .result-area h4 {
            color: #007bff;
            margin-bottom: 15px;
        }

        .step-by-step {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border-left: 4px solid #28a745;
        }

        .step {
            margin-bottom: 10px;
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .step:last-child {
            border-bottom: none;
        }

        .step-number {
            display: inline-block;
            background: #007bff;
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            text-align: center;
            line-height: 25px;
            font-size: 12px;
            font-weight: bold;
            margin-right: 10px;
        }

        .examples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .example-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            border-left: 4px solid #17a2b8;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .example-card:hover {
            background: #e9ecef;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .example-card h5 {
            color: #17a2b8;
            margin-bottom: 8px;
        }

        .example-card .equation {
            font-family: 'Courier New', monospace;
            background: white;
            padding: 8px;
            border-radius: 4px;
            margin: 8px 0;
        }

        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.9);
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .back-btn:hover {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 10px 15px;
            border-radius: 8px;
            margin-top: 10px;
            border: 1px solid #f5c6cb;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 10px 15px;
            border-radius: 8px;
            margin-top: 10px;
            border: 1px solid #c3e6cb;
        }

        .formula-display {
            font-family: 'Times New Roman', serif;
            font-size: 18px;
            text-align: center;
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border: 2px solid #e9ecef;
        }

        .graph-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            border: 2px solid #e9ecef;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .tool-tabs {
                flex-direction: column;
            }

            .tab-btn {
                text-align: center;
                border-bottom: 1px solid #e9ecef;
                border-right: none;
            }

            .tab-btn.active {
                border-bottom: 1px solid #007bff;
                border-right: none;
            }

            .tool-content {
                padding: 20px;
            }

            .examples-grid {
                grid-template-columns: 1fr;
            }
        }

        .variable-input {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
        }

        .variable-input input {
            flex: 1;
            padding: 8px 12px;
            border: 2px solid #dee2e6;
            border-radius: 6px;
        }

        .variable-input button {
            padding: 8px 12px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }

        .add-variable-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <button class="back-btn" onclick="window.location.href='main.html'">â† è¿”å›æ•°å­¦ä¸»é¡µ</button>
    
    <div class="container">
        <div class="header">
            <h1>ğŸ§® ä»£æ•°å·¥å…·</h1>
            <p>å¼ºå¤§çš„ä»£æ•°è®¡ç®—å’Œæ±‚è§£å·¥å…· - è®©æ•°å­¦å˜å¾—ç®€å•</p>
        </div>

        <div class="algebra-workspace">
            <div class="tool-tabs">
                <button class="tab-btn active" data-tab="equation-solver">
                    <span>ğŸ“</span> æ–¹ç¨‹æ±‚è§£
                </button>
                <button class="tab-btn" data-tab="factorization">
                    <span>ğŸ”¢</span> å› å¼åˆ†è§£
                </button>
                <button class="tab-btn" data-tab="polynomial">
                    <span>ğŸ“Š</span> å¤šé¡¹å¼è¿ç®—
                </button>
                <button class="tab-btn" data-tab="system-equations">
                    <span>âš–ï¸</span> æ–¹ç¨‹ç»„
                </button>
                <button class="tab-btn" data-tab="simplification">
                    <span>âœ¨</span> è¡¨è¾¾å¼åŒ–ç®€
                </button>
                <button class="tab-btn" data-tab="calculator">
                    <span>ğŸ§®</span> ç§‘å­¦è®¡ç®—å™¨
                </button>
            </div>

            <div class="tool-content">
                <!-- æ–¹ç¨‹æ±‚è§£ -->
                <div class="tool-section active" id="equation-solver">
                    <h3>æ–¹ç¨‹æ±‚è§£å™¨</h3>
                    <p>è¾“å…¥ä¸€å…ƒæˆ–å¤šå…ƒæ–¹ç¨‹ï¼Œè‡ªåŠ¨æ±‚è§£å¹¶æ˜¾ç¤ºè¯¦ç»†æ­¥éª¤</p>
                    
                    <div class="input-group">
                        <label for="equation-input">è¾“å…¥æ–¹ç¨‹ (ä¾‹å¦‚: x^2 + 5x + 6 = 0)</label>
                        <input type="text" id="equation-input" class="input-field" placeholder="x^2 + 5x + 6 = 0">
                    </div>
                    
                    <button class="btn btn-primary" onclick="solveEquation()">
                        <span>ğŸ”</span> æ±‚è§£æ–¹ç¨‹
                    </button>
                    <button class="btn btn-secondary" onclick="clearEquationResult()">
                        <span>ğŸ—‘ï¸</span> æ¸…ç©º
                    </button>
                    
                    <div class="result-area" id="equation-result">
                        <h4>è§£ç­”ç»“æœ</h4>
                        <p>è¯·è¾“å…¥æ–¹ç¨‹å¹¶ç‚¹å‡»æ±‚è§£æŒ‰é’®</p>
                    </div>

                    <div class="examples-grid">
                        <div class="example-card" onclick="loadExample('x^2 + 5x + 6 = 0')">
                            <h5>äºŒæ¬¡æ–¹ç¨‹</h5>
                            <div class="equation">xÂ² + 5x + 6 = 0</div>
                            <p>æ ‡å‡†äºŒæ¬¡æ–¹ç¨‹æ±‚è§£</p>
                        </div>
                        <div class="example-card" onclick="loadExample('2x + 3 = 7')">
                            <h5>ä¸€æ¬¡æ–¹ç¨‹</h5>
                            <div class="equation">2x + 3 = 7</div>
                            <p>ç®€å•çº¿æ€§æ–¹ç¨‹</p>
                        </div>
                        <div class="example-card" onclick="loadExample('x^3 - 6x^2 + 11x - 6 = 0')">
                            <h5>ä¸‰æ¬¡æ–¹ç¨‹</h5>
                            <div class="equation">xÂ³ - 6xÂ² + 11x - 6 = 0</div>
                            <p>é«˜æ¬¡æ–¹ç¨‹æ±‚è§£</p>
                        </div>
                        <div class="example-card" onclick="loadExample('sqrt(x + 1) = 3')">
                            <h5>æ ¹å¼æ–¹ç¨‹</h5>
                            <div class="equation">âˆš(x + 1) = 3</div>
                            <p>åŒ…å«æ ¹å·çš„æ–¹ç¨‹</p>
                        </div>
                    </div>
                </div>

                <!-- å› å¼åˆ†è§£ -->
                <div class="tool-section" id="factorization">
                    <h3>å› å¼åˆ†è§£å·¥å…·</h3>
                    <p>å°†å¤šé¡¹å¼åˆ†è§£ä¸ºå› å­çš„ä¹˜ç§¯å½¢å¼</p>
                    
                    <div class="input-group">
                        <label for="factor-input">è¾“å…¥å¤šé¡¹å¼ (ä¾‹å¦‚: x^2 + 5x + 6)</label>
                        <input type="text" id="factor-input" class="input-field" placeholder="x^2 + 5x + 6">
                    </div>
                    
                    <button class="btn btn-primary" onclick="factorExpression()">
                        <span>ğŸ”§</span> å› å¼åˆ†è§£
                    </button>
                    <button class="btn btn-secondary" onclick="clearFactorResult()">
                        <span>ğŸ—‘ï¸</span> æ¸…ç©º
                    </button>
                    
                    <div class="result-area" id="factor-result">
                        <h4>åˆ†è§£ç»“æœ</h4>
                        <p>è¯·è¾“å…¥å¤šé¡¹å¼å¹¶ç‚¹å‡»åˆ†è§£æŒ‰é’®</p>
                    </div>

                    <div class="examples-grid">
                        <div class="example-card" onclick="loadFactorExample('x^2 + 5x + 6')">
                            <h5>äºŒæ¬¡ä¸‰é¡¹å¼</h5>
                            <div class="equation">xÂ² + 5x + 6</div>
                            <p>= (x + 2)(x + 3)</p>
                        </div>
                        <div class="example-card" onclick="loadFactorExample('x^2 - 9')">
                            <h5>å¹³æ–¹å·®</h5>
                            <div class="equation">xÂ² - 9</div>
                            <p>= (x + 3)(x - 3)</p>
                        </div>
                        <div class="example-card" onclick="loadFactorExample('x^3 + 8')">
                            <h5>ç«‹æ–¹å’Œ</h5>
                            <div class="equation">xÂ³ + 8</div>
                            <p>= (x + 2)(xÂ² - 2x + 4)</p>
                        </div>
                        <div class="example-card" onclick="loadFactorExample('2x^2 + 8x + 6')">
                            <h5>æå–å…¬å› å­</h5>
                            <div class="equation">2xÂ² + 8x + 6</div>
                            <p>= 2(x + 1)(x + 3)</p>
                        </div>
                    </div>
                </div>

                <!-- å¤šé¡¹å¼è¿ç®— -->
                <div class="tool-section" id="polynomial">
                    <h3>å¤šé¡¹å¼è¿ç®—</h3>
                    <p>å¤šé¡¹å¼çš„åŠ æ³•ã€å‡æ³•ã€ä¹˜æ³•å’Œé™¤æ³•è¿ç®—</p>
                    
                    <div class="input-group">
                        <label for="poly1-input">ç¬¬ä¸€ä¸ªå¤šé¡¹å¼</label>
                        <input type="text" id="poly1-input" class="input-field" placeholder="x^2 + 3x + 2">
                    </div>
                    
                    <div class="input-group">
                        <label for="operation-select">è¿ç®—ç±»å‹</label>
                        <select id="operation-select" class="input-field">
                            <option value="add">åŠ æ³• (+)</option>
                            <option value="subtract">å‡æ³• (-)</option>
                            <option value="multiply">ä¹˜æ³• (Ã—)</option>
                            <option value="divide">é™¤æ³• (Ã·)</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label for="poly2-input">ç¬¬äºŒä¸ªå¤šé¡¹å¼</label>
                        <input type="text" id="poly2-input" class="input-field" placeholder="x + 1">
                    </div>
                    
                    <button class="btn btn-primary" onclick="calculatePolynomial()">
                        <span>âš¡</span> è®¡ç®—
                    </button>
                    <button class="btn btn-secondary" onclick="clearPolynomialResult()">
                        <span>ğŸ—‘ï¸</span> æ¸…ç©º
                    </button>
                    
                    <div class="result-area" id="polynomial-result">
                        <h4>è¿ç®—ç»“æœ</h4>
                        <p>è¯·è¾“å…¥ä¸¤ä¸ªå¤šé¡¹å¼å¹¶é€‰æ‹©è¿ç®—ç±»å‹</p>
                    </div>
                </div>

                <!-- æ–¹ç¨‹ç»„æ±‚è§£ -->
                <div class="tool-section" id="system-equations">
                    <h3>æ–¹ç¨‹ç»„æ±‚è§£</h3>
                    <p>æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„å’Œéçº¿æ€§æ–¹ç¨‹ç»„</p>
                    
                    <div id="equations-container">
                        <div class="input-group">
                            <label>æ–¹ç¨‹ 1</label>
                            <input type="text" class="input-field equation-input" placeholder="2x + 3y = 7">
                        </div>
                        <div class="input-group">
                            <label>æ–¹ç¨‹ 2</label>
                            <input type="text" class="input-field equation-input" placeholder="x - y = 1">
                        </div>
                    </div>
                    
                    <button class="add-variable-btn" onclick="addEquation()">+ æ·»åŠ æ–¹ç¨‹</button>
                    
                    <div style="margin-top: 20px;">
                        <button class="btn btn-primary" onclick="solveSystem()">
                            <span>ğŸ¯</span> æ±‚è§£æ–¹ç¨‹ç»„
                        </button>
                        <button class="btn btn-secondary" onclick="clearSystemResult()">
                            <span>ğŸ—‘ï¸</span> æ¸…ç©º
                        </button>
                    </div>
                    
                    <div class="result-area" id="system-result">
                        <h4>æ–¹ç¨‹ç»„è§£</h4>
                        <p>è¯·è¾“å…¥æ–¹ç¨‹ç»„å¹¶ç‚¹å‡»æ±‚è§£æŒ‰é’®</p>
                    </div>
                </div>

                <!-- è¡¨è¾¾å¼åŒ–ç®€ -->
                <div class="tool-section" id="simplification">
                    <h3>è¡¨è¾¾å¼åŒ–ç®€</h3>
                    <p>åŒ–ç®€å¤æ‚çš„ä»£æ•°è¡¨è¾¾å¼</p>
                    
                    <div class="input-group">
                        <label for="simplify-input">è¾“å…¥è¡¨è¾¾å¼</label>
                        <input type="text" id="simplify-input" class="input-field" placeholder="(x + 1)^2 + 2(x + 1) + 1">
                    </div>
                    
                    <button class="btn btn-primary" onclick="simplifyExpression()">
                        <span>âœ¨</span> åŒ–ç®€
                    </button>
                    <button class="btn btn-secondary" onclick="clearSimplifyResult()">
                        <span>ğŸ—‘ï¸</span> æ¸…ç©º
                    </button>
                    
                    <div class="result-area" id="simplify-result">
                        <h4>åŒ–ç®€ç»“æœ</h4>
                        <p>è¯·è¾“å…¥è¡¨è¾¾å¼å¹¶ç‚¹å‡»åŒ–ç®€æŒ‰é’®</p>
                    </div>

                    <div class="examples-grid">
                        <div class="example-card" onclick="loadSimplifyExample('(x + 1)^2')">
                            <h5>å®Œå…¨å¹³æ–¹</h5>
                            <div class="equation">(x + 1)Â²</div>
                            <p>= xÂ² + 2x + 1</p>
                        </div>
                        <div class="example-card" onclick="loadSimplifyExample('(x + 2)(x - 2)')">
                            <h5>å¹³æ–¹å·®</h5>
                            <div class="equation">(x + 2)(x - 2)</div>
                            <p>= xÂ² - 4</p>
                        </div>
                        <div class="example-card" onclick="loadSimplifyExample('2x + 3x - x')">
                            <h5>åˆå¹¶åŒç±»é¡¹</h5>
                            <div class="equation">2x + 3x - x</div>
                            <p>= 4x</p>
                        </div>
                        <div class="example-card" onclick="loadSimplifyExample('(2x + 1)(x - 3)')">
                            <h5>å¤šé¡¹å¼ä¹˜æ³•</h5>
                            <div class="equation">(2x + 1)(x - 3)</div>
                            <p>= 2xÂ² - 5x - 3</p>
                        </div>
                    </div>
                </div>

                <!-- ç§‘å­¦è®¡ç®—å™¨ -->
                <div class="tool-section" id="calculator">
                    <h3>ç§‘å­¦è®¡ç®—å™¨</h3>
                    <p>æ”¯æŒåŸºæœ¬è¿ç®—ã€ä¸‰è§’å‡½æ•°ã€å¯¹æ•°ç­‰ç§‘å­¦è®¡ç®—</p>
                    
                    <div class="input-group">
                        <label for="calc-input">è¾“å…¥è¡¨è¾¾å¼</label>
                        <input type="text" id="calc-input" class="input-field" placeholder="sin(30) + cos(60) * log(10)">
                    </div>
                    
                    <div class="calculator-buttons" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin: 20px 0;">
                        <button class="btn btn-secondary" onclick="insertCalc('sin(')">sin</button>
                        <button class="btn btn-secondary" onclick="insertCalc('cos(')">cos</button>
                        <button class="btn btn-secondary" onclick="insertCalc('tan(')">tan</button>
                        <button class="btn btn-secondary" onclick="insertCalc('log(')">log</button>
                        <button class="btn btn-secondary" onclick="insertCalc('sqrt(')">âˆš</button>
                        <button class="btn btn-secondary" onclick="insertCalc('^')">^</button>
                        <button class="btn btn-secondary" onclick="insertCalc('pi')">Ï€</button>
                        <button class="btn btn-secondary" onclick="insertCalc('e')">e</button>
                    </div>
                    
                    <button class="btn btn-primary" onclick="calculateExpression()">
                        <span>ğŸ§®</span> è®¡ç®—
                    </button>
                    <button class="btn btn-secondary" onclick="clearCalculatorResult()">
                        <span>ğŸ—‘ï¸</span> æ¸…ç©º
                    </button>
                    
                    <div class="result-area" id="calculator-result">
                        <h4>è®¡ç®—ç»“æœ</h4>
                        <p>è¯·è¾“å…¥æ•°å­¦è¡¨è¾¾å¼å¹¶ç‚¹å‡»è®¡ç®—æŒ‰é’®</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab switching functionality
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                // Remove active class from all tabs and sections
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tool-section').forEach(s => s.classList.remove('active'));
                
                // Add active class to clicked tab
                btn.classList.add('active');
                
                // Show corresponding section
                const tabId = btn.dataset.tab;
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Equation solver
        function solveEquation() {
            const equation = document.getElementById('equation-input').value.trim();
            const resultDiv = document.getElementById('equation-result');
            
            if (!equation) {
                showError(resultDiv, 'è¯·è¾“å…¥æ–¹ç¨‹');
                return;
            }
            
            try {
                const solution = solveEquationLogic(equation);
                displayEquationResult(resultDiv, equation, solution);
            } catch (error) {
                showError(resultDiv, 'æ–¹ç¨‹æ ¼å¼é”™è¯¯æˆ–æ— æ³•æ±‚è§£: ' + error.message);
            }
        }

        function solveEquationLogic(equation) {
            // Simple equation solver for demonstration
            // In a real implementation, you'd use a proper math library
            
            // Handle simple linear equations like "2x + 3 = 7"
            if (equation.includes('=')) {
                const [left, right] = equation.split('=').map(s => s.trim());
                
                // Simple linear equation: ax + b = c
                const linearMatch = left.match(/^(-?\d*\.?\d*)x\s*([+-]\s*\d+\.?\d*)?$/);
                if (linearMatch && !isNaN(parseFloat(right))) {
                    const a = parseFloat(linearMatch[1]) || 1;
                    const b = parseFloat((linearMatch[2] || '0').replace(/\s/g, '')) || 0;
                    const c = parseFloat(right);
                    
                    const x = (c - b) / a;
                    return {
                        type: 'linear',
                        solutions: [x],
                        steps: [
                            `åŸæ–¹ç¨‹: ${equation}`,
                            `ç§»é¡¹: ${a}x = ${c} - ${b}`,
                            `åŒ–ç®€: ${a}x = ${c - b}`,
                            `è§£å¾—: x = ${x}`
                        ]
                    };
                }
                
                // Simple quadratic equation: x^2 + bx + c = 0
                const quadMatch = left.match(/^x\^2\s*([+-]\s*\d+\.?\d*)x\s*([+-]\s*\d+\.?\d*)?$/);
                if (quadMatch && parseFloat(right) === 0) {
                    const b = parseFloat((quadMatch[1] || '0').replace(/\s/g, '')) || 0;
                    const c = parseFloat((quadMatch[2] || '0').replace(/\s/g, '')) || 0;
                    
                    const discriminant = b * b - 4 * c;
                    if (discriminant >= 0) {
                        const x1 = (-b + Math.sqrt(discriminant)) / 2;
                        const x2 = (-b - Math.sqrt(discriminant)) / 2;
                        
                        return {
                            type: 'quadratic',
                            solutions: discriminant === 0 ? [x1] : [x1, x2],
                            steps: [
                                `åŸæ–¹ç¨‹: ${equation}`,
                                `æ ‡å‡†å½¢å¼: xÂ² + ${b}x + ${c} = 0`,
                                `åˆ¤åˆ«å¼: Î” = bÂ² - 4ac = ${b}Â² - 4(1)(${c}) = ${discriminant}`,
                                discriminant === 0 ? 
                                    `Î” = 0ï¼Œæœ‰ä¸€ä¸ªé‡æ ¹: x = ${x1}` :
                                    `Î” > 0ï¼Œæœ‰ä¸¤ä¸ªä¸åŒå®æ ¹: xâ‚ = ${x1}, xâ‚‚ = ${x2}`
                            ]
                        };
                    }
                }
            }
            
            throw new Error('æš‚ä¸æ”¯æŒæ­¤ç±»å‹æ–¹ç¨‹ï¼Œè¯·å°è¯•ç®€å•çš„ä¸€æ¬¡æˆ–äºŒæ¬¡æ–¹ç¨‹');
        }

        function displayEquationResult(resultDiv, equation, solution) {
            let html = `<h4>è§£ç­”ç»“æœ</h4>`;
            html += `<div class="formula-display">åŸæ–¹ç¨‹: ${equation}</div>`;
            
            if (solution.solutions.length === 1) {
                html += `<div class="success-message">è§£: x = ${solution.solutions[0]}</div>`;
            } else {
                html += `<div class="success-message">è§£: xâ‚ = ${solution.solutions[0]}, xâ‚‚ = ${solution.solutions[1]}</div>`;
            }
            
            if (solution.steps) {
                html += `<div class="step-by-step">`;
                html += `<h5>æ±‚è§£æ­¥éª¤:</h5>`;
                solution.steps.forEach((step, index) => {
                    html += `<div class="step">`;
                    html += `<span class="step-number">${index + 1}</span>`;
                    html += `${step}`;
                    html += `</div>`;
                });
                html += `</div>`;
            }
            
            resultDiv.innerHTML = html;
        }

        // Factor expression
        function factorExpression() {
            const expression = document.getElementById('factor-input').value.trim();
            const resultDiv = document.getElementById('factor-result');
            
            if (!expression) {
                showError(resultDiv, 'è¯·è¾“å…¥å¤šé¡¹å¼');
                return;
            }
            
            try {
                const factored = factorExpressionLogic(expression);
                displayFactorResult(resultDiv, expression, factored);
            } catch (error) {
                showError(resultDiv, 'è¡¨è¾¾å¼æ ¼å¼é”™è¯¯æˆ–æ— æ³•åˆ†è§£: ' + error.message);
            }
        }

        function factorExpressionLogic(expression) {
            // Simple factorization for demonstration
            
            // x^2 + bx + c form
            const quadMatch = expression.match(/^x\^2\s*([+-]\s*\d+\.?\d*)x\s*([+-]\s*\d+\.?\d*)$/);
            if (quadMatch) {
                const b = parseFloat((quadMatch[1] || '0').replace(/\s/g, '')) || 0;
                const c = parseFloat((quadMatch[2] || '0').replace(/\s/g, '')) || 0;
                
                // Find factors of c that add up to b
                for (let i = 1; i <= Math.abs(c); i++) {
                    if (c % i === 0) {
                        const factor1 = i;
                        const factor2 = c / i;
                        
                        if (factor1 + factor2 === b) {
                            return {
                                original: expression,
                                factored: `(x + ${factor1})(x + ${factor2})`,
                                steps: [
                                    `åŸå¼: ${expression}`,
                                    `å¯»æ‰¾ä¸¤ä¸ªæ•°ï¼Œå®ƒä»¬çš„ä¹˜ç§¯æ˜¯ ${c}ï¼Œå’Œæ˜¯ ${b}`,
                                    `è¿™ä¸¤ä¸ªæ•°æ˜¯ ${factor1} å’Œ ${factor2}`,
                                    `å› æ­¤: ${expression} = (x + ${factor1})(x + ${factor2})`
                                ]
                            };
                        }
                        
                        if (factor1 - factor2 === b) {
                            return {
                                original: expression,
                                factored: `(x + ${factor1})(x - ${factor2})`,
                                steps: [
                                    `åŸå¼: ${expression}`,
                                    `å¯»æ‰¾ä¸¤ä¸ªæ•°ï¼Œå®ƒä»¬çš„ä¹˜ç§¯æ˜¯ ${c}ï¼Œå·®æ˜¯ ${b}`,
                                    `è¿™ä¸¤ä¸ªæ•°æ˜¯ ${factor1} å’Œ ${factor2}`,
                                    `å› æ­¤: ${expression} = (x + ${factor1})(x - ${factor2})`
                                ]
                            };
                        }
                    }
                }
            }
            
            // Difference of squares: x^2 - a^2
            const diffSquareMatch = expression.match(/^x\^2\s*-\s*(\d+)$/);
            if (diffSquareMatch) {
                const a = Math.sqrt(parseFloat(diffSquareMatch[1]));
                if (Number.isInteger(a)) {
                    return {
                        original: expression,
                        factored: `(x + ${a})(x - ${a})`,
                        steps: [
                            `åŸå¼: ${expression}`,
                            `è¿™æ˜¯å¹³æ–¹å·®å…¬å¼: aÂ² - bÂ² = (a + b)(a - b)`,
                            `å…¶ä¸­ a = x, b = ${a}`,
                            `å› æ­¤: ${expression} = (x + ${a})(x - ${a})`
                        ]
                    };
                }
            }
            
            throw new Error('æš‚ä¸æ”¯æŒæ­¤ç±»å‹è¡¨è¾¾å¼çš„åˆ†è§£');
        }

        function displayFactorResult(resultDiv, expression, result) {
            let html = `<h4>åˆ†è§£ç»“æœ</h4>`;
            html += `<div class="formula-display">åŸå¼: ${result.original}</div>`;
            html += `<div class="success-message">åˆ†è§£ç»“æœ: ${result.factored}</div>`;
            
            if (result.steps) {
                html += `<div class="step-by-step">`;
                html += `<h5>åˆ†è§£æ­¥éª¤:</h5>`;
                result.steps.forEach((step, index) => {
                    html += `<div class="step">`;
                    html += `<span class="step-number">${index + 1}</span>`;
                    html += `${step}`;
                    html += `</div>`;
                });
                html += `</div>`;
            }
            
            resultDiv.innerHTML = html;
        }

        // Polynomial operations
        function calculatePolynomial() {
            const poly1 = document.getElementById('poly1-input').value.trim();
            const poly2 = document.getElementById('poly2-input').value.trim();
            const operation = document.getElementById('operation-select').value;
            const resultDiv = document.getElementById('polynomial-result');
            
            if (!poly1 || !poly2) {
                showError(resultDiv, 'è¯·è¾“å…¥ä¸¤ä¸ªå¤šé¡¹å¼');
                return;
            }
            
            try {
                const result = performPolynomialOperation(poly1, poly2, operation);
                displayPolynomialResult(resultDiv, poly1, poly2, operation, result);
            } catch (error) {
                showError(resultDiv, 'å¤šé¡¹å¼æ ¼å¼é”™è¯¯: ' + error.message);
            }
        }

        function performPolynomialOperation(poly1, poly2, operation) {
            // Simplified polynomial operations for demonstration
            const operationNames = {
                'add': 'åŠ æ³•',
                'subtract': 'å‡æ³•',
                'multiply': 'ä¹˜æ³•',
                'divide': 'é™¤æ³•'
            };
            
            return {
                operation: operationNames[operation],
                result: `(${poly1}) ${operation === 'add' ? '+' : operation === 'subtract' ? '-' : operation === 'multiply' ? 'Ã—' : 'Ã·'} (${poly2})`,
                note: 'å®Œæ•´çš„å¤šé¡¹å¼è¿ç®—éœ€è¦æ›´å¤æ‚çš„ç®—æ³•å®ç°'
            };
        }

        function displayPolynomialResult(resultDiv, poly1, poly2, operation, result) {
            let html = `<h4>è¿ç®—ç»“æœ</h4>`;
            html += `<div class="formula-display">${result.result}</div>`;
            html += `<div class="success-message">è¿ç®—ç±»å‹: ${result.operation}</div>`;
            html += `<p>${result.note}</p>`;
            
            resultDiv.innerHTML = html;
        }

        // System of equations
        function addEquation() {
            const container = document.getElementById('equations-container');
            const equationCount = container.children.length + 1;
            
            const div = document.createElement('div');
            div.className = 'input-group';
            div.innerHTML = `
                <label>æ–¹ç¨‹ ${equationCount}</label>
                <input type="text" class="input-field equation-input" placeholder="è¾“å…¥æ–¹ç¨‹">
            `;
            
            container.appendChild(div);
        }

        function solveSystem() {
            const equations = Array.from(document.querySelectorAll('.equation-input')).map(input => input.value.trim());
            const resultDiv = document.getElementById('system-result');
            
            const validEquations = equations.filter(eq => eq !== '');
            
            if (validEquations.length < 2) {
                showError(resultDiv, 'è¯·è‡³å°‘è¾“å…¥ä¸¤ä¸ªæ–¹ç¨‹');
                return;
            }
            
            try {
                const solution = solveSystemLogic(validEquations);
                displaySystemResult(resultDiv, validEquations, solution);
            } catch (error) {
                showError(resultDiv, 'æ–¹ç¨‹ç»„æ ¼å¼é”™è¯¯æˆ–æ— è§£: ' + error.message);
            }
        }

        function solveSystemLogic(equations) {
            // Simplified system solver for 2x2 linear systems
            if (equations.length === 2) {
                // Try to parse simple linear equations like "2x + 3y = 7"
                const eq1Match = equations[0].match(/^(-?\d*\.?\d*)x\s*([+-]\s*\d*\.?\d*)y\s*=\s*(-?\d+\.?\d*)$/);
                const eq2Match = equations[1].match(/^(-?\d*\.?\d*)x\s*([+-]\s*\d*\.?\d*)y\s*=\s*(-?\d+\.?\d*)$/);
                
                if (eq1Match && eq2Match) {
                    const a1 = parseFloat(eq1Match[1]) || 1;
                    const b1 = parseFloat((eq1Match[2] || '0').replace(/\s/g, '')) || 0;
                    const c1 = parseFloat(eq1Match[3]);
                    
                    const a2 = parseFloat(eq2Match[1]) || 1;
                    const b2 = parseFloat((eq2Match[2] || '0').replace(/\s/g, '')) || 0;
                    const c2 = parseFloat(eq2Match[3]);
                    
                    const det = a1 * b2 - a2 * b1;
                    
                    if (Math.abs(det) < 1e-10) {
                        throw new Error('æ–¹ç¨‹ç»„æ— å”¯ä¸€è§£ï¼ˆè¡Œåˆ—å¼ä¸º0ï¼‰');
                    }
                    
                    const x = (c1 * b2 - c2 * b1) / det;
                    const y = (a1 * c2 - a2 * c1) / det;
                    
                    return {
                        solutions: { x: x, y: y },
                        method: 'å…‹æ‹‰é»˜æ³•åˆ™',
                        steps: [
                            `æ–¹ç¨‹ç»„:`,
                            `${equations[0]}`,
                            `${equations[1]}`,
                            `ç³»æ•°çŸ©é˜µè¡Œåˆ—å¼: D = ${a1} Ã— ${b2} - ${a2} Ã— ${b1} = ${det}`,
                            `x = (${c1} Ã— ${b2} - ${c2} Ã— ${b1}) / ${det} = ${x}`,
                            `y = (${a1} Ã— ${c2} - ${a2} Ã— ${c1}) / ${det} = ${y}`
                        ]
                    };
                }
            }
            
            throw new Error('æš‚ä¸æ”¯æŒæ­¤ç±»å‹æ–¹ç¨‹ç»„ï¼Œè¯·å°è¯•ç®€å•çš„äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹ç»„');
        }

        function displaySystemResult(resultDiv, equations, solution) {
            let html = `<h4>æ–¹ç¨‹ç»„è§£</h4>`;
            
            if (solution.solutions) {
                html += `<div class="success-message">`;
                Object.entries(solution.solutions).forEach(([variable, value]) => {
                    html += `${variable} = ${value}<br>`;
                });
                html += `</div>`;
            }
            
            if (solution.steps) {
                html += `<div class="step-by-step">`;
                html += `<h5>æ±‚è§£æ­¥éª¤ (${solution.method}):</h5>`;
                solution.steps.forEach((step, index) => {
                    html += `<div class="step">`;
                    html += `<span class="step-number">${index + 1}</span>`;
                    html += `${step}`;
                    html += `</div>`;
                });
                html += `</div>`;
            }
            
            resultDiv.innerHTML = html;
        }

        // Expression simplification
        function simplifyExpression() {
            const expression = document.getElementById('simplify-input').value.trim();
            const resultDiv = document.getElementById('simplify-result');
            
            if (!expression) {
                showError(resultDiv, 'è¯·è¾“å…¥è¡¨è¾¾å¼');
                return;
            }
            
            try {
                const simplified = simplifyExpressionLogic(expression);
                displaySimplifyResult(resultDiv, expression, simplified);
            } catch (error) {
                showError(resultDiv, 'è¡¨è¾¾å¼æ ¼å¼é”™è¯¯: ' + error.message);
            }
        }

        function simplifyExpressionLogic(expression) {
            // Simple expression simplification examples
            const simplifications = {
                '(x + 1)^2': 'xÂ² + 2x + 1',
                '(x - 1)^2': 'xÂ² - 2x + 1',
                '(x + 2)(x - 2)': 'xÂ² - 4',
                '2x + 3x - x': '4x',
                'x + x + x': '3x'
            };
            
            if (simplifications[expression]) {
                return {
                    original: expression,
                    simplified: simplifications[expression],
                    steps: [`åŸå¼: ${expression}`, `åŒ–ç®€å: ${simplifications[expression]}`]
                };
            }
            
            return {
                original: expression,
                simplified: expression,
                steps: [`åŸå¼: ${expression}`, `è¯¥è¡¨è¾¾å¼å·²æ˜¯æœ€ç®€å½¢å¼`]
            };
        }

        function displaySimplifyResult(resultDiv, expression, result) {
            let html = `<h4>åŒ–ç®€ç»“æœ</h4>`;
            html += `<div class="formula-display">åŸå¼: ${result.original}</div>`;
            html += `<div class="success-message">åŒ–ç®€ç»“æœ: ${result.simplified}</div>`;
            
            if (result.steps) {
                html += `<div class="step-by-step">`;
                html += `<h5>åŒ–ç®€æ­¥éª¤:</h5>`;
                result.steps.forEach((step, index) => {
                    html += `<div class="step">`;
                    html += `<span class="step-number">${index + 1}</span>`;
                    html += `${step}`;
                    html += `</div>`;
                });
                html += `</div>`;
            }
            
            resultDiv.innerHTML = html;
        }

        // Scientific calculator
        function insertCalc(value) {
            const input = document.getElementById('calc-input');
            input.value += value;
        }

        function calculateExpression() {
            const expression = document.getElementById('calc-input').value.trim();
            const resultDiv = document.getElementById('calculator-result');
            
            if (!expression) {
                showError(resultDiv, 'è¯·è¾“å…¥è¡¨è¾¾å¼');
                return;
            }
            
            try {
                const result = evaluateExpression(expression);
                displayCalculatorResult(resultDiv, expression, result);
            } catch (error) {
                showError(resultDiv, 'è¡¨è¾¾å¼é”™è¯¯: ' + error.message);
            }
        }

        function evaluateExpression(expression) {
            // Simple expression evaluator for demonstration
            // Replace common math functions
            let expr = expression
                .replace(/sin\(/g, 'Math.sin(')
                .replace(/cos\(/g, 'Math.cos(')
                .replace(/tan\(/g, 'Math.tan(')
                .replace(/log\(/g, 'Math.log10(')
                .replace(/sqrt\(/g, 'Math.sqrt(')
                .replace(/pi/g, 'Math.PI')
                .replace(/e/g, 'Math.E')
                .replace(/\^/g, '**');
            
            try {
                const result = eval(expr);
                return {
                    original: expression,
                    result: result,
                    formatted: typeof result === 'number' ? result.toFixed(6).replace(/\.?0+$/, '') : result
                };
            } catch (e) {
                throw new Error('æ— æ³•è®¡ç®—è¡¨è¾¾å¼');
            }
        }

        function displayCalculatorResult(resultDiv, expression, result) {
            let html = `<h4>è®¡ç®—ç»“æœ</h4>`;
            html += `<div class="formula-display">${result.original} = ${result.formatted}</div>`;
            html += `<div class="success-message">ç²¾ç¡®å€¼: ${result.result}</div>`;
            
            resultDiv.innerHTML = html;
        }

        // Example loading functions
        function loadExample(equation) {
            document.getElementById('equation-input').value = equation;
        }

        function loadFactorExample(expression) {
            document.getElementById('factor-input').value = expression;
        }

        function loadSimplifyExample(expression) {
            document.getElementById('simplify-input').value = expression;
        }

        // Clear functions
        function clearEquationResult() {
            document.getElementById('equation-input').value = '';
            document.getElementById('equation-result').innerHTML = '<h4>è§£ç­”ç»“æœ</h4><p>è¯·è¾“å…¥æ–¹ç¨‹å¹¶ç‚¹å‡»æ±‚è§£æŒ‰é’®</p>';
        }

        function clearFactorResult() {
            document.getElementById('factor-input').value = '';
            document.getElementById('factor-result').innerHTML = '<h4>åˆ†è§£ç»“æœ</h4><p>è¯·è¾“å…¥å¤šé¡¹å¼å¹¶ç‚¹å‡»åˆ†è§£æŒ‰é’®</p>';
        }

        function clearPolynomialResult() {
            document.getElementById('poly1-input').value = '';
            document.getElementById('poly2-input').value = '';
            document.getElementById('polynomial-result').innerHTML = '<h4>è¿ç®—ç»“æœ</h4><p>è¯·è¾“å…¥ä¸¤ä¸ªå¤šé¡¹å¼å¹¶é€‰æ‹©è¿ç®—ç±»å‹</p>';
        }

        function clearSystemResult() {
            document.querySelectorAll('.equation-input').forEach(input => input.value = '');
            document.getElementById('system-result').innerHTML = '<h4>æ–¹ç¨‹ç»„è§£</h4><p>è¯·è¾“å…¥æ–¹ç¨‹ç»„å¹¶ç‚¹å‡»æ±‚è§£æŒ‰é’®</p>';
        }

        function clearSimplifyResult() {
            document.getElementById('simplify-input').value = '';
            document.getElementById('simplify-result').innerHTML = '<h4>åŒ–ç®€ç»“æœ</h4><p>è¯·è¾“å…¥è¡¨è¾¾å¼å¹¶ç‚¹å‡»åŒ–ç®€æŒ‰é’®</p>';
        }

        function clearCalculatorResult() {
            document.getElementById('calc-input').value = '';
            document.getElementById('calculator-result').innerHTML = '<h4>è®¡ç®—ç»“æœ</h4><p>è¯·è¾“å…¥æ•°å­¦è¡¨è¾¾å¼å¹¶ç‚¹å‡»è®¡ç®—æŒ‰é’®</p>';
        }

        // Utility functions
        function showError(resultDiv, message) {
            resultDiv.innerHTML = `<h4>é”™è¯¯</h4><div class="error-message">${message}</div>`;
        }
    </script>
</body>
</html> 