<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¾®ç§¯åˆ†å¯è§†åŒ– - æ•°å­¦å­¦ä¹ åŠ©æ‰‹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .calculus-workspace {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .tool-tabs {
            background: #f8f9fa;
            padding: 0;
            border-bottom: 2px solid #e9ecef;
            display: flex;
            overflow-x: auto;
        }

        .tab-btn {
            padding: 15px 25px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            color: #495057;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab-btn:hover {
            background: #e9ecef;
            color: #007bff;
        }

        .tab-btn.active {
            color: #007bff;
            border-bottom-color: #007bff;
            background: white;
        }

        .tool-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .tool-section {
            display: none;
        }

        .tool-section.active {
            display: block;
        }

        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.9);
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .back-btn:hover {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        /* Learning Section Styles */
        .learning-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
        }

        .learning-section h3 {
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .concept-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .concept-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 1.5rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .concept-card:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-5px);
        }

        .concept-card h4 {
            margin-bottom: 0.5rem;
            color: #fff;
        }

        .concept-card p {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Interactive Demo Styles */
        .interactive-demo {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1rem 0;
            border: 2px solid #e9ecef;
        }

        .demo-controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .demo-slider {
            flex: 1;
            min-width: 150px;
        }

        .demo-slider label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .demo-slider input[type="range"] {
            width: 100%;
            margin-bottom: 0.5rem;
        }

        .demo-value {
            text-align: center;
            font-weight: bold;
            color: #007bff;
        }

        .visualization-container {
            background: white;
            border-radius: 10px;
            padding: 1rem;
            margin: 1rem 0;
            border: 2px solid #e9ecef;
            min-height: 400px;
            position: relative;
        }

        .function-input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 16px;
            margin-bottom: 1rem;
            font-family: 'Courier New', monospace;
        }

        .function-input:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .btn-primary {
            background: #007bff;
            color: white;
        }

        .btn-primary:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #545b62;
        }

        .formula-display {
            font-family: 'Times New Roman', serif;
            font-size: 18px;
            text-align: center;
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border: 2px solid #e9ecef;
        }

        .explanation-box {
            background: #e7f3ff;
            border: 2px solid #b3d9ff;
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .explanation-box h4 {
            color: #0056b3;
            margin-bottom: 1rem;
        }

        .step-by-step {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border-left: 4px solid #28a745;
        }

        .step {
            margin-bottom: 10px;
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .step:last-child {
            border-bottom: none;
        }

        .step-number {
            display: inline-block;
            background: #007bff;
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            text-align: center;
            line-height: 25px;
            font-size: 12px;
            font-weight: bold;
            margin-right: 10px;
        }

        .examples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .example-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            border-left: 4px solid #17a2b8;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .example-card:hover {
            background: #e9ecef;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .example-card h5 {
            color: #17a2b8;
            margin-bottom: 8px;
        }

        .example-card .equation {
            font-family: 'Courier New', monospace;
            background: white;
            padding: 8px;
            border-radius: 4px;
            margin: 8px 0;
        }

        /* Canvas for plotting */
        .plot-canvas {
            width: 100%;
            height: 400px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .tool-tabs {
                flex-direction: column;
            }

            .tab-btn {
                text-align: center;
                border-bottom: 1px solid #e9ecef;
                border-right: none;
            }

            .tab-btn.active {
                border-bottom: 1px solid #007bff;
                border-right: none;
            }

            .tool-content {
                padding: 20px;
            }

            .concept-cards {
                grid-template-columns: 1fr;
            }

            .demo-controls {
                flex-direction: column;
            }

            .demo-slider {
                min-width: auto;
            }

            .learning-section {
                padding: 1.5rem;
            }

            .examples-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.5rem;
            }

            .header p {
                font-size: 0.9rem;
            }

            .tool-content {
                padding: 15px;
            }

            .learning-section {
                padding: 1rem;
            }

            .visualization-container {
                min-height: 300px;
            }
        }

        /* Solution Modal Styles */
        .solution-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .solution-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #999;
            transition: color 0.3s ease;
        }

        .close-btn:hover {
            color: #333;
        }

        .solution-step {
            background: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .solution-step h4 {
            color: #007bff;
            margin-bottom: 10px;
        }

        .solution-formula {
            background: #e7f3ff;
            padding: 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            text-align: center;
            font-size: 16px;
        }

        .solution-answer {
            background: #d4edda;
            border: 2px solid #28a745;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            text-align: center;
        }

        .solution-answer h4 {
            color: #28a745;
            margin-bottom: 10px;
        }

        /* Animation for smooth transitions */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Loading spinner */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #007bff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
    <!-- Include Plotly.js for advanced plotting -->
    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
</head>
<body>
    <button class="back-btn" onclick="window.location.href='main.html'">â† è¿”å›æ•°å­¦ä¸»é¡µ</button>
    
    <div class="container">
        <div class="header">
            <h1>ğŸ“ˆ å¾®ç§¯åˆ†å¯è§†åŒ–</h1>
            <p>æ¢ç´¢å¯¼æ•°ã€ç§¯åˆ†å’Œæé™çš„åŠ¨æ€ä¸–ç•Œ</p>
        </div>

        <div class="calculus-workspace">
            <div class="tool-tabs">
                <button class="tab-btn active" data-tab="derivatives">
                    <span>ğŸ“Š</span> å¯¼æ•°å¯è§†åŒ–
                </button>
                <button class="tab-btn" data-tab="integrals">
                    <span>ğŸ“</span> ç§¯åˆ†å¯è§†åŒ–
                </button>
                <button class="tab-btn" data-tab="limits">
                    <span>ğŸ¯</span> æé™æ¼”ç¤º
                </button>
                <button class="tab-btn" data-tab="series">
                    <span>ğŸ”¢</span> çº§æ•°å±•å¼€
                </button>
                <button class="tab-btn" data-tab="applications">
                    <span>ğŸš€</span> å®é™…åº”ç”¨
                </button>
            </div>

            <div class="tool-content">
                <!-- å¯¼æ•°å¯è§†åŒ– -->
                <div class="tool-section active" id="derivatives">
                    <h3>å¯¼æ•°å¯è§†åŒ–</h3>
                    <p>ç†è§£å¯¼æ•°çš„å‡ ä½•æ„ä¹‰å’Œç‰©ç†æ„ä¹‰</p>
                    
                    <!-- Learning Section -->
                    <div class="learning-section">
                        <h3>ğŸ“ å¯¼æ•°åŸºç¡€çŸ¥è¯†</h3>
                        <p>å¯¼æ•°æè¿°äº†å‡½æ•°åœ¨æŸä¸€ç‚¹çš„ç¬æ—¶å˜åŒ–ç‡ï¼Œæ˜¯å¾®ç§¯åˆ†çš„æ ¸å¿ƒæ¦‚å¿µä¹‹ä¸€ã€‚</p>
                        <div class="concept-cards">
                            <div class="concept-card">
                                <h4>å‡ ä½•æ„ä¹‰</h4>
                                <p>å¯¼æ•°è¡¨ç¤ºå‡½æ•°å›¾åƒåœ¨æŸç‚¹çš„åˆ‡çº¿æ–œç‡ï¼Œåæ˜ äº†å‡½æ•°åœ¨è¯¥ç‚¹çš„å˜åŒ–è¶‹åŠ¿ã€‚</p>
                            </div>
                            <div class="concept-card">
                                <h4>ç‰©ç†æ„ä¹‰</h4>
                                <p>åœ¨ç‰©ç†ä¸­ï¼Œå¯¼æ•°è¡¨ç¤ºç¬æ—¶é€Ÿåº¦ã€åŠ é€Ÿåº¦ç­‰å˜åŒ–ç‡æ¦‚å¿µã€‚</p>
                            </div>
                            <div class="concept-card">
                                <h4>æ±‚å¯¼æ³•åˆ™</h4>
                                <p>å¹‚å‡½æ•°æ³•åˆ™ã€ä¹˜ç§¯æ³•åˆ™ã€å•†æ³•åˆ™ã€é“¾å¼æ³•åˆ™ç­‰æ˜¯æ±‚å¯¼çš„åŸºæœ¬å·¥å…·ã€‚</p>
                            </div>
                            <div class="concept-card">
                                <h4>é«˜é˜¶å¯¼æ•°</h4>
                                <p>äºŒé˜¶å¯¼æ•°è¡¨ç¤ºå‡½æ•°çš„å‡¹å‡¸æ€§ï¼Œé«˜é˜¶å¯¼æ•°æœ‰æ›´æ·±å±‚çš„æ•°å­¦æ„ä¹‰ã€‚</p>
                            </div>
                        </div>
                    </div>

                    <!-- Interactive Demo -->
                    <div class="interactive-demo">
                        <h4>ğŸ® äº¤äº’å¼å¯¼æ•°æ¼”ç¤º</h4>
                        <p>è°ƒæ•´å‚æ•°è§‚å¯Ÿå‡½æ•°åŠå…¶å¯¼æ•°çš„å˜åŒ–</p>
                        
                        <div class="demo-controls">
                            <div class="demo-slider">
                                <label>å‡½æ•°ç±»å‹:</label>
                                <select id="derivative-function-type" onchange="updateDerivativeDemo()">
                                    <option value="polynomial">å¤šé¡¹å¼: axÂ³ + bxÂ² + cx + d</option>
                                    <option value="trigonometric">ä¸‰è§’å‡½æ•°: aÂ·sin(bx + c)</option>
                                    <option value="exponential">æŒ‡æ•°å‡½æ•°: aÂ·e^(bx)</option>
                                    <option value="logarithmic">å¯¹æ•°å‡½æ•°: aÂ·ln(bx + c)</option>
                                </select>
                            </div>
                        </div>

                        <div class="demo-controls" id="polynomial-controls">
                            <div class="demo-slider">
                                <label>ç³»æ•° a:</label>
                                <input type="range" id="poly-a" min="-2" max="2" value="1" step="0.1" oninput="updateDerivativeDemo()">
                                <div class="demo-value" id="poly-a-value">1</div>
                            </div>
                            <div class="demo-slider">
                                <label>ç³»æ•° b:</label>
                                <input type="range" id="poly-b" min="-3" max="3" value="0" step="0.1" oninput="updateDerivativeDemo()">
                                <div class="demo-value" id="poly-b-value">0</div>
                            </div>
                            <div class="demo-slider">
                                <label>ç³»æ•° c:</label>
                                <input type="range" id="poly-c" min="-5" max="5" value="1" step="0.1" oninput="updateDerivativeDemo()">
                                <div class="demo-value" id="poly-c-value">1</div>
                            </div>
                            <div class="demo-slider">
                                <label>ç³»æ•° d:</label>
                                <input type="range" id="poly-d" min="-5" max="5" value="0" step="0.1" oninput="updateDerivativeDemo()">
                                <div class="demo-value" id="poly-d-value">0</div>
                            </div>
                        </div>

                        <div class="demo-controls" id="trig-controls" style="display: none;">
                            <div class="demo-slider">
                                <label>æŒ¯å¹… a:</label>
                                <input type="range" id="trig-a" min="0.5" max="3" value="1" step="0.1" oninput="updateDerivativeDemo()">
                                <div class="demo-value" id="trig-a-value">1</div>
                            </div>
                            <div class="demo-slider">
                                <label>é¢‘ç‡ b:</label>
                                <input type="range" id="trig-b" min="0.5" max="3" value="1" step="0.1" oninput="updateDerivativeDemo()">
                                <div class="demo-value" id="trig-b-value">1</div>
                            </div>
                            <div class="demo-slider">
                                <label>ç›¸ä½ c:</label>
                                <input type="range" id="trig-c" min="0" max="6.28" value="0" step="0.1" oninput="updateDerivativeDemo()">
                                <div class="demo-value" id="trig-c-value">0</div>
                            </div>
                        </div>

                        <div class="visualization-container">
                            <div id="derivative-plot" class="plot-canvas"></div>
                        </div>

                        <div class="formula-display" id="derivative-formula">
                            f(x) = xÂ³, f'(x) = 3xÂ²
                        </div>
                    </div>

                    <!-- Practical Examples with Solutions -->
                    <div class="examples-grid">
                        <div class="example-card" onclick="showDerivativeExample('velocity')">
                            <h5>ğŸš— é€Ÿåº¦é—®é¢˜</h5>
                            <div class="equation">s(t) = 3tÂ² + 2t + 1</div>
                            <p>æ±‚t=2ç§’æ—¶çš„ç¬æ—¶é€Ÿåº¦</p>
                        </div>
                        <div class="example-card" onclick="showDerivativeExample('tangent')">
                            <h5>ğŸ“ åˆ‡çº¿æ–œç‡</h5>
                            <div class="equation">f(x) = xÂ³ - 4x + 1</div>
                            <p>æ±‚ç‚¹(2,1)å¤„çš„åˆ‡çº¿æ–¹ç¨‹</p>
                        </div>
                        <div class="example-card" onclick="showDerivativeExample('marginal')">
                            <h5>ğŸ’° è¾¹é™…æˆæœ¬</h5>
                            <div class="equation">C(x) = 0.1xÂ² + 5x + 100</div>
                            <p>æ±‚ç”Ÿäº§100ä»¶æ—¶çš„è¾¹é™…æˆæœ¬</p>
                        </div>
                        <div class="example-card" onclick="showDerivativeExample('growth')">
                            <h5>ğŸ“ˆ å¢é•¿ç‡</h5>
                            <div class="equation">P(t) = 1000e^(0.05t)</div>
                            <p>æ±‚äººå£å¢é•¿çš„ç¬æ—¶å¢é•¿ç‡</p>
                        </div>
                    </div>

                    <!-- Solution Modal -->
                    <div id="solution-modal" class="solution-modal" style="display: none;">
                        <div class="solution-content">
                            <span class="close-btn" onclick="closeSolutionModal()">&times;</span>
                            <h3 id="solution-title">è§£é¢˜æ­¥éª¤</h3>
                            <div id="solution-steps"></div>
                        </div>
                    </div>
                </div>

                <!-- ç§¯åˆ†å¯è§†åŒ– -->
                <div class="tool-section" id="integrals">
                    <h3>ç§¯åˆ†å¯è§†åŒ–</h3>
                    <p>ç†è§£ç§¯åˆ†çš„å‡ ä½•æ„ä¹‰å’Œè®¡ç®—æ–¹æ³•</p>
                    
                    <!-- Learning Section -->
                    <div class="learning-section">
                        <h3>ğŸ“ ç§¯åˆ†åŸºç¡€çŸ¥è¯†</h3>
                        <p>ç§¯åˆ†æ˜¯å¯¼æ•°çš„é€†è¿ç®—ï¼Œç”¨äºè®¡ç®—é¢ç§¯ã€ä½“ç§¯å’Œç´¯ç§¯é‡ã€‚</p>
                        <div class="concept-cards">
                            <div class="concept-card">
                                <h4>å®šç§¯åˆ†</h4>
                                <p>è¡¨ç¤ºå‡½æ•°å›¾åƒä¸xè½´ä¹‹é—´çš„æœ‰å‘é¢ç§¯ï¼Œæœ‰æ˜ç¡®çš„æ•°å€¼ç»“æœã€‚</p>
                            </div>
                            <div class="concept-card">
                                <h4>ä¸å®šç§¯åˆ†</h4>
                                <p>è¡¨ç¤ºåŸå‡½æ•°çš„é›†åˆï¼Œæ˜¯æ±‚å¯¼çš„é€†è¿‡ç¨‹ï¼Œç»“æœåŒ…å«ä»»æ„å¸¸æ•°Cã€‚</p>
                            </div>
                            <div class="concept-card">
                                <h4>é»æ›¼å’Œ</h4>
                                <p>é€šè¿‡çŸ©å½¢é¢ç§¯çš„æé™æ¥å®šä¹‰ç§¯åˆ†ï¼Œæ˜¯ç§¯åˆ†æ¦‚å¿µçš„åŸºç¡€ã€‚</p>
                            </div>
                            <div class="concept-card">
                                <h4>å¾®ç§¯åˆ†åŸºæœ¬å®šç†</h4>
                                <p>è¿æ¥äº†å¯¼æ•°å’Œç§¯åˆ†ï¼Œæä¾›äº†è®¡ç®—å®šç§¯åˆ†çš„æœ‰æ•ˆæ–¹æ³•ã€‚</p>
                            </div>
                        </div>
                    </div>

                    <!-- Interactive Demo -->
                    <div class="interactive-demo">
                        <h4>ğŸ® é»æ›¼å’Œå¯è§†åŒ–</h4>
                        <p>è§‚å¯ŸçŸ©å½¢æ•°é‡å¢åŠ æ—¶å¦‚ä½•é€¼è¿‘çœŸå®ç§¯åˆ†å€¼</p>
                        
                        <div class="demo-controls">
                            <div class="demo-slider">
                                <label>å‡½æ•°:</label>
                                <select id="integral-function" onchange="updateIntegralDemo()">
                                    <option value="quadratic">f(x) = xÂ²</option>
                                    <option value="cubic">f(x) = xÂ³</option>
                                    <option value="sine">f(x) = sin(x)</option>
                                    <option value="exponential">f(x) = e^x</option>
                                </select>
                            </div>
                            <div class="demo-slider">
                                <label>çŸ©å½¢æ•°é‡:</label>
                                <input type="range" id="rectangle-count" min="4" max="100" value="10" step="1" oninput="updateIntegralDemo()">
                                <div class="demo-value" id="rectangle-count-value">10</div>
                            </div>
                            <div class="demo-slider">
                                <label>ç§¯åˆ†ä¸‹é™:</label>
                                <input type="range" id="integral-lower" min="-2" max="2" value="0" step="0.1" oninput="updateIntegralDemo()">
                                <div class="demo-value" id="integral-lower-value">0</div>
                            </div>
                            <div class="demo-slider">
                                <label>ç§¯åˆ†ä¸Šé™:</label>
                                <input type="range" id="integral-upper" min="-2" max="4" value="2" step="0.1" oninput="updateIntegralDemo()">
                                <div class="demo-value" id="integral-upper-value">2</div>
                            </div>
                        </div>

                        <div class="visualization-container">
                            <div id="integral-plot" class="plot-canvas"></div>
                        </div>

                        <div class="explanation-box">
                            <h4>ç§¯åˆ†è®¡ç®—ç»“æœ</h4>
                            <div id="integral-result">
                                <p>é»æ›¼å’Œè¿‘ä¼¼å€¼: <span id="riemann-sum">2.67</span></p>
                                <p>ç²¾ç¡®ç§¯åˆ†å€¼: <span id="exact-integral">2.67</span></p>
                                <p>è¯¯å·®: <span id="integration-error">0.00</span></p>
                            </div>
                        </div>
                    </div>

                    <!-- Practical Examples with Solutions -->
                    <div class="examples-grid">
                        <div class="example-card" onclick="showIntegralExample('displacement')">
                            <h5>ğŸš— ä½ç§»è®¡ç®—</h5>
                            <div class="equation">v(t) = 2t + 3</div>
                            <p>æ±‚0åˆ°5ç§’å†…çš„æ€»ä½ç§»</p>
                        </div>
                        <div class="example-card" onclick="showIntegralExample('area')">
                            <h5>ğŸ“ é¢ç§¯è®¡ç®—</h5>
                            <div class="equation">y = xÂ² - 4</div>
                            <p>æ±‚æ›²çº¿ä¸xè½´å›´æˆçš„é¢ç§¯</p>
                        </div>
                        <div class="example-card" onclick="showIntegralExample('work')">
                            <h5>âš¡ åŠŸçš„è®¡ç®—</h5>
                            <div class="equation">F(x) = 10 - 2x</div>
                            <p>æ±‚å¼¹ç°§ä»0æ‹‰ä¼¸åˆ°3mæ‰€åšçš„åŠŸ</p>
                        </div>
                        <div class="example-card" onclick="showIntegralExample('volume')">
                            <h5>ğŸº ä½“ç§¯è®¡ç®—</h5>
                            <div class="equation">y = âˆšx, ç»•xè½´æ—‹è½¬</div>
                            <p>æ±‚ä»x=0åˆ°x=4çš„æ—‹è½¬ä½“ä½“ç§¯</p>
                        </div>
                        <div class="example-card" onclick="showIntegralExample('economics')">
                            <h5>ğŸ’° æ¶ˆè´¹è€…å‰©ä½™</h5>
                            <div class="equation">D(p) = 100 - 2p</div>
                            <p>ä»·æ ¼ä¸º20æ—¶çš„æ¶ˆè´¹è€…å‰©ä½™</p>
                        </div>
                        <div class="example-card" onclick="showIntegralExample('population')">
                            <h5>ğŸ‘¥ äººå£å¢é•¿</h5>
                            <div class="equation">P'(t) = 50e^(0.02t)</div>
                            <p>æ±‚10å¹´å†…çš„äººå£å¢é•¿é‡</p>
                        </div>
                    </div>
                </div>

                <!-- æé™æ¼”ç¤º -->
                <div class="tool-section" id="limits">
                    <h3>æé™æ¼”ç¤º</h3>
                    <p>ç†è§£æé™çš„æ¦‚å¿µå’Œè®¡ç®—æ–¹æ³•</p>
                    
                    <!-- Learning Section -->
                    <div class="learning-section">
                        <h3>ğŸ“ æé™åŸºç¡€çŸ¥è¯†</h3>
                        <p>æé™æ˜¯å¾®ç§¯åˆ†çš„åŸºç¡€æ¦‚å¿µï¼Œæè¿°äº†å‡½æ•°åœ¨æŸç‚¹é™„è¿‘çš„è¡Œä¸ºè¶‹åŠ¿ã€‚</p>
                        <div class="concept-cards">
                            <div class="concept-card">
                                <h4>å‡½æ•°æé™</h4>
                                <p>å½“è‡ªå˜é‡è¶‹è¿‘æŸä¸ªå€¼æ—¶ï¼Œå‡½æ•°å€¼çš„è¶‹è¿‘è¡Œä¸ºã€‚</p>
                            </div>
                            <div class="concept-card">
                                <h4>å·¦å³æé™</h4>
                                <p>ä»å·¦ä¾§å’Œå³ä¾§åˆ†åˆ«è¶‹è¿‘æ—¶çš„æé™å€¼ï¼Œç”¨äºåˆ¤æ–­æé™å­˜åœ¨æ€§ã€‚</p>
                            </div>
                            <div class="concept-card">
                                <h4>æ— ç©·æé™</h4>
                                <p>å‡½æ•°å€¼è¶‹å‘æ— ç©·å¤§æˆ–è‡ªå˜é‡è¶‹å‘æ— ç©·æ—¶çš„æé™è¡Œä¸ºã€‚</p>
                            </div>
                            <div class="concept-card">
                                <h4>è¿ç»­æ€§</h4>
                                <p>å‡½æ•°åœ¨æŸç‚¹è¿ç»­å½“ä¸”ä»…å½“è¯¥ç‚¹çš„æé™å€¼ç­‰äºå‡½æ•°å€¼ã€‚</p>
                            </div>
                        </div>
                    </div>

                    <!-- Interactive Demo -->
                    <div class="interactive-demo">
                        <h4>ğŸ® æé™å¯è§†åŒ–</h4>
                        <p>è§‚å¯Ÿå‡½æ•°åœ¨ç‰¹å®šç‚¹é™„è¿‘çš„è¡Œä¸º</p>
                        
                        <div class="demo-controls">
                            <div class="demo-slider">
                                <label>æé™ç±»å‹:</label>
                                <select id="limit-type" onchange="updateLimitDemo()">
                                    <option value="continuous">è¿ç»­å‡½æ•°</option>
                                    <option value="removable">å¯å»é—´æ–­</option>
                                    <option value="jump">è·³è·ƒé—´æ–­</option>
                                    <option value="infinite">æ— ç©·é—´æ–­</option>
                                </select>
                            </div>
                            <div class="demo-slider">
                                <label>è¶‹è¿‘ç‚¹ xâ‚€:</label>
                                <input type="range" id="limit-point" min="-3" max="3" value="0" step="0.1" oninput="updateLimitDemo()">
                                <div class="demo-value" id="limit-point-value">0</div>
                            </div>
                            <div class="demo-slider">
                                <label>è§‚å¯ŸèŒƒå›´ Î´:</label>
                                <input type="range" id="limit-delta" min="0.1" max="2" value="0.5" step="0.1" oninput="updateLimitDemo()">
                                <div class="demo-value" id="limit-delta-value">0.5</div>
                            </div>
                        </div>

                        <div class="visualization-container">
                            <div id="limit-plot" class="plot-canvas"></div>
                        </div>

                        <div class="explanation-box">
                            <h4>æé™åˆ†æ</h4>
                            <div id="limit-analysis">
                                <p>å·¦æé™: <span id="left-limit">1</span></p>
                                <p>å³æé™: <span id="right-limit">1</span></p>
                                <p>å‡½æ•°å€¼: <span id="function-value">1</span></p>
                                <p>æé™å­˜åœ¨æ€§: <span id="limit-existence">å­˜åœ¨</span></p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- çº§æ•°å±•å¼€ -->
                <div class="tool-section" id="series">
                    <h3>çº§æ•°å±•å¼€</h3>
                    <p>æ³°å‹’çº§æ•°å’Œå‚…é‡Œå¶çº§æ•°çš„å¯è§†åŒ–</p>
                    
                    <!-- Learning Section -->
                    <div class="learning-section">
                        <h3>ğŸ“ çº§æ•°åŸºç¡€çŸ¥è¯†</h3>
                        <p>çº§æ•°æ˜¯æ— ç©·å¤šé¡¹çš„å’Œï¼Œåœ¨æ•°å­¦åˆ†æå’Œåº”ç”¨æ•°å­¦ä¸­æœ‰é‡è¦ä½œç”¨ã€‚</p>
                        <div class="concept-cards">
                            <div class="concept-card">
                                <h4>æ³°å‹’çº§æ•°</h4>
                                <p>ç”¨å¤šé¡¹å¼é€¼è¿‘å‡½æ•°ï¼Œåœ¨æ•°å€¼è®¡ç®—å’Œç†è®ºåˆ†æä¸­å¹¿æ³›åº”ç”¨ã€‚</p>
                            </div>
                            <div class="concept-card">
                                <h4>éº¦å…‹åŠ³æ—çº§æ•°</h4>
                                <p>åœ¨x=0å¤„å±•å¼€çš„æ³°å‹’çº§æ•°ï¼Œè®¸å¤šåŸºæœ¬å‡½æ•°éƒ½æœ‰ç®€æ´çš„å±•å¼€å¼ã€‚</p>
                            </div>
                            <div class="concept-card">
                                <h4>æ”¶æ•›æ€§</h4>
                                <p>çº§æ•°æ˜¯å¦æ”¶æ•›å†³å®šäº†å±•å¼€çš„æœ‰æ•ˆæ€§å’Œåº”ç”¨èŒƒå›´ã€‚</p>
                            </div>
                            <div class="concept-card">
                                <h4>å‚…é‡Œå¶çº§æ•°</h4>
                                <p>ç”¨ä¸‰è§’å‡½æ•°å±•å¼€å‘¨æœŸå‡½æ•°ï¼Œåœ¨ä¿¡å·å¤„ç†ä¸­åº”ç”¨å¹¿æ³›ã€‚</p>
                            </div>
                        </div>
                    </div>

                    <!-- Interactive Demo -->
                    <div class="interactive-demo">
                        <h4>ğŸ® æ³°å‹’çº§æ•°é€¼è¿‘</h4>
                        <p>è§‚å¯Ÿä¸åŒé¡¹æ•°çš„æ³°å‹’çº§æ•°å¦‚ä½•é€¼è¿‘åŸå‡½æ•°</p>
                        
                        <div class="demo-controls">
                            <div class="demo-slider">
                                <label>å‡½æ•°:</label>
                                <select id="series-function" onchange="updateSeriesDemo()">
                                    <option value="exp">e^x</option>
                                    <option value="sin">sin(x)</option>
                                    <option value="cos">cos(x)</option>
                                    <option value="ln">ln(1+x)</option>
                                </select>
                            </div>
                            <div class="demo-slider">
                                <label>å±•å¼€é¡¹æ•°:</label>
                                <input type="range" id="series-terms" min="1" max="10" value="3" step="1" oninput="updateSeriesDemo()">
                                <div class="demo-value" id="series-terms-value">3</div>
                            </div>
                            <div class="demo-slider">
                                <label>å±•å¼€ä¸­å¿ƒ:</label>
                                <input type="range" id="series-center" min="-2" max="2" value="0" step="0.1" oninput="updateSeriesDemo()">
                                <div class="demo-value" id="series-center-value">0</div>
                            </div>
                        </div>

                        <div class="visualization-container">
                            <div id="series-plot" class="plot-canvas"></div>
                        </div>

                        <div class="formula-display" id="series-formula">
                            e^x â‰ˆ 1 + x + xÂ²/2! + xÂ³/3!
                        </div>
                    </div>
                </div>

                <!-- å®é™…åº”ç”¨ -->
                <div class="tool-section" id="applications">
                    <h3>å¾®ç§¯åˆ†å®é™…åº”ç”¨</h3>
                    <p>å¾®ç§¯åˆ†åœ¨ç‰©ç†ã€å·¥ç¨‹ã€ç»æµç­‰é¢†åŸŸçš„åº”ç”¨</p>
                    
                    <!-- Learning Section -->
                    <div class="learning-section">
                        <h3>ğŸ“ å¾®ç§¯åˆ†åº”ç”¨é¢†åŸŸ</h3>
                        <p>å¾®ç§¯åˆ†ä¸ä»…æ˜¯æ•°å­¦ç†è®ºï¼Œæ›´æ˜¯è§£å†³å®é™…é—®é¢˜çš„å¼ºå¤§å·¥å…·ã€‚</p>
                        <div class="concept-cards">
                            <div class="concept-card">
                                <h4>ç‰©ç†å­¦</h4>
                                <p>è¿åŠ¨å­¦ã€åŠ¨åŠ›å­¦ã€ç”µç£å­¦ç­‰éƒ½å¤§é‡ä½¿ç”¨å¾®ç§¯åˆ†æ¦‚å¿µã€‚</p>
                            </div>
                            <div class="concept-card">
                                <h4>å·¥ç¨‹å­¦</h4>
                                <p>ç»“æ„åˆ†æã€ä¿¡å·å¤„ç†ã€æ§åˆ¶ç³»ç»Ÿè®¾è®¡ç­‰å·¥ç¨‹é—®é¢˜ã€‚</p>
                            </div>
                            <div class="concept-card">
                                <h4>ç»æµå­¦</h4>
                                <p>è¾¹é™…æˆæœ¬ã€æœ€ä¼˜åŒ–é—®é¢˜ã€ç»æµå¢é•¿æ¨¡å‹ç­‰ã€‚</p>
                            </div>
                            <div class="concept-card">
                                <h4>ç”Ÿç‰©å­¦</h4>
                                <p>ç§ç¾¤å¢é•¿ã€è¯ç‰©æµ“åº¦å˜åŒ–ã€ç”Ÿæ€ç³»ç»Ÿå»ºæ¨¡ç­‰ã€‚</p>
                            </div>
                        </div>
                    </div>

                    <!-- Interactive Demo -->
                    <div class="interactive-demo">
                        <h4>ğŸ® ä¼˜åŒ–é—®é¢˜æ¼”ç¤º</h4>
                        <p>ä½¿ç”¨å¯¼æ•°æ±‚è§£å®é™…ä¼˜åŒ–é—®é¢˜</p>
                        
                        <div class="demo-controls">
                            <div class="demo-slider">
                                <label>é—®é¢˜ç±»å‹:</label>
                                <select id="optimization-type" onchange="updateOptimizationDemo()">
                                    <option value="box">æœ€å¤§ä½“ç§¯ç›’å­</option>
                                    <option value="fence">æœ€å°å›´æ é¢ç§¯</option>
                                    <option value="profit">æœ€å¤§åˆ©æ¶¦</option>
                                    <option value="distance">æœ€çŸ­è·ç¦»</option>
                                </select>
                            </div>
                            <div class="demo-slider" id="box-controls">
                                <label>çº¸å¼ è¾¹é•¿:</label>
                                <input type="range" id="paper-size" min="10" max="30" value="20" step="1" oninput="updateOptimizationDemo()">
                                <div class="demo-value" id="paper-size-value">20</div>
                            </div>
                        </div>

                        <div class="visualization-container">
                            <div id="optimization-plot" class="plot-canvas"></div>
                        </div>

                        <div class="explanation-box">
                            <h4>ä¼˜åŒ–ç»“æœ</h4>
                            <div id="optimization-result">
                                <p>æœ€ä¼˜è§£: <span id="optimal-value">x = 3.33</span></p>
                                <p>æœ€å¤§å€¼: <span id="maximum-value">V = 592.59</span></p>
                                <p>è§£é‡Š: <span id="optimization-explanation">å½“åˆ‡å»è¾¹é•¿ä¸º3.33æ—¶ï¼Œç›’å­ä½“ç§¯æœ€å¤§</span></p>
                            </div>
                        </div>
                    </div>

                    <!-- Real-world Examples -->
                    <div class="examples-grid">
                        <div class="example-card" onclick="loadApplicationExample('physics')">
                            <h5>ç‰©ç†åº”ç”¨</h5>
                            <div class="equation">F = ma = m(dv/dt)</div>
                            <p>ç‰›é¡¿ç¬¬äºŒå®šå¾‹ä¸­çš„å¯¼æ•°</p>
                        </div>
                        <div class="example-card" onclick="loadApplicationExample('economics')">
                            <h5>ç»æµåº”ç”¨</h5>
                            <div class="equation">MC = dC/dq</div>
                            <p>è¾¹é™…æˆæœ¬çš„å¯¼æ•°å®šä¹‰</p>
                        </div>
                        <div class="example-card" onclick="loadApplicationExample('biology')">
                            <h5>ç”Ÿç‰©åº”ç”¨</h5>
                            <div class="equation">dP/dt = rP(1-P/K)</div>
                            <p>Logisticå¢é•¿æ¨¡å‹</p>
                        </div>
                        <div class="example-card" onclick="loadApplicationExample('engineering')">
                            <h5>å·¥ç¨‹åº”ç”¨</h5>
                            <div class="equation">âˆ« P(t) dt = Energy</div>
                            <p>åŠŸç‡ç§¯åˆ†æ±‚èƒ½é‡</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab switching functionality
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                // Remove active class from all tabs and sections
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tool-section').forEach(s => s.classList.remove('active'));
                
                // Add active class to clicked tab
                btn.classList.add('active');
                
                // Show corresponding section
                const tabId = btn.dataset.tab;
                document.getElementById(tabId).classList.add('active');
                
                // Initialize the corresponding demo
                switch(tabId) {
                    case 'derivatives':
                        updateDerivativeDemo();
                        break;
                    case 'integrals':
                        updateIntegralDemo();
                        break;
                    case 'limits':
                        updateLimitDemo();
                        break;
                    case 'series':
                        updateSeriesDemo();
                        break;
                    case 'applications':
                        updateOptimizationDemo();
                        break;
                }
            });
        });

        // Derivative visualization
        function updateDerivativeDemo() {
            const functionType = document.getElementById('derivative-function-type').value;
            
            // Show/hide appropriate controls
            document.getElementById('polynomial-controls').style.display = 
                functionType === 'polynomial' ? 'flex' : 'none';
            document.getElementById('trig-controls').style.display = 
                functionType === 'trigonometric' ? 'flex' : 'none';
            
            let x = [];
            let y = [];
            let dy = [];
            let formula = '';
            let derivativeFormula = '';
            
            // Generate x values
            for (let i = -5; i <= 5; i += 0.1) {
                x.push(i);
            }
            
            if (functionType === 'polynomial') {
                const a = parseFloat(document.getElementById('poly-a').value);
                const b = parseFloat(document.getElementById('poly-b').value);
                const c = parseFloat(document.getElementById('poly-c').value);
                const d = parseFloat(document.getElementById('poly-d').value);
                
                // Update value displays
                document.getElementById('poly-a-value').textContent = a;
                document.getElementById('poly-b-value').textContent = b;
                document.getElementById('poly-c-value').textContent = c;
                document.getElementById('poly-d-value').textContent = d;
                
                // Calculate function and derivative values
                x.forEach(xi => {
                    const yi = a * xi * xi * xi + b * xi * xi + c * xi + d;
                    const dyi = 3 * a * xi * xi + 2 * b * xi + c;
                    y.push(yi);
                    dy.push(dyi);
                });
                
                formula = `f(x) = ${a}xÂ³ + ${b}xÂ² + ${c}x + ${d}`;
                derivativeFormula = `f'(x) = ${3*a}xÂ² + ${2*b}x + ${c}`;
            } else if (functionType === 'trigonometric') {
                const a = parseFloat(document.getElementById('trig-a').value);
                const b = parseFloat(document.getElementById('trig-b').value);
                const c = parseFloat(document.getElementById('trig-c').value);
                
                // Update value displays
                document.getElementById('trig-a-value').textContent = a;
                document.getElementById('trig-b-value').textContent = b;
                document.getElementById('trig-c-value').textContent = c.toFixed(2);
                
                // Calculate function and derivative values
                x.forEach(xi => {
                    const yi = a * Math.sin(b * xi + c);
                    const dyi = a * b * Math.cos(b * xi + c);
                    y.push(yi);
                    dy.push(dyi);
                });
                
                formula = `f(x) = ${a}sin(${b}x + ${c.toFixed(2)})`;
                derivativeFormula = `f'(x) = ${a*b}cos(${b}x + ${c.toFixed(2)})`;
            }
            
            // Update formula display
            document.getElementById('derivative-formula').innerHTML = 
                `${formula}<br>${derivativeFormula}`;
            
            // Plot the function and its derivative
            const trace1 = {
                x: x,
                y: y,
                type: 'scatter',
                mode: 'lines',
                name: 'f(x)',
                line: { color: 'blue', width: 3 }
            };
            
            const trace2 = {
                x: x,
                y: dy,
                type: 'scatter',
                mode: 'lines',
                name: "f'(x)",
                line: { color: 'red', width: 3 }
            };
            
            const layout = {
                title: 'å‡½æ•°åŠå…¶å¯¼æ•°',
                xaxis: { title: 'x' },
                yaxis: { title: 'y' },
                showlegend: true,
                grid: true
            };
            
            Plotly.newPlot('derivative-plot', [trace1, trace2], layout, {responsive: true});
        }

        // Integral visualization
        function updateIntegralDemo() {
            const functionType = document.getElementById('integral-function').value;
            const n = parseInt(document.getElementById('rectangle-count').value);
            const a = parseFloat(document.getElementById('integral-lower').value);
            const b = parseFloat(document.getElementById('integral-upper').value);
            
            // Update value displays
            document.getElementById('rectangle-count-value').textContent = n;
            document.getElementById('integral-lower-value').textContent = a;
            document.getElementById('integral-upper-value').textContent = b;
            
            let x = [];
            let y = [];
            let func;
            let exactIntegral;
            
            // Define function
            switch(functionType) {
                case 'quadratic':
                    func = x => x * x;
                    exactIntegral = (b * b * b - a * a * a) / 3;
                    break;
                case 'cubic':
                    func = x => x * x * x;
                    exactIntegral = (b * b * b * b - a * a * a * a) / 4;
                    break;
                case 'sine':
                    func = x => Math.sin(x);
                    exactIntegral = -Math.cos(b) + Math.cos(a);
                    break;
                case 'exponential':
                    func = x => Math.exp(x);
                    exactIntegral = Math.exp(b) - Math.exp(a);
                    break;
            }
            
            // Generate smooth curve
            for (let i = a; i <= b; i += (b - a) / 200) {
                x.push(i);
                y.push(func(i));
            }
            
            // Calculate Riemann sum
            const dx = (b - a) / n;
            let riemannSum = 0;
            let rectangleX = [];
            let rectangleY = [];
            
            for (let i = 0; i < n; i++) {
                const xi = a + i * dx;
                const height = func(xi);
                riemannSum += height * dx;
                
                // Rectangle coordinates
                rectangleX.push(xi, xi + dx, xi + dx, xi, xi, null);
                rectangleY.push(0, 0, height, height, 0, null);
            }
            
            // Update results
            document.getElementById('riemann-sum').textContent = riemannSum.toFixed(4);
            document.getElementById('exact-integral').textContent = exactIntegral.toFixed(4);
            document.getElementById('integration-error').textContent = 
                Math.abs(riemannSum - exactIntegral).toFixed(4);
            
            // Plot
            const trace1 = {
                x: x,
                y: y,
                type: 'scatter',
                mode: 'lines',
                name: 'f(x)',
                line: { color: 'blue', width: 3 }
            };
            
            const trace2 = {
                x: rectangleX,
                y: rectangleY,
                type: 'scatter',
                mode: 'lines',
                name: 'é»æ›¼å’Œ',
                line: { color: 'red', width: 1 },
                fill: 'tozeroy',
                fillcolor: 'rgba(255, 0, 0, 0.3)'
            };
            
            const layout = {
                title: `ç§¯åˆ†å¯è§†åŒ– (n = ${n})`,
                xaxis: { title: 'x' },
                yaxis: { title: 'y' },
                showlegend: true
            };
            
            Plotly.newPlot('integral-plot', [trace1, trace2], layout, {responsive: true});
        }

        // Limit visualization
        function updateLimitDemo() {
            const limitType = document.getElementById('limit-type').value;
            const x0 = parseFloat(document.getElementById('limit-point').value);
            const delta = parseFloat(document.getElementById('limit-delta').value);
            
            // Update value displays
            document.getElementById('limit-point-value').textContent = x0;
            document.getElementById('limit-delta-value').textContent = delta;
            
            let x = [];
            let y = [];
            let func;
            let leftLimit, rightLimit, functionValue;
            
            // Generate x values
            for (let i = x0 - 3; i <= x0 + 3; i += 0.01) {
                x.push(i);
            }
            
            // Define function based on limit type
            switch(limitType) {
                case 'continuous':
                    func = x => x * x;
                    leftLimit = rightLimit = functionValue = x0 * x0;
                    break;
                case 'removable':
                    func = x => x === x0 ? 2 : (x * x - x0 * x0) / (x - x0);
                    leftLimit = rightLimit = 2 * x0;
                    functionValue = 2;
                    break;
                case 'jump':
                    func = x => x < x0 ? x + 1 : x + 2;
                    leftLimit = x0 + 1;
                    rightLimit = x0 + 2;
                    functionValue = x0 + 2;
                    break;
                case 'infinite':
                    func = x => x === x0 ? undefined : 1 / (x - x0);
                    leftLimit = -Infinity;
                    rightLimit = Infinity;
                    functionValue = undefined;
                    break;
            }
            
            // Calculate y values
            x.forEach(xi => {
                if (limitType === 'infinite' && Math.abs(xi - x0) < 0.01) {
                    y.push(null);
                } else {
                    y.push(func(xi));
                }
            });
            
            // Update analysis
            document.getElementById('left-limit').textContent = 
                leftLimit === Infinity ? 'âˆ' : leftLimit === -Infinity ? '-âˆ' : leftLimit.toFixed(2);
            document.getElementById('right-limit').textContent = 
                rightLimit === Infinity ? 'âˆ' : rightLimit === -Infinity ? '-âˆ' : rightLimit.toFixed(2);
            document.getElementById('function-value').textContent = 
                functionValue === undefined ? 'æœªå®šä¹‰' : functionValue.toFixed(2);
            document.getElementById('limit-existence').textContent = 
                leftLimit === rightLimit && isFinite(leftLimit) ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨';
            
            // Plot
            const trace = {
                x: x,
                y: y,
                type: 'scatter',
                mode: 'lines',
                name: 'f(x)',
                line: { color: 'blue', width: 3 }
            };
            
            // Add vertical line at x0
            const verticalLine = {
                x: [x0, x0],
                y: [-10, 10],
                type: 'scatter',
                mode: 'lines',
                name: `x = ${x0}`,
                line: { color: 'red', width: 2, dash: 'dash' }
            };
            
            const layout = {
                title: `æé™æ¼”ç¤º: x â†’ ${x0}`,
                xaxis: { title: 'x', range: [x0 - 2, x0 + 2] },
                yaxis: { title: 'y', range: [-5, 5] },
                showlegend: true
            };
            
            Plotly.newPlot('limit-plot', [trace, verticalLine], layout, {responsive: true});
        }

        // Series visualization
        function updateSeriesDemo() {
            const functionType = document.getElementById('series-function').value;
            const terms = parseInt(document.getElementById('series-terms').value);
            const center = parseFloat(document.getElementById('series-center').value);
            
            // Update value displays
            document.getElementById('series-terms-value').textContent = terms;
            document.getElementById('series-center-value').textContent = center;
            
            let x = [];
            let originalY = [];
            let seriesY = [];
            let formula = '';
            
            // Generate x values
            for (let i = -3; i <= 3; i += 0.05) {
                x.push(i);
            }
            
            // Calculate original function and Taylor series
            x.forEach(xi => {
                let original, series = 0;
                const dx = xi - center;
                
                switch(functionType) {
                    case 'exp':
                        original = Math.exp(xi);
                        for (let n = 0; n < terms; n++) {
                            series += Math.pow(dx, n) / factorial(n);
                        }
                        series *= Math.exp(center);
                        formula = `e^x â‰ˆ e^${center}`;
                        for (let n = 0; n < terms; n++) {
                            if (n === 0) formula += ` Ã— (1`;
                            else formula += ` + (x-${center})^${n}/${factorial(n)}`;
                        }
                        formula += ')';
                        break;
                        
                    case 'sin':
                        original = Math.sin(xi);
                        for (let n = 0; n < terms; n++) {
                            const coeff = Math.pow(-1, n) / factorial(2 * n + 1);
                            series += coeff * Math.pow(dx, 2 * n + 1);
                        }
                        formula = `sin(x) â‰ˆ `;
                        for (let n = 0; n < terms; n++) {
                            if (n > 0) formula += ' + ';
                            formula += `(-1)^${n} Ã— x^${2*n+1}/${factorial(2*n+1)}`;
                        }
                        break;
                        
                    case 'cos':
                        original = Math.cos(xi);
                        for (let n = 0; n < terms; n++) {
                            const coeff = Math.pow(-1, n) / factorial(2 * n);
                            series += coeff * Math.pow(dx, 2 * n);
                        }
                        formula = `cos(x) â‰ˆ `;
                        for (let n = 0; n < terms; n++) {
                            if (n > 0) formula += ' + ';
                            formula += `(-1)^${n} Ã— x^${2*n}/${factorial(2*n)}`;
                        }
                        break;
                        
                    case 'ln':
                        if (xi > -1) {
                            original = Math.log(1 + xi);
                            for (let n = 1; n <= terms; n++) {
                                series += Math.pow(-1, n + 1) * Math.pow(dx, n) / n;
                            }
                        } else {
                            original = null;
                            series = null;
                        }
                        formula = `ln(1+x) â‰ˆ `;
                        for (let n = 1; n <= terms; n++) {
                            if (n > 1) formula += ' + ';
                            formula += `(-1)^${n+1} Ã— x^${n}/${n}`;
                        }
                        break;
                }
                
                originalY.push(original);
                seriesY.push(series);
            });
            
            // Update formula display
            document.getElementById('series-formula').innerHTML = formula;
            
            // Plot
            const trace1 = {
                x: x,
                y: originalY,
                type: 'scatter',
                mode: 'lines',
                name: 'åŸå‡½æ•°',
                line: { color: 'blue', width: 3 }
            };
            
            const trace2 = {
                x: x,
                y: seriesY,
                type: 'scatter',
                mode: 'lines',
                name: `æ³°å‹’çº§æ•° (${terms}é¡¹)`,
                line: { color: 'red', width: 3, dash: 'dash' }
            };
            
            const layout = {
                title: `æ³°å‹’çº§æ•°é€¼è¿‘ (${terms}é¡¹)`,
                xaxis: { title: 'x' },
                yaxis: { title: 'y' },
                showlegend: true
            };
            
            Plotly.newPlot('series-plot', [trace1, trace2], layout, {responsive: true});
        }

        // Optimization visualization
        function updateOptimizationDemo() {
            const optimizationType = document.getElementById('optimization-type').value;
            
            let x = [];
            let y = [];
            let optimalX, optimalY, explanation;
            
            if (optimizationType === 'box') {
                const paperSize = parseFloat(document.getElementById('paper-size').value);
                document.getElementById('paper-size-value').textContent = paperSize;
                
                // Box volume function: V = x(L-2x)(W-2x) where L=W=paperSize
                for (let i = 0; i <= paperSize/2; i += 0.1) {
                    x.push(i);
                    const volume = i * (paperSize - 2*i) * (paperSize - 2*i);
                    y.push(volume);
                }
                
                // Find optimal value (derivative = 0)
                optimalX = paperSize / 6;
                optimalY = optimalX * (paperSize - 2*optimalX) * (paperSize - 2*optimalX);
                explanation = `å½“åˆ‡å»è¾¹é•¿ä¸º${optimalX.toFixed(2)}æ—¶ï¼Œç›’å­ä½“ç§¯æœ€å¤§`;
                
                document.getElementById('optimal-value').textContent = `x = ${optimalX.toFixed(2)}`;
                document.getElementById('maximum-value').textContent = `V = ${optimalY.toFixed(2)}`;
                document.getElementById('optimization-explanation').textContent = explanation;
            }
            
            // Plot
            const trace = {
                x: x,
                y: y,
                type: 'scatter',
                mode: 'lines',
                name: 'ç›®æ ‡å‡½æ•°',
                line: { color: 'blue', width: 3 }
            };
            
            const optimalPoint = {
                x: [optimalX],
                y: [optimalY],
                type: 'scatter',
                mode: 'markers',
                name: 'æœ€ä¼˜ç‚¹',
                marker: { color: 'red', size: 10 }
            };
            
            const layout = {
                title: 'ä¼˜åŒ–é—®é¢˜å¯è§†åŒ–',
                xaxis: { title: 'x' },
                yaxis: { title: 'ç›®æ ‡å‡½æ•°å€¼' },
                showlegend: true
            };
            
            Plotly.newPlot('optimization-plot', [trace, optimalPoint], layout, {responsive: true});
        }

        // Helper function for factorial
        function factorial(n) {
            if (n <= 1) return 1;
            return n * factorial(n - 1);
        }

        // Solution Modal Functions
        function showDerivativeExample(type) {
            const solutions = {
                velocity: {
                    title: "ğŸš— é€Ÿåº¦é—®é¢˜è§£ç­”",
                    steps: [
                        {
                            title: "æ­¥éª¤1: ç†è§£é—®é¢˜",
                            content: "å·²çŸ¥ä½ç§»å‡½æ•° s(t) = 3tÂ² + 2t + 1ï¼Œæ±‚ t = 2 ç§’æ—¶çš„ç¬æ—¶é€Ÿåº¦ã€‚<br>ç¬æ—¶é€Ÿåº¦ = ä½ç§»å‡½æ•°çš„å¯¼æ•°"
                        },
                        {
                            title: "æ­¥éª¤2: æ±‚å¯¼æ•°",
                            content: "s'(t) = d/dt(3tÂ² + 2t + 1)",
                            formula: "s'(t) = 6t + 2"
                        },
                        {
                            title: "æ­¥éª¤3: ä»£å…¥ t = 2",
                            content: "v(2) = s'(2) = 6(2) + 2 = 12 + 2 = 14",
                            formula: "v(2) = 14 m/s"
                        }
                    ],
                    answer: "åœ¨ t = 2 ç§’æ—¶ï¼Œç‰©ä½“çš„ç¬æ—¶é€Ÿåº¦ä¸º 14 m/s"
                },
                tangent: {
                    title: "ğŸ“ åˆ‡çº¿æ–œç‡é—®é¢˜è§£ç­”",
                    steps: [
                        {
                            title: "æ­¥éª¤1: æ±‚å¯¼æ•°",
                            content: "f(x) = xÂ³ - 4x + 1ï¼Œæ±‚å¯¼å¾—åˆ°æ–œç‡å‡½æ•°",
                            formula: "f'(x) = 3xÂ² - 4"
                        },
                        {
                            title: "æ­¥éª¤2: è®¡ç®—ç‚¹(2,1)å¤„çš„æ–œç‡",
                            content: "ä»£å…¥ x = 2",
                            formula: "f'(2) = 3(2)Â² - 4 = 12 - 4 = 8"
                        },
                        {
                            title: "æ­¥éª¤3: å†™å‡ºåˆ‡çº¿æ–¹ç¨‹",
                            content: "ä½¿ç”¨ç‚¹æ–œå¼ï¼šy - yâ‚ = m(x - xâ‚)",
                            formula: "y - 1 = 8(x - 2)<br>y = 8x - 15"
                        }
                    ],
                    answer: "ç‚¹(2,1)å¤„çš„åˆ‡çº¿æ–¹ç¨‹ä¸º y = 8x - 15"
                },
                marginal: {
                    title: "ğŸ’° è¾¹é™…æˆæœ¬é—®é¢˜è§£ç­”",
                    steps: [
                        {
                            title: "æ­¥éª¤1: ç†è§£è¾¹é™…æˆæœ¬",
                            content: "è¾¹é™…æˆæœ¬ = æˆæœ¬å‡½æ•°çš„å¯¼æ•°<br>C(x) = 0.1xÂ² + 5x + 100"
                        },
                        {
                            title: "æ­¥éª¤2: æ±‚å¯¼æ•°",
                            content: "å¯¹æˆæœ¬å‡½æ•°æ±‚å¯¼",
                            formula: "C'(x) = 0.2x + 5"
                        },
                        {
                            title: "æ­¥éª¤3: è®¡ç®—x=100æ—¶çš„è¾¹é™…æˆæœ¬",
                            content: "ä»£å…¥ x = 100",
                            formula: "C'(100) = 0.2(100) + 5 = 20 + 5 = 25"
                        }
                    ],
                    answer: "ç”Ÿäº§ç¬¬100ä»¶äº§å“æ—¶çš„è¾¹é™…æˆæœ¬ä¸º 25 å…ƒ"
                },
                growth: {
                    title: "ğŸ“ˆ å¢é•¿ç‡é—®é¢˜è§£ç­”",
                    steps: [
                        {
                            title: "æ­¥éª¤1: ç†è§£å¢é•¿ç‡",
                            content: "ç¬æ—¶å¢é•¿ç‡ = äººå£å‡½æ•°çš„å¯¼æ•°<br>P(t) = 1000e^(0.05t)"
                        },
                        {
                            title: "æ­¥éª¤2: æ±‚å¯¼æ•°",
                            content: "ä½¿ç”¨æŒ‡æ•°å‡½æ•°æ±‚å¯¼æ³•åˆ™",
                            formula: "P'(t) = 1000 Ã— 0.05 Ã— e^(0.05t) = 50e^(0.05t)"
                        },
                        {
                            title: "æ­¥éª¤3: è§£é‡Šç»“æœ",
                            content: "P'(t) è¡¨ç¤ºåœ¨æ—¶åˆ» t çš„ç¬æ—¶å¢é•¿ç‡",
                            formula: "åœ¨ t = 0 æ—¶ï¼šP'(0) = 50 äºº/å¹´<br>åœ¨ t = 10 æ—¶ï¼šP'(10) = 50e^0.5 â‰ˆ 82.4 äºº/å¹´"
                        }
                    ],
                    answer: "äººå£çš„ç¬æ—¶å¢é•¿ç‡ä¸º P'(t) = 50e^(0.05t) äºº/å¹´"
                }
            };
            showSolutionModal(solutions[type]);
        }

        function showIntegralExample(type) {
            const solutions = {
                displacement: {
                    title: "ğŸš— ä½ç§»è®¡ç®—è§£ç­”",
                    steps: [
                        {
                            title: "æ­¥éª¤1: ç†è§£é—®é¢˜",
                            content: "å·²çŸ¥é€Ÿåº¦å‡½æ•° v(t) = 2t + 3ï¼Œæ±‚ 0 åˆ° 5 ç§’å†…çš„æ€»ä½ç§»<br>ä½ç§» = é€Ÿåº¦å‡½æ•°çš„ç§¯åˆ†"
                        },
                        {
                            title: "æ­¥éª¤2: è®¾ç½®ç§¯åˆ†",
                            content: "æ€»ä½ç§» = âˆ«â‚€âµ v(t) dt",
                            formula: "s = âˆ«â‚€âµ (2t + 3) dt"
                        },
                        {
                            title: "æ­¥éª¤3: è®¡ç®—ç§¯åˆ†",
                            content: "âˆ«(2t + 3)dt = tÂ² + 3t + C",
                            formula: "s = [tÂ² + 3t]â‚€âµ = (25 + 15) - (0 + 0) = 40"
                        }
                    ],
                    answer: "0 åˆ° 5 ç§’å†…çš„æ€»ä½ç§»ä¸º 40 ç±³"
                },
                area: {
                    title: "ğŸ“ é¢ç§¯è®¡ç®—è§£ç­”",
                    steps: [
                        {
                            title: "æ­¥éª¤1: æ‰¾åˆ°äº¤ç‚¹",
                            content: "y = xÂ² - 4 ä¸ x è½´çš„äº¤ç‚¹ï¼šxÂ² - 4 = 0",
                            formula: "x = Â±2ï¼Œäº¤ç‚¹ä¸º (-2,0) å’Œ (2,0)"
                        },
                        {
                            title: "æ­¥éª¤2: è®¾ç½®ç§¯åˆ†",
                            content: "ç”±äºæ›²çº¿åœ¨ x è½´ä¸‹æ–¹ï¼Œéœ€è¦å–ç»å¯¹å€¼",
                            formula: "é¢ç§¯ = âˆ«â‚‹â‚‚Â² |xÂ² - 4| dx = âˆ«â‚‹â‚‚Â² (4 - xÂ²) dx"
                        },
                        {
                            title: "æ­¥éª¤3: è®¡ç®—ç§¯åˆ†",
                            content: "âˆ«(4 - xÂ²)dx = 4x - xÂ³/3 + C",
                            formula: "é¢ç§¯ = [4x - xÂ³/3]â‚‹â‚‚Â² = (8 - 8/3) - (-8 + 8/3) = 32/3"
                        }
                    ],
                    answer: "æ›²çº¿ä¸ x è½´å›´æˆçš„é¢ç§¯ä¸º 32/3 â‰ˆ 10.67 å¹³æ–¹å•ä½"
                },
                work: {
                    title: "âš¡ åŠŸçš„è®¡ç®—è§£ç­”",
                    steps: [
                        {
                            title: "æ­¥éª¤1: ç†è§£åŠŸçš„å®šä¹‰",
                            content: "åŠŸ = âˆ« F(x) dxï¼Œå…¶ä¸­ F(x) = 10 - 2x"
                        },
                        {
                            title: "æ­¥éª¤2: è®¾ç½®ç§¯åˆ†",
                            content: "å¼¹ç°§ä» 0 æ‹‰ä¼¸åˆ° 3m",
                            formula: "W = âˆ«â‚€Â³ (10 - 2x) dx"
                        },
                        {
                            title: "æ­¥éª¤3: è®¡ç®—ç§¯åˆ†",
                            content: "âˆ«(10 - 2x)dx = 10x - xÂ² + C",
                            formula: "W = [10x - xÂ²]â‚€Â³ = (30 - 9) - 0 = 21"
                        }
                    ],
                    answer: "æ‹‰ä¼¸å¼¹ç°§æ‰€åšçš„åŠŸä¸º 21 ç„¦è€³"
                },
                volume: {
                    title: "ğŸº ä½“ç§¯è®¡ç®—è§£ç­”",
                    steps: [
                        {
                            title: "æ­¥éª¤1: æ—‹è½¬ä½“ä½“ç§¯å…¬å¼",
                            content: "ç»• x è½´æ—‹è½¬çš„ä½“ç§¯å…¬å¼ï¼šV = Ï€âˆ«[f(x)]Â² dx",
                            formula: "V = Ï€âˆ«â‚€â´ (âˆšx)Â² dx = Ï€âˆ«â‚€â´ x dx"
                        },
                        {
                            title: "æ­¥éª¤2: è®¡ç®—ç§¯åˆ†",
                            content: "âˆ«x dx = xÂ²/2 + C",
                            formula: "V = Ï€[xÂ²/2]â‚€â´ = Ï€(16/2 - 0) = 8Ï€"
                        }
                    ],
                    answer: "æ—‹è½¬ä½“çš„ä½“ç§¯ä¸º 8Ï€ â‰ˆ 25.13 ç«‹æ–¹å•ä½"
                },
                economics: {
                    title: "ğŸ’° æ¶ˆè´¹è€…å‰©ä½™è§£ç­”",
                    steps: [
                        {
                            title: "æ­¥éª¤1: ç†è§£æ¶ˆè´¹è€…å‰©ä½™",
                            content: "æ¶ˆè´¹è€…å‰©ä½™ = âˆ«â‚€^qâ‚€ D(q) dq - pâ‚€qâ‚€<br>å…¶ä¸­ D(p) = 100 - 2pï¼Œä»·æ ¼ pâ‚€ = 20"
                        },
                        {
                            title: "æ­¥éª¤2: æ±‚éœ€æ±‚é‡",
                            content: "å½“ p = 20 æ—¶ï¼Œqâ‚€ = 100 - 2(20) = 60",
                            formula: "éœ€æ±‚å‡½æ•°ï¼šp = 50 - q/2"
                        },
                        {
                            title: "æ­¥éª¤3: è®¡ç®—æ¶ˆè´¹è€…å‰©ä½™",
                            content: "CS = âˆ«â‚€â¶â° (50 - q/2) dq - 20Ã—60",
                            formula: "CS = [50q - qÂ²/4]â‚€â¶â° - 1200 = 1800 - 1200 = 600"
                        }
                    ],
                    answer: "æ¶ˆè´¹è€…å‰©ä½™ä¸º 600 å•ä½"
                },
                population: {
                    title: "ğŸ‘¥ äººå£å¢é•¿è§£ç­”",
                    steps: [
                        {
                            title: "æ­¥éª¤1: ç†è§£é—®é¢˜",
                            content: "å·²çŸ¥äººå£å¢é•¿ç‡ P'(t) = 50e^(0.02t)ï¼Œæ±‚ 10 å¹´å†…çš„äººå£å¢é•¿é‡"
                        },
                        {
                            title: "æ­¥éª¤2: è®¾ç½®ç§¯åˆ†",
                            content: "äººå£å¢é•¿é‡ = âˆ«â‚€Â¹â° P'(t) dt",
                            formula: "Î”P = âˆ«â‚€Â¹â° 50e^(0.02t) dt"
                        },
                        {
                            title: "æ­¥éª¤3: è®¡ç®—ç§¯åˆ†",
                            content: "âˆ«50e^(0.02t) dt = (50/0.02)e^(0.02t) + C = 2500e^(0.02t) + C",
                            formula: "Î”P = [2500e^(0.02t)]â‚€Â¹â° = 2500(e^0.2 - 1) â‰ˆ 553"
                        }
                    ],
                    answer: "10 å¹´å†…çš„äººå£å¢é•¿é‡çº¦ä¸º 553 äºº"
                }
            };
            showSolutionModal(solutions[type]);
        }

        function showSolutionModal(solution) {
            const modal = document.getElementById('solution-modal');
            const title = document.getElementById('solution-title');
            const steps = document.getElementById('solution-steps');
            
            title.textContent = solution.title;
            
            let stepsHTML = '';
            solution.steps.forEach(step => {
                stepsHTML += `
                    <div class="solution-step">
                        <h4>${step.title}</h4>
                        <p>${step.content}</p>
                        ${step.formula ? `<div class="solution-formula">${step.formula}</div>` : ''}
                    </div>
                `;
            });
            
            stepsHTML += `
                <div class="solution-answer">
                    <h4>æœ€ç»ˆç­”æ¡ˆ</h4>
                    <p>${solution.answer}</p>
                </div>
            `;
            
            steps.innerHTML = stepsHTML;
            modal.style.display = 'flex';
        }

        function closeSolutionModal() {
            document.getElementById('solution-modal').style.display = 'none';
        }

        // Close modal when clicking outside
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('solution-modal');
            if (event.target === modal) {
                closeSolutionModal();
            }
        });

        // Example loading functions (kept for compatibility)
        function loadDerivativeExample(type) {
            document.getElementById('derivative-function-type').value = type;
            updateDerivativeDemo();
        }

        function loadIntegralExample(type) {
            // Set appropriate function for the example
            switch(type) {
                case 'area':
                    document.getElementById('integral-function').value = 'quadratic';
                    document.getElementById('integral-lower').value = 0;
                    document.getElementById('integral-upper').value = 2;
                    break;
                case 'volume':
                    document.getElementById('integral-function').value = 'quadratic';
                    break;
            }
            updateIntegralDemo();
        }

        function loadApplicationExample(type) {
            document.getElementById('optimization-type').value = 'box';
            updateOptimizationDemo();
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize the first demo
            updateDerivativeDemo();
        });
    </script>
</body>
</html> 