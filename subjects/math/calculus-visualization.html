<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¾®ç§¯åˆ†å¯è§†åŒ– - æ•°å­¦å­¦ä¹ åŠ©æ‰‹</title>
    <link rel="icon" href="assets/icons/alex.ico" type="image/x-icon">
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../../css/components.css">
    <link rel="stylesheet" href="../../css/utilities.css">
    <link rel="stylesheet" href="../../css/responsive.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .calculus-workspace {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .tool-tabs {
            background: #f8f9fa;
            padding: 0;
            border-bottom: 2px solid #e9ecef;
            display: flex;
            overflow-x: auto;
        }

        .tab-btn {
            padding: 15px 25px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            color: #495057;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab-btn:hover {
            background: #e9ecef;
            color: #007bff;
        }

        .tab-btn.active {
            color: #007bff;
            border-bottom-color: #007bff;
            background: white;
        }

        .tool-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .tool-section {
            display: none;
        }

        .tool-section.active {
            display: block;
        }

        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.9);
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .back-btn:hover {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        /* Learning Section Styles */
        .learning-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
        }

        .learning-section h3 {
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .concept-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .concept-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 1.5rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .concept-card:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-5px);
        }

        .concept-card h4 {
            margin-bottom: 0.5rem;
            color: #fff;
        }

        .concept-card p {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Interactive Demo Styles */
        .interactive-demo {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1rem 0;
            border: 2px solid #e9ecef;
        }

        .demo-controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .demo-slider {
            flex: 1;
            min-width: 150px;
        }

        .demo-slider label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .demo-slider input[type="range"] {
            width: 100%;
            margin-bottom: 0.5rem;
        }

        .demo-value {
            text-align: center;
            font-weight: bold;
            color: #007bff;
        }

        .visual-equation {
            background: white;
            border: 2px solid #007bff;
            border-radius: 10px;
            padding: 1.5rem;
            text-align: center;
            font-size: 1.5rem;
            font-family: 'Times New Roman', serif;
            margin: 1rem 0;
        }

        .graph-container {
            background: white;
            border-radius: 10px;
            padding: 1rem;
            margin: 1rem 0;
            border: 2px solid #e9ecef;
            min-height: 400px;
            position: relative;
        }

        .canvas-container {
            width: 100%;
            height: 350px;
            position: relative;
        }

        #calculusCanvas {
            border: 1px solid #ddd;
            border-radius: 8px;
            width: 100%;
            height: 100%;
        }

        /* Real World Examples */
        .real-world-examples {
            background: #e8f5e8;
            border: 2px solid #c3e6cb;
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .real-world-examples h4 {
            color: #155724;
            margin-bottom: 1rem;
        }

        .example-scenario {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-left: 4px solid #28a745;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .scenario-title {
            font-weight: 600;
            color: #155724;
            margin-bottom: 0.8rem;
            font-size: 1.1rem;
        }

        .scenario-description {
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 1rem;
        }

        .scenario-math {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            border-left: 3px solid #007bff;
            margin: 0.5rem 0;
        }

        .scenario-result {
            background: #d4edda;
            padding: 0.8rem;
            border-radius: 6px;
            color: #155724;
            font-weight: 600;
            margin-top: 0.5rem;
        }

        /* Application Cards */
        .application-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 1.5rem 0;
        }

        .application-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border-left: 4px solid #007bff;
            transition: all 0.3s ease;
        }

        .application-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.15);
        }

        .application-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            text-align: center;
        }

        .application-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #007bff;
            margin-bottom: 0.8rem;
        }

        .application-description {
            font-size: 0.95rem;
            line-height: 1.5;
            color: #666;
        }

        /* Input Controls */
        .input-group {
            margin-bottom: 1rem;
        }

        .input-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #495057;
        }

        .input-field {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .input-field:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: #007bff;
            color: white;
        }

        .btn-primary:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #545b62;
        }

        /* Tips Section */
        .tips-section {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .tips-section h4 {
            color: #856404;
            margin-bottom: 1rem;
        }

        .tip-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 0.8rem;
            gap: 0.5rem;
        }

        .tip-icon {
            background: #ffc107;
            color: #856404;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            flex-shrink: 0;
            margin-top: 2px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .tool-tabs {
                flex-direction: column;
            }

            .tab-btn {
                text-align: center;
                border-bottom: 1px solid #e9ecef;
                border-right: none;
            }

            .tab-btn.active {
                border-bottom: 1px solid #007bff;
                border-right: none;
            }

            .tool-content {
                padding: 20px;
            }

            .concept-cards {
                grid-template-columns: 1fr;
            }

            .demo-controls {
                flex-direction: column;
            }

            .demo-slider {
                min-width: auto;
            }

            .visual-equation {
                font-size: 1.2rem;
            }

            .learning-section {
                padding: 1.5rem;
            }

            .application-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.5rem;
            }

            .header p {
                font-size: 0.9rem;
            }

            .visual-equation {
                font-size: 1rem;
                padding: 1rem;
            }

            .learning-section {
                padding: 1rem;
            }

            .concept-card {
                padding: 1rem;
            }

            .interactive-demo {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <button class="back-btn" onclick="window.location.href='main.html'">â† è¿”å›æ•°å­¦ä¸»é¡µ</button>
    
    <div class="container">
        <div class="header">
            <h1>âˆ å¾®ç§¯åˆ†å¯è§†åŒ–</h1>
            <p>æ¢ç´¢å¯¼æ•°å’Œç§¯åˆ†çš„å¥¥ç§˜ - å‘ç°å¾®ç§¯åˆ†åœ¨ç”Ÿæ´»å’Œå·¥ä½œä¸­çš„å®é™…åº”ç”¨</p>
        </div>

        <div class="calculus-workspace">
            <div class="tool-tabs">
                <button class="tab-btn active" data-tab="derivatives">
                    <span>ğŸ“ˆ</span> å¯¼æ•°å¯è§†åŒ–
                </button>
                <button class="tab-btn" data-tab="integrals">
                    <span>ğŸ“Š</span> ç§¯åˆ†å¯è§†åŒ–
                </button>
                <button class="tab-btn" data-tab="applications">
                    <span>ğŸŒ</span> å®é™…åº”ç”¨
                </button>
                <button class="tab-btn" data-tab="interactive">
                    <span>ğŸ®</span> äº¤äº’å¼æ¢ç´¢
                </button>
            </div>

            <div class="tool-content">
                <!-- å¯¼æ•°å¯è§†åŒ– -->
                <div class="tool-section active" id="derivatives">
                    <h3>å¯¼æ•°ï¼šå˜åŒ–ç‡çš„å¯è§†åŒ–</h3>
                    
                    <!-- Learning Section -->
                    <div class="learning-section">
                        <h3>ğŸ“ å¯¼æ•°åŸºç¡€æ¦‚å¿µ</h3>
                        <p>å¯¼æ•°æè¿°å‡½æ•°åœ¨æŸä¸€ç‚¹çš„ç¬æ—¶å˜åŒ–ç‡ï¼Œæ˜¯å¾®ç§¯åˆ†çš„æ ¸å¿ƒæ¦‚å¿µä¹‹ä¸€ã€‚</p>
                        <div class="concept-cards">
                            <div class="concept-card">
                                <h4>å‡ ä½•æ„ä¹‰</h4>
                                <p>å¯¼æ•°è¡¨ç¤ºå‡½æ•°å›¾åƒåœ¨æŸç‚¹çš„åˆ‡çº¿æ–œç‡ï¼Œåæ˜ å‡½æ•°åœ¨è¯¥ç‚¹çš„å˜åŒ–è¶‹åŠ¿ã€‚</p>
                            </div>
                            <div class="concept-card">
                                <h4>ç‰©ç†æ„ä¹‰</h4>
                                <p>ä½ç§»å¯¹æ—¶é—´çš„å¯¼æ•°æ˜¯é€Ÿåº¦ï¼Œé€Ÿåº¦å¯¹æ—¶é—´çš„å¯¼æ•°æ˜¯åŠ é€Ÿåº¦ã€‚</p>
                            </div>
                            <div class="concept-card">
                                <h4>ç»æµæ„ä¹‰</h4>
                                <p>æˆæœ¬å‡½æ•°çš„å¯¼æ•°æ˜¯è¾¹é™…æˆæœ¬ï¼Œæ”¶ç›Šå‡½æ•°çš„å¯¼æ•°æ˜¯è¾¹é™…æ”¶ç›Šã€‚</p>
                            </div>
                            <div class="concept-card">
                                <h4>ä¼˜åŒ–åº”ç”¨</h4>
                                <p>é€šè¿‡æ±‚å¯¼æ•°ä¸ºé›¶çš„ç‚¹ï¼Œå¯ä»¥æ‰¾åˆ°å‡½æ•°çš„æå€¼ï¼Œè§£å†³æœ€ä¼˜åŒ–é—®é¢˜ã€‚</p>
                            </div>
                        </div>
                    </div>

                    <!-- Interactive Demo -->
                    <div class="interactive-demo">
                        <h4>ğŸ® å¯¼æ•°äº¤äº’æ¼”ç¤º</h4>
                        <p>è°ƒæ•´å‚æ•°è§‚å¯Ÿå‡½æ•° f(x) = axÂ³ + bxÂ² + cx + d åŠå…¶å¯¼æ•°çš„å˜åŒ–</p>
                        <div class="demo-controls">
                            <div class="demo-slider">
                                <label>ç³»æ•° a:</label>
                                <input type="range" id="deriv-a" min="-2" max="2" value="1" step="0.1" oninput="updateDerivativeDemo()">
                                <div class="demo-value" id="deriv-value-a">1</div>
                            </div>
                            <div class="demo-slider">
                                <label>ç³»æ•° b:</label>
                                <input type="range" id="deriv-b" min="-5" max="5" value="0" step="0.1" oninput="updateDerivativeDemo()">
                                <div class="demo-value" id="deriv-value-b">0</div>
                            </div>
                            <div class="demo-slider">
                                <label>ç³»æ•° c:</label>
                                <input type="range" id="deriv-c" min="-5" max="5" value="0" step="0.1" oninput="updateDerivativeDemo()">
                                <div class="demo-value" id="deriv-value-c">0</div>
                            </div>
                            <div class="demo-slider">
                                <label>ç³»æ•° d:</label>
                                <input type="range" id="deriv-d" min="-5" max="5" value="0" step="0.1" oninput="updateDerivativeDemo()">
                                <div class="demo-value" id="deriv-value-d">0</div>
                            </div>
                        </div>
                        <div class="visual-equation" id="deriv-function">f(x) = xÂ³</div>
                        <div class="visual-equation" id="deriv-derivative">f'(x) = 3xÂ²</div>
                        <div class="graph-container">
                            <div class="canvas-container">
                                <canvas id="derivativeCanvas"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Real World Examples -->
                    <div class="real-world-examples">
                        <h4>ğŸŒ å¯¼æ•°åœ¨ç”Ÿæ´»ä¸­çš„åº”ç”¨</h4>
                        
                        <div class="example-scenario">
                            <div class="scenario-title">ğŸš— æ±½è½¦è¡Œé©¶åˆ†æ</div>
                            <div class="scenario-description">
                                ä¸€è¾†æ±½è½¦çš„ä½ç§»å‡½æ•°ä¸º s(t) = 2tÂ³ - 9tÂ² + 12tï¼Œå…¶ä¸­ t æ˜¯æ—¶é—´ï¼ˆç§’ï¼‰ï¼Œs æ˜¯ä½ç§»ï¼ˆç±³ï¼‰ã€‚
                            </div>
                            <div class="scenario-math">
                                é€Ÿåº¦å‡½æ•°ï¼šv(t) = s'(t) = 6tÂ² - 18t + 12<br>
                                åŠ é€Ÿåº¦å‡½æ•°ï¼ša(t) = v'(t) = 12t - 18
                            </div>
                            <div class="scenario-result">
                                åº”ç”¨ï¼šé€šè¿‡å¯¼æ•°å¯ä»¥åˆ†ææ±½è½¦åœ¨ä»»æ„æ—¶åˆ»çš„é€Ÿåº¦å’ŒåŠ é€Ÿåº¦ï¼Œå¸®åŠ©ä¼˜åŒ–é©¾é©¶ç­–ç•¥ã€‚
                            </div>
                        </div>

                        <div class="example-scenario">
                            <div class="scenario-title">ğŸ’° åˆ©æ¶¦æœ€å¤§åŒ–</div>
                            <div class="scenario-description">
                                æŸå…¬å¸çš„åˆ©æ¶¦å‡½æ•°ä¸º P(x) = -2xÂ² + 100x - 800ï¼Œå…¶ä¸­ x æ˜¯äº§é‡ï¼ˆä»¶ï¼‰ã€‚
                            </div>
                            <div class="scenario-math">
                                è¾¹é™…åˆ©æ¶¦ï¼šP'(x) = -4x + 100<br>
                                ä»¤ P'(x) = 0ï¼š-4x + 100 = 0ï¼Œè§£å¾— x = 25
                            </div>
                            <div class="scenario-result">
                                ç»“è®ºï¼šå½“äº§é‡ä¸º25ä»¶æ—¶ï¼Œåˆ©æ¶¦è¾¾åˆ°æœ€å¤§å€¼1450å…ƒã€‚
                            </div>
                        </div>

                        <div class="example-scenario">
                            <div class="scenario-title">ğŸŒ¡ï¸ æ¸©åº¦å˜åŒ–ç‡</div>
                            <div class="scenario-description">
                                æŸåœ°ä¸€å¤©çš„æ¸©åº¦å‡½æ•°ä¸º T(t) = -0.5tÂ² + 6t + 10ï¼Œå…¶ä¸­ t æ˜¯æ—¶é—´ï¼ˆå°æ—¶ï¼‰ï¼ŒT æ˜¯æ¸©åº¦ï¼ˆÂ°Cï¼‰ã€‚
                            </div>
                            <div class="scenario-math">
                                æ¸©åº¦å˜åŒ–ç‡ï¼šT'(t) = -t + 6<br>
                                æœ€é«˜æ¸©åº¦æ—¶åˆ»ï¼šT'(t) = 0ï¼Œå¾— t = 6å°æ—¶
                            </div>
                            <div class="scenario-result">
                                åº”ç”¨ï¼šé¢„æµ‹æ¸©åº¦å˜åŒ–è¶‹åŠ¿ï¼Œä¸ºå†œä¸šç”Ÿäº§å’Œæ—¥å¸¸ç”Ÿæ´»æä¾›æŒ‡å¯¼ã€‚
                            </div>
                        </div>
                    </div>

                    <!-- Tips Section -->
                    <div class="tips-section">
                        <h4>ğŸ’¡ å¯¼æ•°å­¦ä¹ æŠ€å·§</h4>
                        <div class="tip-item">
                            <div class="tip-icon">1</div>
                            <div>ç†è§£å¯¼æ•°çš„å‡ ä½•æ„ä¹‰ï¼šåˆ‡çº¿æ–œç‡åæ˜ å‡½æ•°çš„å˜åŒ–è¶‹åŠ¿</div>
                        </div>
                        <div class="tip-item">
                            <div class="tip-icon">2</div>
                            <div>æŒæ¡åŸºæœ¬æ±‚å¯¼æ³•åˆ™ï¼šå¹‚å‡½æ•°ã€æŒ‡æ•°å‡½æ•°ã€å¯¹æ•°å‡½æ•°çš„å¯¼æ•°å…¬å¼</div>
                        </div>
                        <div class="tip-item">
                            <div class="tip-icon">3</div>
                            <div>å­¦ä¼šé“¾å¼æ³•åˆ™ï¼šå¤åˆå‡½æ•°æ±‚å¯¼çš„å…³é”®å·¥å…·</div>
                        </div>
                        <div class="tip-item">
                            <div class="tip-icon">4</div>
                            <div>åº”ç”¨å¯¼æ•°è§£å†³å®é™…é—®é¢˜ï¼šæœ€å€¼é—®é¢˜ã€å˜åŒ–ç‡é—®é¢˜</div>
                        </div>
                        <div class="tip-item">
                            <div class="tip-icon">5</div>
                            <div>é€šè¿‡å›¾åƒç†è§£ï¼šè§‚å¯Ÿå‡½æ•°å›¾åƒä¸å¯¼æ•°å›¾åƒçš„å…³ç³»</div>
                        </div>
                    </div>
                </div>

                <!-- ç§¯åˆ†å¯è§†åŒ– -->
                <div class="tool-section" id="integrals">
                    <h3>ç§¯åˆ†ï¼šé¢ç§¯ä¸ç´¯ç§¯çš„å¯è§†åŒ–</h3>
                    
                    <!-- Learning Section -->
                    <div class="learning-section">
                        <h3>ğŸ“ ç§¯åˆ†åŸºç¡€æ¦‚å¿µ</h3>
                        <p>ç§¯åˆ†æ˜¯å¯¼æ•°çš„é€†è¿ç®—ï¼Œç”¨äºè®¡ç®—æ›²çº¿ä¸‹çš„é¢ç§¯å’Œç´¯ç§¯é‡ã€‚</p>
                        <div class="concept-cards">
                            <div class="concept-card">
                                <h4>å‡ ä½•æ„ä¹‰</h4>
                                <p>å®šç§¯åˆ†è¡¨ç¤ºå‡½æ•°å›¾åƒä¸xè½´ä¹‹é—´çš„æœ‰å‘é¢ç§¯ã€‚</p>
                            </div>
                            <div class="concept-card">
                                <h4>ç‰©ç†æ„ä¹‰</h4>
                                <p>é€Ÿåº¦çš„ç§¯åˆ†æ˜¯ä½ç§»ï¼ŒåŠ é€Ÿåº¦çš„ç§¯åˆ†æ˜¯é€Ÿåº¦å˜åŒ–é‡ã€‚</p>
                            </div>
                            <div class="concept-card">
                                <h4>ç»æµæ„ä¹‰</h4>
                                <p>è¾¹é™…æˆæœ¬çš„ç§¯åˆ†æ˜¯æ€»æˆæœ¬å¢é‡ï¼Œè¾¹é™…æ”¶ç›Šçš„ç§¯åˆ†æ˜¯æ€»æ”¶ç›Šå¢é‡ã€‚</p>
                            </div>
                            <div class="concept-card">
                                <h4>ç´¯ç§¯åº”ç”¨</h4>
                                <p>è®¡ç®—æ€»é‡ã€å¹³å‡å€¼ã€æ¦‚ç‡ç­‰ç´¯ç§¯æ€§è´¨çš„é—®é¢˜ã€‚</p>
                            </div>
                        </div>
                    </div>

                    <!-- Interactive Demo -->
                    <div class="interactive-demo">
                        <h4>ğŸ® ç§¯åˆ†äº¤äº’æ¼”ç¤º</h4>
                        <p>è§‚å¯Ÿå‡½æ•° f(x) = axÂ² + bx + c åœ¨åŒºé—´ [m, n] ä¸Šçš„å®šç§¯åˆ†</p>
                        <div class="demo-controls">
                            <div class="demo-slider">
                                <label>ç³»æ•° a:</label>
                                <input type="range" id="int-a" min="0.1" max="3" value="1" step="0.1" oninput="updateIntegralDemo()">
                                <div class="demo-value" id="int-value-a">1</div>
                            </div>
                            <div class="demo-slider">
                                <label>ç³»æ•° b:</label>
                                <input type="range" id="int-b" min="-3" max="3" value="0" step="0.1" oninput="updateIntegralDemo()">
                                <div class="demo-value" id="int-value-b">0</div>
                            </div>
                            <div class="demo-slider">
                                <label>ç³»æ•° c:</label>
                                <input type="range" id="int-c" min="-3" max="3" value="0" step="0.1" oninput="updateIntegralDemo()">
                                <div class="demo-value" id="int-value-c">0</div>
                            </div>
                            <div class="demo-slider">
                                <label>ç§¯åˆ†ä¸‹é™:</label>
                                <input type="range" id="int-lower" min="-3" max="1" value="-1" step="0.1" oninput="updateIntegralDemo()">
                                <div class="demo-value" id="int-value-lower">-1</div>
                            </div>
                            <div class="demo-slider">
                                <label>ç§¯åˆ†ä¸Šé™:</label>
                                <input type="range" id="int-upper" min="1" max="3" value="2" step="0.1" oninput="updateIntegralDemo()">
                                <div class="demo-value" id="int-value-upper">2</div>
                            </div>
                        </div>
                        <div class="visual-equation" id="int-function">f(x) = xÂ²</div>
                        <div class="visual-equation" id="int-result">âˆ«â‚‹â‚Â² xÂ² dx = 3</div>
                        <div class="graph-container">
                            <div class="canvas-container">
                                <canvas id="integralCanvas"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Real World Examples -->
                    <div class="real-world-examples">
                        <h4>ğŸŒ ç§¯åˆ†åœ¨ç”Ÿæ´»ä¸­çš„åº”ç”¨</h4>
                        
                        <div class="example-scenario">
                            <div class="scenario-title">âš¡ ç”µåŠ›æ¶ˆè€—è®¡ç®—</div>
                            <div class="scenario-description">
                                æŸå·¥å‚çš„åŠŸç‡æ¶ˆè€—å‡½æ•°ä¸º P(t) = 100 + 50sin(Ï€t/12)ï¼Œå…¶ä¸­ t æ˜¯æ—¶é—´ï¼ˆå°æ—¶ï¼‰ï¼ŒP æ˜¯åŠŸç‡ï¼ˆåƒç“¦ï¼‰ã€‚
                            </div>
                            <div class="scenario-math">
                                24å°æ—¶æ€»è€—ç”µé‡ï¼šâˆ«â‚€Â²â´ P(t) dt = âˆ«â‚€Â²â´ (100 + 50sin(Ï€t/12)) dt<br>
                                = [100t - (600/Ï€)cos(Ï€t/12)]â‚€Â²â´ = 2400 åƒç“¦æ—¶
                            </div>
                            <div class="scenario-result">
                                åº”ç”¨ï¼šè®¡ç®—æ€»ç”µåŠ›æ¶ˆè€—ï¼Œåˆ¶å®šç”¨ç”µè®¡åˆ’å’Œæˆæœ¬é¢„ç®—ã€‚
                            </div>
                        </div>

                        <div class="example-scenario">
                            <div class="scenario-title">ğŸŒŠ æ°´æµé‡è®¡ç®—</div>
                            <div class="scenario-description">
                                æ²³æµçš„æµé€Ÿå‡½æ•°ä¸º v(x) = 4 - xÂ²/25ï¼Œå…¶ä¸­ x æ˜¯è·ç¦»æ²³å²¸çš„è·ç¦»ï¼ˆç±³ï¼‰ï¼Œæ²³å®½ä¸º10ç±³ã€‚
                            </div>
                            <div class="scenario-math">
                                æ€»æµé‡ï¼šQ = âˆ«â‚€Â¹â° v(x) dx = âˆ«â‚€Â¹â° (4 - xÂ²/25) dx<br>
                                = [4x - xÂ³/75]â‚€Â¹â° = 40 - 1000/75 â‰ˆ 26.67 ç«‹æ–¹ç±³/ç§’
                            </div>
                            <div class="scenario-result">
                                åº”ç”¨ï¼šæ°´åˆ©å·¥ç¨‹è®¾è®¡ã€æ´ªæ°´é¢„è­¦ã€æ°´èµ„æºç®¡ç†ã€‚
                            </div>
                        </div>

                        <div class="example-scenario">
                            <div class="scenario-title">ğŸ“ˆ æŠ•èµ„æ”¶ç›Šç´¯ç§¯</div>
                            <div class="scenario-description">
                                æŸæŠ•èµ„çš„æ”¶ç›Šç‡å‡½æ•°ä¸º r(t) = 0.05 + 0.02tï¼Œå…¶ä¸­ t æ˜¯æŠ•èµ„å¹´æ•°ã€‚
                            </div>
                            <div class="scenario-math">
                                5å¹´æ€»æ”¶ç›Šç‡ï¼šâˆ«â‚€âµ r(t) dt = âˆ«â‚€âµ (0.05 + 0.02t) dt<br>
                                = [0.05t + 0.01tÂ²]â‚€âµ = 0.25 + 0.25 = 0.5 (50%)
                            </div>
                            <div class="scenario-result">
                                åº”ç”¨ï¼šæŠ•èµ„è§„åˆ’ã€é£é™©è¯„ä¼°ã€è´¢åŠ¡é¢„æµ‹ã€‚
                            </div>
                        </div>
                    </div>

                    <!-- Tips Section -->
                    <div class="tips-section">
                        <h4>ğŸ’¡ ç§¯åˆ†å­¦ä¹ æŠ€å·§</h4>
                        <div class="tip-item">
                            <div class="tip-icon">1</div>
                            <div>ç†è§£ç§¯åˆ†çš„å‡ ä½•æ„ä¹‰ï¼šé¢ç§¯çš„ç´¯ç§¯</div>
                        </div>
                        <div class="tip-item">
                            <div class="tip-icon">2</div>
                            <div>æŒæ¡åŸºæœ¬ç§¯åˆ†å…¬å¼ï¼šå¹‚å‡½æ•°ã€ä¸‰è§’å‡½æ•°ã€æŒ‡æ•°å‡½æ•°çš„ç§¯åˆ†</div>
                        </div>
                        <div class="tip-item">
                            <div class="tip-icon">3</div>
                            <div>å­¦ä¼šæ¢å…ƒç§¯åˆ†æ³•å’Œåˆ†éƒ¨ç§¯åˆ†æ³•</div>
                        </div>
                        <div class="tip-item">
                            <div class="tip-icon">4</div>
                            <div>ç†è§£å®šç§¯åˆ†ä¸ä¸å®šç§¯åˆ†çš„åŒºåˆ«å’Œè”ç³»</div>
                        </div>
                        <div class="tip-item">
                            <div class="tip-icon">5</div>
                            <div>åº”ç”¨ç§¯åˆ†è§£å†³å®é™…é—®é¢˜ï¼šé¢ç§¯ã€ä½“ç§¯ã€ç‰©ç†é‡è®¡ç®—</div>
                        </div>
                    </div>
                </div>

                <!-- å®é™…åº”ç”¨ -->
                <div class="tool-section" id="applications">
                    <h3>å¾®ç§¯åˆ†åœ¨å„è¡Œä¸šçš„å®é™…åº”ç”¨</h3>
                    
                    <div class="learning-section">
                        <h3>ğŸŒŸ å¾®ç§¯åˆ†æ”¹å˜ä¸–ç•Œ</h3>
                        <p>å¾®ç§¯åˆ†ä¸ä»…æ˜¯æ•°å­¦å·¥å…·ï¼Œæ›´æ˜¯ç°ä»£ç§‘æŠ€å’Œå·¥ä¸šå‘å±•çš„åŸºçŸ³ã€‚ä»æ‰‹æœºåˆ°ç«ç®­ï¼Œä»ç»æµé¢„æµ‹åˆ°åŒ»å­¦è¯Šæ–­ï¼Œå¾®ç§¯åˆ†æ— å¤„ä¸åœ¨ã€‚</p>
                    </div>

                    <div class="application-grid">
                        <div class="application-card">
                            <div class="application-icon">ğŸš€</div>
                            <div class="application-title">èˆªç©ºèˆªå¤©å·¥ç¨‹</div>
                            <div class="application-description">
                                <strong>è½¨é“è®¡ç®—ï¼š</strong>ä½¿ç”¨å¾®åˆ†æ–¹ç¨‹è®¡ç®—å«æ˜Ÿè½¨é“å’Œç«ç®­å‘å°„è½¨è¿¹ã€‚<br>
                                <strong>ç‡ƒæ–™ä¼˜åŒ–ï¼š</strong>é€šè¿‡ç§¯åˆ†è®¡ç®—æœ€ä¼˜ç‡ƒæ–™æ¶ˆè€—ç­–ç•¥ã€‚<br>
                                <strong>å®ä¾‹ï¼š</strong>SpaceXä½¿ç”¨å¾®ç§¯åˆ†ä¼˜åŒ–ç«ç®­å›æ”¶ç€é™†è½¨è¿¹ã€‚
                            </div>
                        </div>

                        <div class="application-card">
                            <div class="application-icon">ğŸ¥</div>
                            <div class="application-title">åŒ»å­¦ä¸ç”Ÿç‰©å­¦</div>
                            <div class="application-description">
                                <strong>è¯ç‰©æµ“åº¦ï¼š</strong>ç”¨å¾®åˆ†æ–¹ç¨‹æ¨¡æ‹Ÿè¯ç‰©åœ¨ä½“å†…çš„ä»£è°¢è¿‡ç¨‹ã€‚<br>
                                <strong>å¿ƒç”µå›¾åˆ†æï¼š</strong>é€šè¿‡å¯¼æ•°åˆ†æå¿ƒç‡å˜åŒ–ã€‚<br>
                                <strong>å®ä¾‹ï¼š</strong>èƒ°å²›ç´ æ³µä½¿ç”¨å¾®ç§¯åˆ†æ§åˆ¶è¡€ç³–æ°´å¹³ã€‚
                            </div>
                        </div>

                        <div class="application-card">
                            <div class="application-icon">ğŸ’¹</div>
                            <div class="application-title">é‡‘èä¸ç»æµ</div>
                            <div class="application-description">
                                <strong>æœŸæƒå®šä»·ï¼š</strong>Black-Scholesæ¨¡å‹ä½¿ç”¨åå¾®åˆ†æ–¹ç¨‹ã€‚<br>
                                <strong>é£é™©ç®¡ç†ï¼š</strong>é€šè¿‡ç§¯åˆ†è®¡ç®—æŠ•èµ„ç»„åˆé£é™©ã€‚<br>
                                <strong>å®ä¾‹ï¼š</strong>é«˜é¢‘äº¤æ˜“ç®—æ³•ä½¿ç”¨å¾®ç§¯åˆ†é¢„æµ‹ä»·æ ¼å˜åŒ–ã€‚
                            </div>
                        </div>

                        <div class="application-card">
                            <div class="application-icon">ğŸ¤–</div>
                            <div class="application-title">äººå·¥æ™ºèƒ½</div>
                            <div class="application-description">
                                <strong>ç¥ç»ç½‘ç»œï¼š</strong>åå‘ä¼ æ’­ç®—æ³•åŸºäºé“¾å¼æ³•åˆ™ã€‚<br>
                                <strong>ä¼˜åŒ–ç®—æ³•ï¼š</strong>æ¢¯åº¦ä¸‹é™ä½¿ç”¨å¯¼æ•°å¯»æ‰¾æœ€ä¼˜è§£ã€‚<br>
                                <strong>å®ä¾‹ï¼š</strong>ChatGPTçš„è®­ç»ƒè¿‡ç¨‹å¤§é‡ä½¿ç”¨å¾®ç§¯åˆ†ä¼˜åŒ–ã€‚
                            </div>
                        </div>

                        <div class="application-card">
                            <div class="application-icon">ğŸ—ï¸</div>
                            <div class="application-title">å»ºç­‘ä¸å·¥ç¨‹</div>
                            <div class="application-description">
                                <strong>ç»“æ„åˆ†æï¼š</strong>ä½¿ç”¨å¾®åˆ†æ–¹ç¨‹åˆ†æå»ºç­‘ç‰©å—åŠ›ã€‚<br>
                                <strong>ææ–™ä¼˜åŒ–ï¼š</strong>é€šè¿‡ç§¯åˆ†è®¡ç®—æœ€ä¼˜ææ–™åˆ†å¸ƒã€‚<br>
                                <strong>å®ä¾‹ï¼š</strong>æ¡¥æ¢è®¾è®¡ä¸­çš„æ‚¬ç´¢æ›²çº¿è®¡ç®—ã€‚
                            </div>
                        </div>

                        <div class="application-card">
                            <div class="application-icon">ğŸŒ</div>
                            <div class="application-title">ç¯å¢ƒç§‘å­¦</div>
                            <div class="application-description">
                                <strong>æ±¡æŸ“æ‰©æ•£ï¼š</strong>ç”¨å¾®åˆ†æ–¹ç¨‹æ¨¡æ‹Ÿæ±¡æŸ“ç‰©ä¼ æ’­ã€‚<br>
                                <strong>æ°”å€™å»ºæ¨¡ï¼š</strong>é€šè¿‡ç§¯åˆ†è®¡ç®—å…¨çƒæ¸©åº¦å˜åŒ–ã€‚<br>
                                <strong>å®ä¾‹ï¼š</strong>ç¢³æ’æ”¾é‡çš„ç´¯ç§¯è®¡ç®—å’Œé¢„æµ‹ã€‚
                            </div>
                        </div>
                    </div>

                    <!-- Detailed Case Studies -->
                    <div class="real-world-examples">
                        <h4>ğŸ“‹ è¯¦ç»†æ¡ˆä¾‹åˆ†æ</h4>
                        
                        <div class="example-scenario">
                            <div class="scenario-title">ğŸ“± æ™ºèƒ½æ‰‹æœºç”µæ± ä¼˜åŒ–</div>
                            <div class="scenario-description">
                                ç°ä»£æ™ºèƒ½æ‰‹æœºä½¿ç”¨å¾®ç§¯åˆ†ä¼˜åŒ–ç”µæ± ä½¿ç”¨æ•ˆç‡ã€‚ç”µæ± ç”µé‡æ¶ˆè€—å‡½æ•°ä¸º P(t) = Pâ‚€e^(-kt)ï¼Œå…¶ä¸­ k å–å†³äºä½¿ç”¨å¼ºåº¦ã€‚
                            </div>
                            <div class="scenario-math">
                                å‰©ä½™ç”µé‡ï¼šQ(t) = âˆ«â‚€áµ— P(Ï„) dÏ„ = Pâ‚€/k (1 - e^(-kt))<br>
                                ä¼˜åŒ–ç­–ç•¥ï¼šé€šè¿‡è°ƒæ•´ k å€¼ï¼ˆé™ä½CPUé¢‘ç‡ã€è°ƒæš—å±å¹•ï¼‰å»¶é•¿ä½¿ç”¨æ—¶é—´
                            </div>
                            <div class="scenario-result">
                                å®é™…åº”ç”¨ï¼šiPhoneçš„ä½ç”µé‡æ¨¡å¼ã€Androidçš„è‡ªé€‚åº”ç”µæ± ç®¡ç†éƒ½åŸºäºè¿™äº›æ•°å­¦æ¨¡å‹ã€‚
                            </div>
                        </div>

                        <div class="example-scenario">
                            <div class="scenario-title">ğŸš— è‡ªåŠ¨é©¾é©¶æ±½è½¦</div>
                            <div class="scenario-description">
                                è‡ªåŠ¨é©¾é©¶æ±½è½¦éœ€è¦å®æ—¶è®¡ç®—æœ€ä¼˜è¡Œé©¶è·¯å¾„ã€‚è·¯å¾„è§„åˆ’ä½¿ç”¨å˜åˆ†æ³•ï¼ˆå¾®ç§¯åˆ†çš„é«˜çº§åº”ç”¨ï¼‰ã€‚
                            </div>
                            <div class="scenario-math">
                                æœ€ä¼˜è·¯å¾„ï¼šæœ€å°åŒ– âˆ«áµ—Â¹áµ—Â² [Â½m(dx/dt)Â² + V(x)] dt<br>
                                å…¶ä¸­ V(x) æ˜¯åŠ¿èƒ½å‡½æ•°ï¼ŒåŒ…å«éšœç¢ç‰©ã€äº¤é€šè§„åˆ™ç­‰çº¦æŸ
                            </div>
                            <div class="scenario-result">
                                å®é™…åº”ç”¨ï¼šç‰¹æ–¯æ‹‰Autopilotã€ç™¾åº¦Apolloç­‰è‡ªåŠ¨é©¾é©¶ç³»ç»Ÿçš„æ ¸å¿ƒç®—æ³•ã€‚
                            </div>
                        </div>

                        <div class="example-scenario">
                            <div class="scenario-title">ğŸ¬ ç”µå½±ç‰¹æ•ˆåˆ¶ä½œ</div>
                            <div class="scenario-description">
                                ç”µå½±ä¸­çš„æ°´æµã€çˆ†ç‚¸ã€çƒŸé›¾ç­‰ç‰¹æ•ˆéƒ½ä½¿ç”¨æµä½“åŠ›å­¦æ–¹ç¨‹ï¼ˆNavier-Stokesæ–¹ç¨‹ï¼‰æ¨¡æ‹Ÿã€‚
                            </div>
                            <div class="scenario-math">
                                æµä½“è¿åŠ¨ï¼šâˆ‚v/âˆ‚t + (vÂ·âˆ‡)v = -âˆ‡p/Ï + Î½âˆ‡Â²v<br>
                                é€šè¿‡æ•°å€¼ç§¯åˆ†æ±‚è§£ï¼Œç”Ÿæˆé€¼çœŸçš„æµä½“åŠ¨ç”»
                            </div>
                            <div class="scenario-result">
                                å®é™…åº”ç”¨ï¼šã€Šé˜¿å‡¡è¾¾ã€‹çš„æµ·æ´‹åœºæ™¯ã€ã€Šå¤ä»‡è€…è”ç›Ÿã€‹çš„çˆ†ç‚¸ç‰¹æ•ˆéƒ½ä¾èµ–è¿™äº›è®¡ç®—ã€‚
                            </div>
                        </div>
                    </div>
                </div>

                <!-- äº¤äº’å¼æ¢ç´¢ -->
                <div class="tool-section" id="interactive">
                    <h3>äº¤äº’å¼å¾®ç§¯åˆ†æ¢ç´¢</h3>
                    
                    <div class="learning-section">
                        <h3>ğŸ® åŠ¨æ‰‹å®è·µ</h3>
                        <p>é€šè¿‡äº¤äº’å¼å·¥å…·æ·±å…¥ç†è§£å¾®ç§¯åˆ†æ¦‚å¿µï¼Œè‡ªå·±åŠ¨æ‰‹æ¢ç´¢æ•°å­¦çš„å¥¥ç§˜ã€‚</p>
                    </div>

                    <!-- Function Explorer -->
                    <div class="interactive-demo">
                        <h4>ğŸ” å‡½æ•°æ¢ç´¢å™¨</h4>
                        <p>è¾“å…¥è‡ªå®šä¹‰å‡½æ•°ï¼Œè§‚å¯Ÿå…¶å¯¼æ•°å’Œç§¯åˆ†</p>
                        
                        <div class="input-group">
                            <label for="custom-function">è¾“å…¥å‡½æ•° f(x) (æ”¯æŒ: x^2, sin(x), cos(x), exp(x), log(x))</label>
                            <input type="text" id="custom-function" class="input-field" placeholder="x^2 + 2*x + 1" value="x^2">
                        </div>
                        
                        <div class="demo-controls">
                            <button class="btn btn-primary" onclick="plotCustomFunction()">
                                ğŸ“ˆ ç»˜åˆ¶å‡½æ•°
                            </button>
                            <button class="btn btn-secondary" onclick="showDerivative()">
                                ğŸ“Š æ˜¾ç¤ºå¯¼æ•°
                            </button>
                            <button class="btn btn-secondary" onclick="showIntegral()">
                                ğŸ“‹ è®¡ç®—ç§¯åˆ†
                            </button>
                        </div>
                        
                        <div class="graph-container">
                            <div class="canvas-container">
                                <canvas id="explorerCanvas"></canvas>
                            </div>
                        </div>
                        
                        <div id="function-info" class="visual-equation">
                            è¾“å…¥å‡½æ•°å¼€å§‹æ¢ç´¢
                        </div>
                    </div>

                    <!-- Optimization Problem Solver -->
                    <div class="interactive-demo">
                        <h4>ğŸ¯ ä¼˜åŒ–é—®é¢˜æ±‚è§£å™¨</h4>
                        <p>è§£å†³å®é™…çš„æœ€ä¼˜åŒ–é—®é¢˜</p>
                        
                        <div class="input-group">
                            <label for="optimization-problem">é€‰æ‹©ä¼˜åŒ–é—®é¢˜ç±»å‹</label>
                            <select id="optimization-problem" class="input-field" onchange="loadOptimizationProblem()">
                                <option value="box">çº¸ç›’æœ€å¤§ä½“ç§¯é—®é¢˜</option>
                                <option value="fence">å›´æ æœ€å¤§é¢ç§¯é—®é¢˜</option>
                                <option value="profit">åˆ©æ¶¦æœ€å¤§åŒ–é—®é¢˜</option>
                                <option value="distance">æœ€çŸ­è·ç¦»é—®é¢˜</option>
                                <option value="custom">è‡ªå®šä¹‰ä¼˜åŒ–é—®é¢˜</option>
                            </select>
                        </div>
                        
                        <div id="problem-description" class="scenario-description">
                            é€‰æ‹©ä¸€ä¸ªé—®é¢˜ç±»å‹æŸ¥çœ‹è¯¦ç»†æè¿°
                        </div>
                        
                        <div class="demo-controls">
                            <button class="btn btn-primary" onclick="solveOptimization()">
                                ğŸ§® æ±‚è§£
                            </button>
                            <button class="btn btn-secondary" onclick="showOptimizationSteps()">
                                ğŸ“ æ˜¾ç¤ºæ­¥éª¤
                            </button>
                        </div>
                        
                        <div id="optimization-result" class="visual-equation">
                            ç‚¹å‡»æ±‚è§£æŒ‰é’®å¼€å§‹è®¡ç®—
                        </div>
                        
                        <div class="graph-container">
                            <div class="canvas-container">
                                <canvas id="optimizationCanvas"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Calculus Calculator -->
                    <div class="interactive-demo">
                        <h4>ğŸ§® å¾®ç§¯åˆ†è®¡ç®—å™¨</h4>
                        <p>è®¡ç®—å¯¼æ•°å’Œå®šç§¯åˆ†ï¼Œæ”¯æŒç¬¦å·è®¡ç®—å’Œæ•°å€¼è®¡ç®—</p>
                        
                        <div class="input-group">
                            <label for="calc-function">å‡½æ•° f(x)</label>
                            <input type="text" id="calc-function" class="input-field" placeholder="x^3 + 2*x^2 - x + 1" value="x^2">
                            <small style="color: #666; margin-top: 0.5rem; display: block;">
                                æ”¯æŒ: x^n, sin(x), cos(x), tan(x), exp(x), ln(x), sqrt(x), abs(x) ç­‰
                            </small>
                        </div>
                        
                        <div class="demo-controls" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div>
                                <h5 style="margin-bottom: 1rem; color: #007bff;">ğŸ“ˆ å¯¼æ•°è®¡ç®—</h5>
                                <div style="display: flex; gap: 0.5rem; margin-bottom: 0.5rem;">
                                    <button class="btn btn-primary" onclick="calculateDerivative()" style="flex: 1;">
                                        è®¡ç®—å¯¼æ•°
                                    </button>
                                    <button class="btn btn-secondary" onclick="evaluateDerivativeAtPoint()" style="flex: 1;">
                                        ç‰¹å®šç‚¹å¯¼æ•°
                                    </button>
                                </div>
                                <div id="derivative-result" class="visual-equation" style="font-size: 0.9rem; padding: 0.8rem; min-height: 120px;">
                                    å¯¼æ•°ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ
                                </div>
                            </div>
                            
                            <div>
                                <h5 style="margin-bottom: 1rem; color: #28a745;">ğŸ“Š ç§¯åˆ†è®¡ç®—</h5>
                                <div class="input-group" style="margin-bottom: 0.5rem;">
                                    <label>å®šç§¯åˆ†åŒºé—´</label>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <input type="number" id="integral-lower" class="input-field" placeholder="ä¸‹é™" value="0" style="flex: 1;">
                                        <input type="number" id="integral-upper" class="input-field" placeholder="ä¸Šé™" value="2" style="flex: 1;">
                                    </div>
                                </div>
                                <button class="btn btn-primary" onclick="calculateIntegral()" style="width: 100%; margin-bottom: 0.5rem;">
                                    è®¡ç®—å®šç§¯åˆ†
                                </button>
                                <div id="integral-result" class="visual-equation" style="font-size: 0.9rem; padding: 0.8rem; min-height: 120px;">
                                    ç§¯åˆ†ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ
                                </div>
                            </div>
                        </div>
                        
                        <!-- Quick Examples -->
                        <div style="margin-top: 1rem; padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                            <h6 style="margin-bottom: 0.5rem; color: #495057;">ğŸš€ å¿«é€Ÿç¤ºä¾‹ (ç‚¹å‡»å¡«å…¥):</h6>
                            <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                <button class="btn" style="background: #e9ecef; color: #495057; padding: 0.3rem 0.6rem; font-size: 0.8rem;" 
                                        onclick="document.getElementById('calc-function').value = 'x^3 - 3*x^2 + 2*x'">
                                    xÂ³ - 3xÂ² + 2x
                                </button>
                                <button class="btn" style="background: #e9ecef; color: #495057; padding: 0.3rem 0.6rem; font-size: 0.8rem;" 
                                        onclick="document.getElementById('calc-function').value = 'sin(x) + cos(x)'">
                                    sin(x) + cos(x)
                                </button>
                                <button class="btn" style="background: #e9ecef; color: #495057; padding: 0.3rem 0.6rem; font-size: 0.8rem;" 
                                        onclick="document.getElementById('calc-function').value = 'exp(x) - x^2'">
                                    e^x - xÂ²
                                </button>
                                <button class="btn" style="background: #e9ecef; color: #495057; padding: 0.3rem 0.6rem; font-size: 0.8rem;" 
                                        onclick="document.getElementById('calc-function').value = 'ln(x) + sqrt(x)'">
                                    ln(x) + âˆšx
                                </button>
                                <button class="btn" style="background: #e9ecef; color: #495057; padding: 0.3rem 0.6rem; font-size: 0.8rem;" 
                                        onclick="document.getElementById('calc-function').value = '1/(1+x^2)'">
                                    1/(1+xÂ²)
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Tips for Interactive Learning -->
                    <div class="tips-section">
                        <h4>ğŸ’¡ äº¤äº’å­¦ä¹ å»ºè®®</h4>
                        <div class="tip-item">
                            <div class="tip-icon">1</div>
                            <div>ä»ç®€å•å‡½æ•°å¼€å§‹ï¼šå…ˆå°è¯• xÂ², xÂ³ ç­‰åŸºæœ¬å‡½æ•°</div>
                        </div>
                        <div class="tip-item">
                            <div class="tip-icon">2</div>
                            <div>è§‚å¯Ÿå›¾åƒå˜åŒ–ï¼šè°ƒæ•´å‚æ•°æ—¶æ³¨æ„å‡½æ•°å½¢çŠ¶çš„æ”¹å˜</div>
                        </div>
                        <div class="tip-item">
                            <div class="tip-icon">3</div>
                            <div>éªŒè¯è®¡ç®—ç»“æœï¼šç”¨å·²çŸ¥å…¬å¼æ£€éªŒè®¡ç®—å™¨çš„ç»“æœ</div>
                        </div>
                        <div class="tip-item">
                            <div class="tip-icon">4</div>
                            <div>è”ç³»å®é™…é—®é¢˜ï¼šæ€è€ƒè¿™äº›æ•°å­¦æ¦‚å¿µåœ¨ç°å®ä¸­çš„åº”ç”¨</div>
                        </div>
                        <div class="tip-item">
                            <div class="tip-icon">5</div>
                            <div>å¤šåšç»ƒä¹ ï¼šé€šè¿‡ä¸åŒç±»å‹çš„é—®é¢˜åŠ æ·±ç†è§£</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab switching functionality
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                // Remove active class from all tabs and sections
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tool-section').forEach(s => s.classList.remove('active'));
                
                // Add active class to clicked tab
                btn.classList.add('active');
                
                // Show corresponding section
                const tabId = btn.dataset.tab;
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Canvas setup and drawing functions
        function setupCanvas(canvasId) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return null;
            
            const ctx = canvas.getContext('2d');
            const container = canvas.parentElement;
            
            // Set canvas size
            canvas.width = container.clientWidth;
            canvas.height = container.clientHeight;
            
            return { canvas, ctx };
        }

        function drawAxes(ctx, width, height) {
            const centerX = width / 2;
            const centerY = height / 2;
            
            ctx.strokeStyle = '#ddd';
            ctx.lineWidth = 1;
            
            // Draw axes
            ctx.beginPath();
            ctx.moveTo(0, centerY);
            ctx.lineTo(width, centerY);
            ctx.moveTo(centerX, 0);
            ctx.lineTo(centerX, height);
            ctx.stroke();
            
            // Draw grid
            ctx.strokeStyle = '#f0f0f0';
            ctx.lineWidth = 0.5;
            
            for (let i = 0; i < width; i += 20) {
                ctx.beginPath();
                ctx.moveTo(i, 0);
                ctx.lineTo(i, height);
                ctx.stroke();
            }
            
            for (let i = 0; i < height; i += 20) {
                ctx.beginPath();
                ctx.moveTo(0, i);
                ctx.lineTo(width, i);
                ctx.stroke();
            }
        }

        function plotFunction(ctx, width, height, func, color = '#007bff', lineWidth = 2) {
            const centerX = width / 2;
            const centerY = height / 2;
            const scale = 20; // pixels per unit
            
            ctx.strokeStyle = color;
            ctx.lineWidth = lineWidth;
            ctx.beginPath();
            
            let firstPoint = true;
            for (let px = 0; px < width; px += 1) {
                const x = (px - centerX) / scale;
                try {
                    const y = func(x);
                    const py = centerY - y * scale;
                    
                    if (isFinite(y) && py >= 0 && py <= height) {
                        if (firstPoint) {
                            ctx.moveTo(px, py);
                            firstPoint = false;
                        } else {
                            ctx.lineTo(px, py);
                        }
                    } else {
                        firstPoint = true;
                    }
                } catch (e) {
                    firstPoint = true;
                }
            }
            ctx.stroke();
        }

        // Derivative demo functions
        function updateDerivativeDemo() {
            const a = parseFloat(document.getElementById('deriv-a').value);
            const b = parseFloat(document.getElementById('deriv-b').value);
            const c = parseFloat(document.getElementById('deriv-c').value);
            const d = parseFloat(document.getElementById('deriv-d').value);
            
            // Update value displays
            document.getElementById('deriv-value-a').textContent = a;
            document.getElementById('deriv-value-b').textContent = b;
            document.getElementById('deriv-value-c').textContent = c;
            document.getElementById('deriv-value-d').textContent = d;
            
            // Update function display
            let funcStr = '';
            if (a !== 0) funcStr += `${a}xÂ³`;
            if (b !== 0) funcStr += (funcStr ? (b > 0 ? ' + ' : ' - ') : (b < 0 ? '-' : '')) + `${Math.abs(b)}xÂ²`;
            if (c !== 0) funcStr += (funcStr ? (c > 0 ? ' + ' : ' - ') : (c < 0 ? '-' : '')) + `${Math.abs(c)}x`;
            if (d !== 0) funcStr += (funcStr ? (d > 0 ? ' + ' : ' - ') : (d < 0 ? '-' : '')) + `${Math.abs(d)}`;
            if (!funcStr) funcStr = '0';
            
            document.getElementById('deriv-function').textContent = `f(x) = ${funcStr}`;
            
            // Update derivative display
            let derivStr = '';
            if (a !== 0) derivStr += `${3*a}xÂ²`;
            if (b !== 0) derivStr += (derivStr ? (2*b > 0 ? ' + ' : ' - ') : (2*b < 0 ? '-' : '')) + `${Math.abs(2*b)}x`;
            if (c !== 0) derivStr += (derivStr ? (c > 0 ? ' + ' : ' - ') : (c < 0 ? '-' : '')) + `${Math.abs(c)}`;
            if (!derivStr) derivStr = '0';
            
            document.getElementById('deriv-derivative').textContent = `f'(x) = ${derivStr}`;
            
            // Draw the graph
            const setup = setupCanvas('derivativeCanvas');
            if (!setup) return;
            
            const { ctx, canvas } = setup;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawAxes(ctx, canvas.width, canvas.height);
            
            // Plot original function
            plotFunction(ctx, canvas.width, canvas.height, 
                x => a*x*x*x + b*x*x + c*x + d, '#007bff', 3);
            
            // Plot derivative
            plotFunction(ctx, canvas.width, canvas.height, 
                x => 3*a*x*x + 2*b*x + c, '#dc3545', 2);
            
            // Add legend
            ctx.fillStyle = '#007bff';
            ctx.font = '14px Arial';
            ctx.fillText('f(x)', 10, 20);
            ctx.fillStyle = '#dc3545';
            ctx.fillText("f'(x)", 10, 40);
        }

        // Integral demo functions
        function updateIntegralDemo() {
            const a = parseFloat(document.getElementById('int-a').value);
            const b = parseFloat(document.getElementById('int-b').value);
            const c = parseFloat(document.getElementById('int-c').value);
            const lower = parseFloat(document.getElementById('int-lower').value);
            const upper = parseFloat(document.getElementById('int-upper').value);
            
            // Update value displays
            document.getElementById('int-value-a').textContent = a;
            document.getElementById('int-value-b').textContent = b;
            document.getElementById('int-value-c').textContent = c;
            document.getElementById('int-value-lower').textContent = lower;
            document.getElementById('int-value-upper').textContent = upper;
            
            // Update function display
            let funcStr = '';
            if (a !== 0) funcStr += `${a}xÂ²`;
            if (b !== 0) funcStr += (funcStr ? (b > 0 ? ' + ' : ' - ') : (b < 0 ? '-' : '')) + `${Math.abs(b)}x`;
            if (c !== 0) funcStr += (funcStr ? (c > 0 ? ' + ' : ' - ') : (c < 0 ? '-' : '')) + `${Math.abs(c)}`;
            if (!funcStr) funcStr = '0';
            
            document.getElementById('int-function').textContent = `f(x) = ${funcStr}`;
            
            // Calculate integral
            const integral = (a/3) * (upper*upper*upper - lower*lower*lower) + 
                           (b/2) * (upper*upper - lower*lower) + 
                           c * (upper - lower);
            
            document.getElementById('int-result').textContent = 
                `âˆ«${lower}${upper} (${funcStr}) dx = ${integral.toFixed(3)}`;
            
            // Draw the graph
            const setup = setupCanvas('integralCanvas');
            if (!setup) return;
            
            const { ctx, canvas } = setup;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawAxes(ctx, canvas.width, canvas.height);
            
            // Plot function
            plotFunction(ctx, canvas.width, canvas.height, 
                x => a*x*x + b*x + c, '#007bff', 3);
            
            // Fill area under curve
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const scale = 20;
            
            ctx.fillStyle = 'rgba(0, 123, 255, 0.3)';
            ctx.beginPath();
            
            const lowerPx = centerX + lower * scale;
            const upperPx = centerX + upper * scale;
            
            ctx.moveTo(lowerPx, centerY);
            for (let px = lowerPx; px <= upperPx; px += 1) {
                const x = (px - centerX) / scale;
                const y = a*x*x + b*x + c;
                const py = centerY - y * scale;
                ctx.lineTo(px, py);
            }
            ctx.lineTo(upperPx, centerY);
            ctx.closePath();
            ctx.fill();
            
            // Draw integration bounds
            ctx.strokeStyle = '#dc3545';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            
            ctx.beginPath();
            ctx.moveTo(lowerPx, 0);
            ctx.lineTo(lowerPx, canvas.height);
            ctx.moveTo(upperPx, 0);
            ctx.lineTo(upperPx, canvas.height);
            ctx.stroke();
            ctx.setLineDash([]);
        }

        // Enhanced function parser and evaluator
        class MathParser {
            constructor() {
                this.functions = {
                    'sin': Math.sin,
                    'cos': Math.cos,
                    'tan': Math.tan,
                    'exp': Math.exp,
                    'log': Math.log,
                    'ln': Math.log,
                    'sqrt': Math.sqrt,
                    'abs': Math.abs,
                    'floor': Math.floor,
                    'ceil': Math.ceil,
                    'round': Math.round
                };
            }

            parseFunction(expression) {
                // Clean and prepare expression
                let expr = expression.toLowerCase()
                    .replace(/\s+/g, '')
                    .replace(/\^/g, '**')
                    .replace(/(\d)([a-z])/g, '$1*$2')
                    .replace(/([a-z])(\d)/g, '$1*$2')
                    .replace(/(\))(\()/g, '$1*$2')
                    .replace(/(\d)(\()/g, '$1*$2')
                    .replace(/(\))(\d)/g, '$1*$2');

                // Replace function names
                Object.keys(this.functions).forEach(func => {
                    const regex = new RegExp(`\\b${func}\\b`, 'g');
                    expr = expr.replace(regex, `Math.${func}`);
                });

                // Replace constants
                expr = expr.replace(/\be\b/g, 'Math.E')
                          .replace(/\bpi\b/g, 'Math.PI');

                return new Function('x', `
                    try {
                        return ${expr};
                    } catch (e) {
                        return NaN;
                    }
                `);
            }

            // Numerical derivative calculation
            derivative(func, x, h = 0.0001) {
                return (func(x + h) - func(x - h)) / (2 * h);
            }

            // Numerical integration using Simpson's rule
            integrate(func, a, b, n = 1000) {
                if (n % 2 === 1) n++;
                const h = (b - a) / n;
                let sum = func(a) + func(b);
                
                for (let i = 1; i < n; i++) {
                    const x = a + i * h;
                    sum += (i % 2 === 0 ? 2 : 4) * func(x);
                }
                
                return (h / 3) * sum;
            }

            // Symbolic derivative for common functions
            getSymbolicDerivative(expression) {
                const expr = expression.toLowerCase().replace(/\s+/g, '');
                
                // Simple polynomial derivatives
                if (/^[\d\.\-\+\*x\^]+$/.test(expr)) {
                    return this.polynomialDerivative(expr);
                }
                
                // Trigonometric functions
                if (expr.includes('sin(x)')) return expr.replace(/sin\(x\)/g, 'cos(x)');
                if (expr.includes('cos(x)')) return expr.replace(/cos\(x\)/g, '-sin(x)');
                if (expr.includes('tan(x)')) return expr.replace(/tan\(x\)/g, 'secÂ²(x)');
                
                // Exponential and logarithmic
                if (expr.includes('exp(x)') || expr.includes('e^x')) return 'exp(x)';
                if (expr.includes('ln(x)') || expr.includes('log(x)')) return '1/x';
                
                return 'æ•°å€¼å¯¼æ•°';
            }

            polynomialDerivative(expr) {
                // Handle simple polynomials like x^3, 2*x^2, etc.
                return expr.replace(/(\d*)\*?x\^(\d+)/g, (match, coeff, power) => {
                    const c = coeff === '' ? 1 : parseFloat(coeff);
                    const p = parseInt(power);
                    if (p === 1) return c.toString();
                    return `${c * p}*x^${p - 1}`;
                }).replace(/(\d*)\*?x(?!\^)/g, (match, coeff) => {
                    const c = coeff === '' ? 1 : parseFloat(coeff);
                    return c.toString();
                }).replace(/^\d+$/, '0');
            }
        }

        const mathParser = new MathParser();
        let currentFunction = null;

        // Interactive functions
        function plotCustomFunction() {
            const funcStr = document.getElementById('custom-function').value;
            const info = document.getElementById('function-info');
            
            if (!funcStr.trim()) {
                info.textContent = 'è¯·è¾“å…¥ä¸€ä¸ªå‡½æ•°';
                return;
            }
            
            try {
                currentFunction = mathParser.parseFunction(funcStr);
                
                const setup = setupCanvas('explorerCanvas');
                if (!setup) return;
                
                const { ctx, canvas } = setup;
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                drawAxes(ctx, canvas.width, canvas.height);
                
                // Plot original function
                plotFunction(ctx, canvas.width, canvas.height, currentFunction, '#007bff', 3);
                
                // Add function label
                ctx.fillStyle = '#007bff';
                ctx.font = 'bold 14px Arial';
                ctx.fillText(`f(x) = ${funcStr}`, 10, 25);
                
                info.innerHTML = `
                    <strong>å‡½æ•°å·²ç»˜åˆ¶:</strong> f(x) = ${funcStr}<br>
                    <small>æ”¯æŒçš„å‡½æ•°: sin, cos, tan, exp, ln, sqrt, abs ç­‰</small>
                `;
            } catch (e) {
                info.innerHTML = `
                    <span style="color: #dc3545;">å‡½æ•°æ ¼å¼é”™è¯¯:</span> ${e.message}<br>
                    <small>ç¤ºä¾‹: x^2, sin(x), exp(x), 2*x^3 + x - 1</small>
                `;
            }
        }

        function showDerivative() {
            if (!currentFunction) {
                document.getElementById('function-info').innerHTML = 
                    '<span style="color: #dc3545;">è¯·å…ˆç»˜åˆ¶ä¸€ä¸ªå‡½æ•°</span>';
                return;
            }

            const funcStr = document.getElementById('custom-function').value;
            const info = document.getElementById('function-info');
            
            try {
                const setup = setupCanvas('explorerCanvas');
                if (!setup) return;
                
                const { ctx, canvas } = setup;
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                drawAxes(ctx, canvas.width, canvas.height);
                
                // Plot original function
                plotFunction(ctx, canvas.width, canvas.height, currentFunction, '#007bff', 3);
                
                // Plot derivative
                const derivativeFunc = (x) => mathParser.derivative(currentFunction, x);
                plotFunction(ctx, canvas.width, canvas.height, derivativeFunc, '#dc3545', 2);
                
                // Add labels
                ctx.fillStyle = '#007bff';
                ctx.font = 'bold 14px Arial';
                ctx.fillText(`f(x) = ${funcStr}`, 10, 25);
                ctx.fillStyle = '#dc3545';
                ctx.fillText(`f'(x) (å¯¼æ•°)`, 10, 45);
                
                const symbolicDeriv = mathParser.getSymbolicDerivative(funcStr);
                info.innerHTML = `
                    <strong>åŸå‡½æ•°:</strong> f(x) = ${funcStr}<br>
                    <strong>å¯¼æ•°:</strong> f'(x) = ${symbolicDeriv}<br>
                    <small>è“çº¿: åŸå‡½æ•°, çº¢çº¿: å¯¼æ•°</small>
                `;
            } catch (e) {
                info.innerHTML = `<span style="color: #dc3545;">è®¡ç®—å¯¼æ•°æ—¶å‡ºé”™: ${e.message}</span>`;
            }
        }

        function showIntegral() {
            if (!currentFunction) {
                document.getElementById('function-info').innerHTML = 
                    '<span style="color: #dc3545;">è¯·å…ˆç»˜åˆ¶ä¸€ä¸ªå‡½æ•°</span>';
                return;
            }

            const funcStr = document.getElementById('custom-function').value;
            const info = document.getElementById('function-info');
            
            try {
                const setup = setupCanvas('explorerCanvas');
                if (!setup) return;
                
                const { ctx, canvas } = setup;
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                drawAxes(ctx, canvas.width, canvas.height);
                
                // Plot function
                plotFunction(ctx, canvas.width, canvas.height, currentFunction, '#007bff', 3);
                
                // Fill area under curve (from -2 to 2)
                const centerX = canvas.width / 2;
                const centerY = canvas.height / 2;
                const scale = 20;
                const lowerBound = -2;
                const upperBound = 2;
                
                ctx.fillStyle = 'rgba(0, 123, 255, 0.3)';
                ctx.beginPath();
                
                const lowerPx = centerX + lowerBound * scale;
                const upperPx = centerX + upperBound * scale;
                
                ctx.moveTo(lowerPx, centerY);
                for (let px = lowerPx; px <= upperPx; px += 2) {
                    const x = (px - centerX) / scale;
                    const y = currentFunction(x);
                    if (isFinite(y)) {
                        const py = centerY - y * scale;
                        ctx.lineTo(px, py);
                    }
                }
                ctx.lineTo(upperPx, centerY);
                ctx.closePath();
                ctx.fill();
                
                // Calculate integral
                const integralValue = mathParser.integrate(currentFunction, lowerBound, upperBound);
                
                // Add labels
                ctx.fillStyle = '#007bff';
                ctx.font = 'bold 14px Arial';
                ctx.fillText(`f(x) = ${funcStr}`, 10, 25);
                ctx.fillStyle = '#28a745';
                ctx.fillText(`âˆ«â‚‹â‚‚Â² f(x)dx â‰ˆ ${integralValue.toFixed(4)}`, 10, 45);
                
                info.innerHTML = `
                    <strong>å‡½æ•°:</strong> f(x) = ${funcStr}<br>
                    <strong>å®šç§¯åˆ†:</strong> âˆ«â‚‹â‚‚Â² f(x)dx â‰ˆ ${integralValue.toFixed(4)}<br>
                    <small>è“è‰²åŒºåŸŸè¡¨ç¤ºç§¯åˆ†é¢ç§¯</small>
                `;
            } catch (e) {
                info.innerHTML = `<span style="color: #dc3545;">è®¡ç®—ç§¯åˆ†æ—¶å‡ºé”™: ${e.message}</span>`;
            }
        }

        // Enhanced optimization solver
        class OptimizationSolver {
            constructor() {
                this.predefinedProblems = {
                    box: {
                        title: 'çº¸ç›’æœ€å¤§ä½“ç§¯é—®é¢˜',
                        description: 'ä»è¾¹é•¿ä¸º20cmçš„æ­£æ–¹å½¢çº¸ç‰‡å››è§’åˆ‡å»è¾¹é•¿ä¸ºxçš„å°æ­£æ–¹å½¢ï¼Œç„¶åæŠ˜æˆæ— ç›–çº¸ç›’ã€‚æ±‚xä¸ºå¤šå°‘æ—¶ä½“ç§¯æœ€å¤§ï¼Ÿ',
                        func: 'x*(20-2*x)^2',
                        domain: [0, 10],
                        variable: 'x',
                        unit: 'cm',
                        type: 'maximize'
                    },
                    fence: {
                        title: 'å›´æ æœ€å¤§é¢ç§¯é—®é¢˜',
                        description: 'ç”¨100ç±³é•¿çš„ç¯±ç¬†å›´æˆçŸ©å½¢èœå›­ï¼Œä¸€è¾¹é å¢™ä¸éœ€è¦ç¯±ç¬†ã€‚æ±‚çŸ©å½¢çš„é•¿å’Œå®½å„ä¸ºå¤šå°‘æ—¶é¢ç§¯æœ€å¤§ï¼Ÿ',
                        func: 'x*(100-2*x)',
                        domain: [0, 50],
                        variable: 'x',
                        unit: 'ç±³',
                        type: 'maximize'
                    },
                    profit: {
                        title: 'åˆ©æ¶¦æœ€å¤§åŒ–é—®é¢˜',
                        description: 'æŸå…¬å¸ç”Ÿäº§äº§å“çš„æˆæœ¬å‡½æ•°ä¸ºC(x) = 100 + 2x + 0.01xÂ²ï¼Œå”®ä»·ä¸ºæ¯ä»¶10å…ƒã€‚æ±‚äº§é‡ä¸ºå¤šå°‘æ—¶åˆ©æ¶¦æœ€å¤§ï¼Ÿ',
                        func: '8*x - 100 - 0.01*x^2',
                        domain: [0, 800],
                        variable: 'x',
                        unit: 'ä»¶',
                        type: 'maximize'
                    },
                    distance: {
                        title: 'æœ€çŸ­è·ç¦»é—®é¢˜',
                        description: 'ç‚¹P(3,4)åˆ°ç›´çº¿y = xçš„æœ€çŸ­è·ç¦»æ˜¯å¤šå°‘ï¼Ÿ',
                        func: 'sqrt((x-3)^2 + (x-4)^2)',
                        domain: [0, 8],
                        variable: 'x',
                        unit: '',
                        type: 'minimize'
                    },
                    custom: {
                        title: 'è‡ªå®šä¹‰ä¼˜åŒ–é—®é¢˜',
                        description: 'è¾“å…¥æ‚¨è‡ªå·±çš„å‡½æ•°è¿›è¡Œä¼˜åŒ–åˆ†æ',
                        func: '',
                        domain: [-10, 10],
                        variable: 'x',
                        unit: '',
                        type: 'maximize'
                    }
                };
            }

            // Find critical points using numerical methods
            findCriticalPoints(func, domain, step = 0.01) {
                const [a, b] = domain;
                const criticalPoints = [];
                
                for (let x = a + step; x < b - step; x += step) {
                    const derivative = mathParser.derivative(func, x);
                    const prevDerivative = mathParser.derivative(func, x - step);
                    
                    // Check for sign change in derivative (critical point)
                    if (Math.sign(derivative) !== Math.sign(prevDerivative)) {
                        criticalPoints.push({
                            x: x,
                            y: func(x),
                            type: derivative > prevDerivative ? 'minimum' : 'maximum'
                        });
                    }
                }
                
                // Add endpoints
                criticalPoints.push(
                    { x: a, y: func(a), type: 'endpoint' },
                    { x: b, y: func(b), type: 'endpoint' }
                );
                
                return criticalPoints;
            }

            // Visualize optimization problem
            visualizeOptimization(func, domain, criticalPoints, canvasId) {
                const setup = setupCanvas(canvasId);
                if (!setup) return;
                
                const { ctx, canvas } = setup;
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                drawAxes(ctx, canvas.width, canvas.height);
                
                // Plot function
                plotFunction(ctx, canvas.width, canvas.height, func, '#007bff', 3);
                
                // Mark critical points
                const centerX = canvas.width / 2;
                const centerY = canvas.height / 2;
                const scale = Math.min(canvas.width, canvas.height) / (domain[1] - domain[0] + 4);
                
                criticalPoints.forEach(point => {
                    const px = centerX + (point.x - (domain[0] + domain[1]) / 2) * scale;
                    const py = centerY - point.y * scale;
                    
                    if (px >= 0 && px <= canvas.width && py >= 0 && py <= canvas.height) {
                        ctx.fillStyle = point.type === 'maximum' ? '#28a745' : 
                                       point.type === 'minimum' ? '#dc3545' : '#ffc107';
                        ctx.beginPath();
                        ctx.arc(px, py, 6, 0, 2 * Math.PI);
                        ctx.fill();
                        
                        // Add label
                        ctx.fillStyle = '#000';
                        ctx.font = '12px Arial';
                        ctx.fillText(`(${point.x.toFixed(2)}, ${point.y.toFixed(2)})`, px + 10, py - 10);
                    }
                });
                
                // Add legend
                ctx.fillStyle = '#007bff';
                ctx.font = 'bold 14px Arial';
                ctx.fillText('å‡½æ•°å›¾åƒ', 10, 25);
                ctx.fillStyle = '#28a745';
                ctx.fillText('â— æœ€å¤§å€¼', 10, 45);
                ctx.fillStyle = '#dc3545';
                ctx.fillText('â— æœ€å°å€¼', 10, 65);
                ctx.fillStyle = '#ffc107';
                ctx.fillText('â— ç«¯ç‚¹', 10, 85);
            }
        }

        const optimizationSolver = new OptimizationSolver();
        let currentOptimizationFunc = null;

        function loadOptimizationProblem() {
            const problemType = document.getElementById('optimization-problem').value;
            const problem = optimizationSolver.predefinedProblems[problemType];
            
            document.getElementById('problem-description').textContent = problem.description;
            document.getElementById('optimization-result').textContent = 'ç‚¹å‡»æ±‚è§£æŒ‰é’®å¼€å§‹è®¡ç®—';
            
            // Show custom input fields for custom problems
            const customInputs = document.getElementById('custom-optimization-inputs');
            if (problemType === 'custom') {
                if (!customInputs) {
                    const inputsHtml = `
                        <div id="custom-optimization-inputs" style="margin: 1rem 0; padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                            <div class="input-group">
                                <label for="custom-opt-function">ç›®æ ‡å‡½æ•° f(x):</label>
                                <input type="text" id="custom-opt-function" class="input-field" placeholder="x^2 - 4*x + 3" value="x^2 - 4*x + 3">
                            </div>
                            <div style="display: flex; gap: 1rem;">
                                <div class="input-group" style="flex: 1;">
                                    <label for="custom-opt-min">å®šä¹‰åŸŸæœ€å°å€¼:</label>
                                    <input type="number" id="custom-opt-min" class="input-field" value="-5">
                                </div>
                                <div class="input-group" style="flex: 1;">
                                    <label for="custom-opt-max">å®šä¹‰åŸŸæœ€å¤§å€¼:</label>
                                    <input type="number" id="custom-opt-max" class="input-field" value="5">
                                </div>
                            </div>
                            <div class="input-group">
                                <label for="custom-opt-type">ä¼˜åŒ–ç±»å‹:</label>
                                <select id="custom-opt-type" class="input-field">
                                    <option value="maximize">æ±‚æœ€å¤§å€¼</option>
                                    <option value="minimize">æ±‚æœ€å°å€¼</option>
                                    <option value="both">æ±‚æå€¼</option>
                                </select>
                            </div>
                        </div>
                    `;
                    document.getElementById('problem-description').insertAdjacentHTML('afterend', inputsHtml);
                }
            } else {
                if (customInputs) {
                    customInputs.remove();
                }
            }
        }

        function solveOptimization() {
            const problemType = document.getElementById('optimization-problem').value;
            let problem = optimizationSolver.predefinedProblems[problemType];
            
            // Handle custom optimization
            if (problemType === 'custom') {
                const funcStr = document.getElementById('custom-opt-function').value;
                const minVal = parseFloat(document.getElementById('custom-opt-min').value);
                const maxVal = parseFloat(document.getElementById('custom-opt-max').value);
                const optType = document.getElementById('custom-opt-type').value;
                
                if (!funcStr.trim()) {
                    document.getElementById('optimization-result').innerHTML = 
                        '<span style="color: #dc3545;">è¯·è¾“å…¥ç›®æ ‡å‡½æ•°</span>';
                    return;
                }
                
                problem = {
                    title: 'è‡ªå®šä¹‰ä¼˜åŒ–é—®é¢˜',
                    func: funcStr,
                    domain: [minVal, maxVal],
                    type: optType
                };
            }
            
            try {
                currentOptimizationFunc = mathParser.parseFunction(problem.func);
                const criticalPoints = optimizationSolver.findCriticalPoints(
                    currentOptimizationFunc, 
                    problem.domain
                );
                
                // Find optimal points
                let optimal = null;
                if (problem.type === 'maximize' || problem.type === 'both') {
                    optimal = criticalPoints.reduce((max, point) => 
                        point.y > max.y ? point : max
                    );
                } else if (problem.type === 'minimize') {
                    optimal = criticalPoints.reduce((min, point) => 
                        point.y < min.y ? point : min
                    );
                }
                
                // Display results
                let resultHtml = `<strong>${problem.title}</strong><br>`;
                resultHtml += `<strong>ç›®æ ‡å‡½æ•°:</strong> f(x) = ${problem.func}<br>`;
                resultHtml += `<strong>å®šä¹‰åŸŸ:</strong> [${problem.domain[0]}, ${problem.domain[1]}]<br><br>`;
                
                if (problem.type === 'both') {
                    const maximum = criticalPoints.filter(p => p.type === 'maximum' || p.type === 'endpoint')
                        .reduce((max, point) => point.y > max.y ? point : max);
                    const minimum = criticalPoints.filter(p => p.type === 'minimum' || p.type === 'endpoint')
                        .reduce((min, point) => point.y < min.y ? point : min);
                    
                    resultHtml += `<strong>æœ€å¤§å€¼:</strong> f(${maximum.x.toFixed(4)}) = ${maximum.y.toFixed(4)}<br>`;
                    resultHtml += `<strong>æœ€å°å€¼:</strong> f(${minimum.x.toFixed(4)}) = ${minimum.y.toFixed(4)}<br>`;
                } else {
                    const optimalType = problem.type === 'maximize' ? 'æœ€å¤§å€¼' : 'æœ€å°å€¼';
                    resultHtml += `<strong>${optimalType}:</strong> f(${optimal.x.toFixed(4)}) = ${optimal.y.toFixed(4)}<br>`;
                }
                
                resultHtml += `<br><strong>æ‰€æœ‰å…³é”®ç‚¹:</strong><br>`;
                criticalPoints.forEach(point => {
                    const typeText = point.type === 'maximum' ? 'æå¤§å€¼' : 
                                   point.type === 'minimum' ? 'æå°å€¼' : 'ç«¯ç‚¹';
                    resultHtml += `â€¢ ${typeText}: (${point.x.toFixed(4)}, ${point.y.toFixed(4)})<br>`;
                });
                
                document.getElementById('optimization-result').innerHTML = resultHtml;
                
                // Visualize
                optimizationSolver.visualizeOptimization(
                    currentOptimizationFunc, 
                    problem.domain, 
                    criticalPoints, 
                    'optimizationCanvas'
                );
                
            } catch (e) {
                document.getElementById('optimization-result').innerHTML = 
                    `<span style="color: #dc3545;">æ±‚è§£é”™è¯¯: ${e.message}</span>`;
            }
        }

        function showOptimizationSteps() {
            if (!currentOptimizationFunc) {
                document.getElementById('optimization-result').innerHTML += 
                    '<br><span style="color: #dc3545;">è¯·å…ˆæ±‚è§£ä¼˜åŒ–é—®é¢˜</span>';
                return;
            }
            
            const result = document.getElementById('optimization-result');
            result.innerHTML += `
                <br><br><strong>æ±‚è§£æ­¥éª¤:</strong><br>
                1. å¯¹ç›®æ ‡å‡½æ•°æ±‚å¯¼æ•°<br>
                2. ä»¤å¯¼æ•°ç­‰äºé›¶ï¼Œæ±‚è§£å…³é”®ç‚¹<br>
                3. æ£€æŸ¥å®šä¹‰åŸŸç«¯ç‚¹<br>
                4. æ¯”è¾ƒæ‰€æœ‰å€™é€‰ç‚¹çš„å‡½æ•°å€¼<br>
                5. ç¡®å®šæœ€ä¼˜è§£<br>
                <em>å›¾åƒä¸­çš„å½©è‰²ç‚¹æ ‡ç¤ºäº†æ‰€æœ‰å…³é”®ç‚¹ä½ç½®</em>
            `;
        }

        // Enhanced calculus calculator
        class CalculusCalculator {
            constructor() {
                this.derivativeRules = {
                    // Power rule: x^n -> n*x^(n-1)
                    power: (expr) => {
                        return expr.replace(/(\d*\.?\d*)\*?x\^(\d+\.?\d*)/g, (match, coeff, power) => {
                            const c = coeff === '' || coeff === '1' ? '' : (coeff === '-1' ? '-' : coeff);
                            const p = parseFloat(power);
                            const newCoeff = c === '' ? p : (c === '-' ? -p : parseFloat(c) * p);
                            const newPower = p - 1;
                            
                            if (newPower === 0) return newCoeff.toString();
                            if (newPower === 1) return `${newCoeff}x`;
                            return `${newCoeff}x^${newPower}`;
                        });
                    },
                    
                    // Trigonometric functions
                    trig: (expr) => {
                        return expr
                            .replace(/sin\(x\)/g, 'cos(x)')
                            .replace(/cos\(x\)/g, '-sin(x)')
                            .replace(/tan\(x\)/g, 'secÂ²(x)')
                            .replace(/sec\(x\)/g, 'sec(x)tan(x)')
                            .replace(/csc\(x\)/g, '-csc(x)cot(x)')
                            .replace(/cot\(x\)/g, '-cscÂ²(x)');
                    },
                    
                    // Exponential and logarithmic
                    expLog: (expr) => {
                        return expr
                            .replace(/e\^x/g, 'e^x')
                            .replace(/exp\(x\)/g, 'exp(x)')
                            .replace(/ln\(x\)/g, '1/x')
                            .replace(/log\(x\)/g, '1/(x*ln(10))');
                    }
                };
            }

            // Symbolic derivative calculation
            calculateSymbolicDerivative(expression) {
                let expr = expression.toLowerCase().replace(/\s+/g, '');
                
                // Handle constants
                if (!/x/.test(expr)) {
                    return '0';
                }
                
                // Apply derivative rules
                expr = this.derivativeRules.power(expr);
                expr = this.derivativeRules.trig(expr);
                expr = this.derivativeRules.expLog(expr);
                
                // Handle linear terms
                expr = expr.replace(/(\d*\.?\d*)\*?x(?!\^)/g, (match, coeff) => {
                    return coeff === '' || coeff === '1' ? '1' : coeff;
                });
                
                // Clean up
                expr = expr.replace(/\+\s*0/g, '').replace(/^0\s*\+\s*/, '');
                
                return expr || '0';
            }

            // Numerical derivative at a point
            numericalDerivative(func, x, h = 0.0001) {
                try {
                    return (func(x + h) - func(x - h)) / (2 * h);
                } catch (e) {
                    return NaN;
                }
            }

            // Numerical integration
            numericalIntegral(func, a, b, method = 'simpson') {
                if (method === 'simpson') {
                    return this.simpsonRule(func, a, b, 1000);
                } else if (method === 'trapezoidal') {
                    return this.trapezoidalRule(func, a, b, 1000);
                }
            }

            simpsonRule(func, a, b, n) {
                if (n % 2 === 1) n++;
                const h = (b - a) / n;
                let sum = func(a) + func(b);
                
                for (let i = 1; i < n; i++) {
                    const x = a + i * h;
                    sum += (i % 2 === 0 ? 2 : 4) * func(x);
                }
                
                return (h / 3) * sum;
            }

            trapezoidalRule(func, a, b, n) {
                const h = (b - a) / n;
                let sum = (func(a) + func(b)) / 2;
                
                for (let i = 1; i < n; i++) {
                    sum += func(a + i * h);
                }
                
                return h * sum;
            }

            // Get step-by-step derivative explanation
            getDerivativeSteps(expression) {
                const steps = [];
                let expr = expression.toLowerCase().replace(/\s+/g, '');
                
                steps.push(`åŸå‡½æ•°: f(x) = ${expression}`);
                
                // Identify terms
                const terms = expr.split(/(?=[+-])/).filter(term => term.trim());
                steps.push(`åˆ†è§£ä¸ºé¡¹: ${terms.join(', ')}`);
                
                // Apply rules to each term
                const derivedTerms = terms.map(term => {
                    if (term.includes('x^')) {
                        const match = term.match(/(\d*\.?\d*)\*?x\^(\d+\.?\d*)/);
                        if (match) {
                            const coeff = match[1] || '1';
                            const power = match[2];
                            steps.push(`${term}: å¹‚å‡½æ•°æ³•åˆ™ â†’ ${coeff}Ã—${power}Ã—x^${power-1}`);
                            return this.derivativeRules.power(term);
                        }
                    } else if (term.includes('sin') || term.includes('cos') || term.includes('tan')) {
                        steps.push(`${term}: ä¸‰è§’å‡½æ•°æ³•åˆ™`);
                        return this.derivativeRules.trig(term);
                    } else if (term.includes('x')) {
                        steps.push(`${term}: çº¿æ€§å‡½æ•°æ³•åˆ™ â†’ å¸¸æ•°`);
                        return term.replace(/(\d*\.?\d*)\*?x/, '$1');
                    } else {
                        steps.push(`${term}: å¸¸æ•°æ³•åˆ™ â†’ 0`);
                        return '0';
                    }
                });
                
                const result = derivedTerms.join(' + ').replace(/\+\s*0/g, '').replace(/^\s*\+\s*/, '');
                steps.push(`æœ€ç»ˆç»“æœ: f'(x) = ${result || '0'}`);
                
                return steps;
            }
        }

        const calculusCalculator = new CalculusCalculator();

        function calculateDerivative() {
            const funcStr = document.getElementById('calc-function').value;
            const result = document.getElementById('derivative-result');
            
            if (!funcStr.trim()) {
                result.innerHTML = '<span style="color: #dc3545;">è¯·è¾“å…¥å‡½æ•°</span>';
                return;
            }
            
            try {
                // Try symbolic derivative first
                const symbolicResult = calculusCalculator.calculateSymbolicDerivative(funcStr);
                
                // Also calculate numerical derivative at x=1 for verification
                const func = mathParser.parseFunction(funcStr);
                const numericalAtOne = calculusCalculator.numericalDerivative(func, 1);
                
                // Get step-by-step explanation
                const steps = calculusCalculator.getDerivativeSteps(funcStr);
                
                result.innerHTML = `
                    <strong>ç¬¦å·å¯¼æ•°:</strong> f'(x) = ${symbolicResult}<br>
                    <strong>åœ¨ x=1 å¤„çš„æ•°å€¼:</strong> f'(1) â‰ˆ ${numericalAtOne.toFixed(6)}<br>
                    <details style="margin-top: 0.5rem;">
                        <summary style="cursor: pointer; color: #007bff;">æŸ¥çœ‹æ±‚å¯¼æ­¥éª¤</summary>
                        <div style="margin-top: 0.5rem; font-size: 0.9rem;">
                            ${steps.map(step => `<div style="margin: 0.2rem 0;">${step}</div>`).join('')}
                        </div>
                    </details>
                `;
            } catch (e) {
                result.innerHTML = `<span style="color: #dc3545;">è®¡ç®—é”™è¯¯: ${e.message}</span>`;
            }
        }

        function calculateIntegral() {
            const funcStr = document.getElementById('calc-function').value;
            const lower = parseFloat(document.getElementById('integral-lower').value);
            const upper = parseFloat(document.getElementById('integral-upper').value);
            const result = document.getElementById('integral-result');
            
            if (!funcStr.trim()) {
                result.innerHTML = '<span style="color: #dc3545;">è¯·è¾“å…¥å‡½æ•°</span>';
                return;
            }
            
            if (isNaN(lower) || isNaN(upper)) {
                result.innerHTML = '<span style="color: #dc3545;">è¯·è¾“å…¥æœ‰æ•ˆçš„ç§¯åˆ†åŒºé—´</span>';
                return;
            }
            
            try {
                const func = mathParser.parseFunction(funcStr);
                
                // Calculate using different methods
                const simpsonResult = calculusCalculator.numericalIntegral(func, lower, upper, 'simpson');
                const trapezoidalResult = calculusCalculator.numericalIntegral(func, lower, upper, 'trapezoidal');
                
                // Calculate error estimate
                const error = Math.abs(simpsonResult - trapezoidalResult);
                
                result.innerHTML = `
                    <strong>å®šç§¯åˆ†ç»“æœ:</strong><br>
                    âˆ«<sub>${lower}</sub><sup>${upper}</sup> (${funcStr}) dx<br><br>
                    <strong>è¾›æ™®æ£®æ³•åˆ™:</strong> ${simpsonResult.toFixed(6)}<br>
                    <strong>æ¢¯å½¢æ³•åˆ™:</strong> ${trapezoidalResult.toFixed(6)}<br>
                    <strong>è¯¯å·®ä¼°è®¡:</strong> Â±${error.toFixed(6)}<br>
                    <small style="color: #666;">æ¨èä½¿ç”¨è¾›æ™®æ£®æ³•åˆ™ç»“æœï¼Œç²¾åº¦æ›´é«˜</small>
                `;
                
                // Add geometric interpretation for simple cases
                if (upper > lower) {
                    const avgValue = simpsonResult / (upper - lower);
                    result.innerHTML += `<br><br><strong>å‡ ä½•æ„ä¹‰:</strong><br>`;
                    result.innerHTML += `æ›²çº¿ä¸‹é¢ç§¯: ${Math.abs(simpsonResult).toFixed(4)}<br>`;
                    result.innerHTML += `å¹³å‡å‡½æ•°å€¼: ${avgValue.toFixed(4)}`;
                }
                
            } catch (e) {
                result.innerHTML = `<span style="color: #dc3545;">è®¡ç®—é”™è¯¯: ${e.message}</span>`;
            }
        }

        // Add function to evaluate derivative at specific point
        function evaluateDerivativeAtPoint() {
            const funcStr = document.getElementById('calc-function').value;
            const point = prompt('è¯·è¾“å…¥è¦è®¡ç®—å¯¼æ•°çš„ç‚¹ x =', '1');
            
            if (point === null || point.trim() === '') return;
            
            const x = parseFloat(point);
            if (isNaN(x)) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å€¼');
                return;
            }
            
            try {
                const func = mathParser.parseFunction(funcStr);
                const derivativeValue = calculusCalculator.numericalDerivative(func, x);
                const functionValue = func(x);
                
                const result = document.getElementById('derivative-result');
                result.innerHTML += `<br><br><strong>åœ¨ x = ${x} å¤„:</strong><br>`;
                result.innerHTML += `f(${x}) = ${functionValue.toFixed(6)}<br>`;
                result.innerHTML += `f'(${x}) = ${derivativeValue.toFixed(6)}<br>`;
                result.innerHTML += `<small>åˆ‡çº¿æ–œç‡ä¸º ${derivativeValue.toFixed(6)}</small>`;
            } catch (e) {
                alert(`è®¡ç®—é”™è¯¯: ${e.message}`);
            }
        }

        // Initialize demos when page loads
        document.addEventListener('DOMContentLoaded', function() {
            updateDerivativeDemo();
            updateIntegralDemo();
            loadOptimizationProblem();
        });

        // Handle window resize
        window.addEventListener('resize', function() {
            setTimeout(() => {
                updateDerivativeDemo();
                updateIntegralDemo();
            }, 100);
        });
    </script>
</body>
</html> 