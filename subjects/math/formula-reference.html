<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>数学公式参考 - 学习助手</title>
    <link rel="icon" href="../../assets/icons/logo_btrfly.ico" type="image/x-icon">
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../../css/components.css">
    <link rel="stylesheet" href="../../css/utilities.css">
    <link rel="stylesheet" href="../../css/responsive.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script>
        // MathJax configuration - must be defined before loading MathJax
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true,
                tags: 'none'
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            },
            startup: {
                ready() {
                    MathJax.startup.defaultReady();
                    MathJax.startup.document.setRenderer('svg');
                }
            },
            svg: {
                fontCache: 'local',
                scale: 1,
                minScale: 0.5,
                matchFontHeight: false,
                displayAlign: 'center',
                displayIndent: '0'
            },
            loader: {
                load: ['[tex]/html']
            }
        };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
    <style>
        .formulas-page {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 1rem 0;
        }

        .formulas-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            margin: 1rem auto;
            max-width: 1400px;
            width: calc(100% - 2rem);
        }

        .formulas-header {
            background: linear-gradient(135deg, #4361ee, #7209b7);
            color: white;
            padding: 1.5rem;
            text-align: center;
        }

        .formulas-header h1 {
            margin: 0;
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            font-weight: 700;
            word-wrap: break-word;
        }

        .formulas-header p {
            margin: 1rem 0 0 0;
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
            opacity: 0.9;
        }

        .formulas-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: thin;
            scrollbar-color: #ccc transparent;
        }

        .formulas-tabs::-webkit-scrollbar {
            height: 4px;
        }

        .formulas-tabs::-webkit-scrollbar-track {
            background: transparent;
        }

        .formulas-tabs::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 2px;
        }

        .formulas-tab {
            flex: 1;
            min-width: 120px;
            padding: 1rem 1rem;
            background: none;
            border: none;
            cursor: pointer;
            font-size: clamp(0.85rem, 2vw, 1rem);
            font-weight: 500;
            color: #6c757d;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            white-space: nowrap;
            -webkit-tap-highlight-color: transparent;
        }

        .formulas-tab.active {
            background: white;
            color: #4361ee;
            border-bottom: 3px solid #4361ee;
        }

        .formulas-tab:hover,
        .formulas-tab:focus {
            background: rgba(67, 97, 238, 0.1);
            color: #4361ee;
            outline: none;
        }

        .formulas-content {
            padding: 1.5rem;
            min-height: 400px;
        }

        .formula-panel {
            display: none;
        }

        .formula-panel.active {
            display: block;
        }

        .formula-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(min(350px, 100%), 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .formula-card {
            background: #fff;
            border: 1px solid #e9ecef;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            overflow: hidden;
            word-wrap: break-word;
            position: relative;
        }

        .formula-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(67, 97, 238, 0.2);
            border-color: #4361ee;
        }

        .formula-title {
            font-size: clamp(1.1rem, 3vw, 1.2rem);
            font-weight: 600;
            color: #333;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            word-wrap: break-word;
        }

        .formula-equation {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 10px;
            padding: 1rem;
            margin: 1rem 0;
            text-align: center;
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
            border-left: 4px solid #4361ee;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: thin;
            position: relative;
        }

        .formula-equation::-webkit-scrollbar {
            height: 4px;
        }

        .formula-equation::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.1);
            border-radius: 2px;
        }

        .formula-equation::-webkit-scrollbar-thumb {
            background: #4361ee;
            border-radius: 2px;
        }

        /* MathJax container responsive adjustments */
        .formula-equation .MathJax,
        .formula-equation .MathJax_Display {
            font-size: inherit !important;
            overflow-x: auto !important;
            overflow-y: hidden !important;
            max-width: 100% !important;
            text-align: center !important;
        }

        .formula-equation .MathJax_Display > .MathJax > .math > .mrow {
            display: inline-block !important;
            white-space: nowrap !important;
        }

        .formula-description {
            color: #666;
            font-size: clamp(0.85rem, 2.2vw, 0.95rem);
            line-height: 1.6;
            margin-bottom: 1rem;
            word-wrap: break-word;
            hyphens: auto;
        }

        .formula-variables {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            overflow: hidden;
        }

        .formula-variables h5 {
            margin: 0 0 0.5rem 0;
            color: #4361ee;
            font-size: clamp(0.8rem, 2vw, 0.9rem);
            font-weight: 600;
        }

        .variable-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .variable-list li {
            padding: 0.25rem 0;
            font-size: clamp(0.75rem, 2vw, 0.85rem);
            color: #666;
            word-wrap: break-word;
        }

        .variable-list li strong {
            color: #333;
            margin-right: 0.5rem;
        }

        .formula-example {
            background: #e3f2fd;
            border-radius: 10px;
            padding: 1rem;
            margin-top: 1rem;
            overflow: hidden;
        }

        .example-title {
            font-size: clamp(0.8rem, 2vw, 0.9rem);
            font-weight: 600;
            color: #1976d2;
            margin-bottom: 0.5rem;
        }

        .formula-example .MathJax {
            font-size: clamp(0.8rem, 2vw, 0.9rem) !important;
            overflow-x: auto !important;
            max-width: 100% !important;
        }

        .formula-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .formula-tag {
            background: rgba(67, 97, 238, 0.1);
            color: #4361ee;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: clamp(0.7rem, 1.8vw, 0.75rem);
            font-weight: 500;
            white-space: nowrap;
        }

        /* Mobile-specific optimizations */
        @media (max-width: 768px) {
            .formulas-page {
                padding: 0.5rem 0;
            }

            .formulas-container {
                margin: 0.5rem auto;
                width: calc(100% - 1rem);
                border-radius: 15px;
            }

            .formulas-header {
                padding: 1rem;
            }

            .formulas-tabs {
                flex-wrap: nowrap;
                justify-content: flex-start;
            }

            .formulas-tab {
                min-width: 100px;
                padding: 0.75rem 0.5rem;
                font-size: 0.85rem;
            }

            .formulas-tab i {
                display: none;
            }

            .formulas-content {
                padding: 1rem;
            }

            .formula-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .formula-card {
                padding: 1rem;
            }

            .formula-equation {
                padding: 0.75rem;
                font-size: 0.9rem;
            }

            /* Force MathJax to be more responsive on mobile */
            .formula-equation .MathJax {
                font-size: 14px !important;
                transform-origin: left center;
            }

            .formula-equation .MathJax_Display {
                margin: 0.5em 0 !important;
            }

            /* Enable horizontal scrolling for long formulas on mobile */
            .formula-equation .MathJax_Display .math {
                white-space: nowrap !important;
                overflow-x: auto !important;
                overflow-y: hidden !important;
                max-width: 100% !important;
                display: block !important;
            }
        }

        /* Extra small screens */
        @media (max-width: 480px) {
            .formulas-container {
                width: calc(100% - 0.5rem);
                margin: 0.25rem auto;
                border-radius: 10px;
            }

            .formulas-header {
                padding: 0.75rem;
            }

            .formulas-tab {
                min-width: 80px;
                padding: 0.6rem 0.4rem;
                font-size: 0.8rem;
            }

            .formulas-content {
                padding: 0.75rem;
            }

            .formula-card {
                padding: 0.75rem;
            }

            .formula-equation {
                padding: 0.5rem;
                margin: 0.75rem 0;
            }

            .formula-equation .MathJax {
                font-size: 12px !important;
            }
        }

        /* Landscape orientation on mobile */
        @media (max-width: 768px) and (orientation: landscape) {
            .formula-grid {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            }
        }

        /* High DPI displays */
        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
            .formula-equation {
                border-left-width: 2px;
            }
        }

        /* Ensure proper touch targets */
        @media (pointer: coarse) {
            .formulas-tab {
                min-height: 44px;
                padding: 0.75rem 1rem;
            }
        }

        /* Print styles */
        @media print {
            .formulas-page {
                background: white !important;
                padding: 0 !important;
            }

            .formulas-container {
                box-shadow: none !important;
                border: 1px solid #ccc !important;
            }

            .formulas-tabs {
                display: none !important;
            }

            .formula-panel {
                display: block !important;
            }

            .formula-card {
                break-inside: avoid;
                margin-bottom: 1rem;
            }
        }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="../../index.html">
                        <i class="fas fa-graduation-cap" style="background: linear-gradient(90deg, #4361ee, #7209b7); -webkit-background-clip: text; background-clip: text; color: transparent;"></i>
                        <span>Alex的学习助手</span>
                    </a>
                </div>
                <nav class="main-nav">
                    <ul>
                        <li><a href="../../index.html">首页</a></li>
                        <li><a href="main.html">数学</a></li>
                        <li><a href="../../index.html#subjects">科目</a></li>
                        <li><a href="../../tts.html">语音</a></li>
                        <li><a href="../../draw.html">绘图</a></li>
                    </ul>
                </nav>
                <button class="mobile-menu-toggle" aria-label="切换菜单">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </header>

    <main class="formulas-page">
        <div class="container">
            <div class="formulas-container">
                <div class="formulas-header">
                    <h1><i class="fas fa-calculator"></i> 数学公式参考</h1>
                    <p>完整的数学公式库，包含详细说明和实例</p>
                </div>

                <div class="formulas-tabs">
                    <button class="formulas-tab active" data-tab="algebra">
                        <i class="fas fa-square-root-alt"></i> 代数
                    </button>
                    <button class="formulas-tab" data-tab="geometry">
                        <i class="fas fa-shapes"></i> 几何
                    </button>
                    <button class="formulas-tab" data-tab="trigonometry">
                        <i class="fas fa-wave-square"></i> 三角函数
                    </button>
                    <button class="formulas-tab" data-tab="statistics">
                        <i class="fas fa-chart-bar"></i> 统计
                    </button>
                    <button class="formulas-tab" data-tab="calculus">
                        <i class="fas fa-infinity"></i> 微积分
                    </button>
                </div>

                <div class="formulas-content">
                    <!-- 代数公式 -->
                    <div class="formula-panel active" id="algebra-panel">
                        <div class="formula-grid">
                            <!-- 因式分解 -->
                            <div class="formula-card" data-keywords="因式分解 平方差">
                                <div class="formula-title">
                                    <i class="fas fa-expand-arrows-alt"></i> 平方差公式
                                </div>
                                <div class="formula-equation">
                                    $$a^2 - b^2 = (a+b)(a-b)$$
                                </div>
                                <div class="formula-description">
                                    两个数的平方差等于这两个数的和与这两个数的差的乘积。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    分解因式：$x^2 - 9$<br>
                                    解：$x^2 - 9 = x^2 - 3^2 = (x+3)(x-3)$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">因式分解</span>
                                    <span class="formula-tag">代数</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="完全平方 因式分解">
                                <div class="formula-title">
                                    <i class="fas fa-square"></i> 完全平方公式
                                </div>
                                <div class="formula-equation">
                                    $$(a \pm b)^2 = a^2 \pm 2ab + b^2$$
                                </div>
                                <div class="formula-description">
                                    两数和（或差）的平方，等于两数的平方和，加上（或减去）两数乘积的两倍。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    展开：$(x+3)^2$<br>
                                    解：$(x+3)^2 = x^2 + 2×x×3 + 3^2 = x^2 + 6x + 9$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">完全平方</span>
                                    <span class="formula-tag">代数</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="立方 因式分解">
                                <div class="formula-title">
                                    <i class="fas fa-cube"></i> 完全立方公式
                                </div>
                                <div class="formula-equation">
                                    $$(a \pm b)^3 = a^3 \pm 3a^2b + 3ab^2 \pm b^3$$
                                </div>
                                <div class="formula-description">
                                    两数和（或差）的立方展开公式。注意符号规律：立方和中间两项符号都为正。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    展开：$(x-2)^3$<br>
                                    解：$(x-2)^3 = x^3 - 6x^2 + 12x - 8$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">立方公式</span>
                                    <span class="formula-tag">代数</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="立方和差 因式分解">
                                <div class="formula-title">
                                    <i class="fas fa-cubes"></i> 立方和差公式
                                </div>
                                <div class="formula-equation">
                                    $$a^3 \pm b^3 = (a \pm b)(a^2 \mp ab + b^2)$$
                                </div>
                                <div class="formula-description">
                                    立方和或立方差的因式分解公式。立方和分解为(a+b)乘以不完全平方差。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    分解因式：$x^3 + 8$<br>
                                    解：$x^3 + 8 = x^3 + 2^3 = (x+2)(x^2-2x+4)$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">立方和差</span>
                                    <span class="formula-tag">因式分解</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="二次方程 求根公式">
                                <div class="formula-title">
                                    <i class="fas fa-calculator"></i> 二次方程求根公式
                                </div>
                                <div class="formula-equation">
                                    $$x = \frac{-b \pm \sqrt{b^2-4ac}}{2a}$$
                                </div>
                                <div class="formula-description">
                                    对于一般式二次方程$ax^2 + bx + c = 0$（a≠0），可以用此公式求解。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    解方程：$x^2 - 5x + 6 = 0$<br>
                                    解：$a=1, b=-5, c=6$，$x = \frac{5 \pm 1}{2}$<br>
                                    所以 $x_1 = 3, x_2 = 2$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">二次方程</span>
                                    <span class="formula-tag">求根公式</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="判别式 二次方程">
                                <div class="formula-title">
                                    <i class="fas fa-question-circle"></i> 判别式
                                </div>
                                <div class="formula-equation">
                                    $$\Delta = b^2 - 4ac$$
                                </div>
                                <div class="formula-description">
                                    判别式用于判断二次方程根的性质：Δ>0时有两个不等实根，Δ=0时有两个相等实根，Δ<0时无实根。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    判断方程$x^2 - 4x + 5 = 0$的根的性质。<br>
                                    解：$\Delta = 16 - 20 = -4 < 0$，所以方程无实根
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">判别式</span>
                                    <span class="formula-tag">二次方程</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="指数 幂运算">
                                <div class="formula-title">
                                    <i class="fas fa-superscript"></i> 同底数幂相乘
                                </div>
                                <div class="formula-equation">
                                    $$a^m \cdot a^n = a^{m+n}$$
                                </div>
                                <div class="formula-description">
                                    相同底数的幂相乘，底数不变，指数相加。这是指数运算的基本法则。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    计算：$2^3 \cdot 2^5$<br>
                                    解：$2^3 \cdot 2^5 = 2^{3+5} = 2^8 = 256$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">指数运算</span>
                                    <span class="formula-tag">幂法则</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="幂的乘方 指数">
                                <div class="formula-title">
                                    <i class="fas fa-layer-group"></i> 幂的乘方
                                </div>
                                <div class="formula-equation">
                                    $$(a^m)^n = a^{mn}$$
                                </div>
                                <div class="formula-description">
                                    幂的乘方，底数不变，指数相乘。注意与同底数幂相乘的区别。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    计算：$(3^2)^4$<br>
                                    解：$(3^2)^4 = 3^{2×4} = 3^8 = 6561$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">幂运算</span>
                                    <span class="formula-tag">指数法则</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="对数 乘法法则">
                                <div class="formula-title">
                                    <i class="fas fa-plus"></i> 对数乘法法则
                                </div>
                                <div class="formula-equation">
                                    $$\log_a(xy) = \log_a x + \log_a y$$
                                </div>
                                <div class="formula-description">
                                    两个正数乘积的对数等于这两个数对数的和。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    已知$\log_2 3 = 1.585$，$\log_2 5 = 2.322$，求$\log_2 15$。<br>
                                    解：$\log_2 15 = \log_2 3 + \log_2 5 = 3.907$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">对数</span>
                                    <span class="formula-tag">乘法法则</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="对数 除法法则">
                                <div class="formula-title">
                                    <i class="fas fa-minus"></i> 对数除法法则
                                </div>
                                <div class="formula-equation">
                                    $$\log_a\left(\frac{x}{y}\right) = \log_a x - \log_a y$$
                                </div>
                                <div class="formula-description">
                                    两个正数商的对数等于被除数对数减去除数对数。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    已知$\log_2 8 = 3$，$\log_2 2 = 1$，求$\log_2 4$。<br>
                                    解：$\log_2 4 = \log_2 8 - \log_2 2 = 2$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">对数</span>
                                    <span class="formula-tag">除法法则</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="对数 幂法则">
                                <div class="formula-title">
                                    <i class="fas fa-times"></i> 对数幂法则
                                </div>
                                <div class="formula-equation">
                                    $$\log_a x^n = n\log_a x$$
                                </div>
                                <div class="formula-description">
                                    一个正数的n次幂的对数等于n乘以这个数的对数。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    计算：$\log_3 27^2$<br>
                                    解：$\log_3 27^2 = 2\log_3 27 = 2 × 3 = 6$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">对数</span>
                                    <span class="formula-tag">幂法则</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="等差数列 求和">
                                <div class="formula-title">
                                    <i class="fas fa-plus-circle"></i> 等差数列求和公式
                                </div>
                                <div class="formula-equation">
                                    $$S_n = \frac{n(a_1 + a_n)}{2} = \frac{n[2a_1 + (n-1)d]}{2}$$
                                    $$a_n = a_1 + (n-1)d$$
                                </div>
                                <div class="formula-description">
                                    等差数列前n项和公式，其中$a_1$为首项，$a_n$为第n项，d为公差。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    数列1, 4, 7, 10, ...的前10项和是多少？<br>
                                    解：$a_1=1, d=3, n=10$<br>
                                    $S_{10} = \frac{10[2×1 + (10-1)×3]}{2} = \frac{10×29}{2} = 145$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">等差数列</span>
                                    <span class="formula-tag">求和公式</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="等比数列 求和">
                                <div class="formula-title">
                                    <i class="fas fa-times-circle"></i> 等比数列求和公式
                                </div>
                                <div class="formula-equation">
                                    $$S_n = \begin{cases}
                                    na_1 & \text{当} q = 1 \\
                                    \frac{a_1(1-q^n)}{1-q} = \frac{a_1-a_nq}{1-q} & \text{当} q \neq 1
                                    \end{cases}$$
                                    $$a_n = a_1 \cdot q^{n-1}$$
                                </div>
                                <div class="formula-description">
                                    等比数列前n项和公式，其中$a_1$为首项，q为公比。当q=1时为常数列。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    数列2, 6, 18, 54, ...的前5项和是多少？<br>
                                    解：$a_1=2, q=3, n=5$<br>
                                    $S_5 = \frac{2(1-3^5)}{1-3} = \frac{2×(-242)}{-2} = 242$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">等比数列</span>
                                    <span class="formula-tag">求和公式</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="无穷等比数列 极限">
                                <div class="formula-title">
                                    <i class="fas fa-infinity"></i> 无穷等比数列求和
                                </div>
                                <div class="formula-equation">
                                    $$S_{\infty} = \frac{a_1}{1-q} \quad (|q| < 1)$$
                                </div>
                                <div class="formula-description">
                                    当公比的绝对值小于1时，无穷等比数列收敛，其和为此公式。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    数列$1 + \frac{1}{2} + \frac{1}{4} + \frac{1}{8} + ...$的和是多少？<br>
                                    解：$a_1=1, q=\frac{1}{2}$，$|q|<1$<br>
                                    $S_{\infty} = \frac{1}{1-\frac{1}{2}} = 2$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">无穷级数</span>
                                    <span class="formula-tag">等比数列</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 几何公式 -->
                    <div class="formula-panel" id="geometry-panel">
                        <div class="formula-grid">
                            <div class="formula-card" data-keywords="三角形 面积">
                                <div class="formula-title">
                                    <i class="fas fa-play"></i> 三角形面积
                                </div>
                                <div class="formula-equation">
                                    $$S = \frac{1}{2}ah$$
                                </div>
                                <div class="formula-description">
                                    三角形面积等于底边长度与对应高的乘积的一半。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    底边为8cm，高为6cm的三角形面积是多少？<br>
                                    解：$S = \frac{1}{2} × 8 × 6 = 24$ cm²
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">三角形</span>
                                    <span class="formula-tag">面积</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="海伦公式 三角形">
                                <div class="formula-title">
                                    <i class="fas fa-certificate"></i> 海伦公式
                                </div>
                                <div class="formula-equation">
                                    $$S = \sqrt{s(s-a)(s-b)(s-c)}$$
                                    $$s = \frac{a+b+c}{2}$$
                                </div>
                                <div class="formula-description">
                                    已知三角形三边长时，用海伦公式求面积。其中s为半周长。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    三角形三边长为3、4、5，求面积。<br>
                                    解：$s = 6$，$S = \sqrt{6×3×2×1} = 6$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">海伦公式</span>
                                    <span class="formula-tag">三角形</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="勾股定理 直角三角形">
                                <div class="formula-title">
                                    <i class="fas fa-square-root-alt"></i> 勾股定理
                                </div>
                                <div class="formula-equation">
                                    $$a^2 + b^2 = c^2$$
                                </div>
                                <div class="formula-description">
                                    直角三角形中，两直角边的平方和等于斜边的平方。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    直角三角形两直角边为3、4，求斜边长。<br>
                                    解：$c = \sqrt{3^2 + 4^2} = \sqrt{9 + 16} = 5$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">勾股定理</span>
                                    <span class="formula-tag">直角三角形</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="圆 面积">
                                <div class="formula-title">
                                    <i class="fas fa-circle"></i> 圆的面积和周长
                                </div>
                                <div class="formula-equation">
                                    $$S = \pi r^2$$
                                    $$C = 2\pi r$$
                                </div>
                                <div class="formula-description">
                                    圆的面积公式和周长公式，其中r为半径。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    半径为5cm的圆，面积和周长各是多少？<br>
                                    解：面积 = $25\pi$ cm²，周长 = $10\pi$ cm
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">圆</span>
                                    <span class="formula-tag">面积</span>
                                    <span class="formula-tag">周长</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="矩形 面积 周长">
                                <div class="formula-title">
                                    <i class="fas fa-square"></i> 矩形面积和周长
                                </div>
                                <div class="formula-equation">
                                    $$S = ab$$
                                    $$P = 2(a+b)$$
                                </div>
                                <div class="formula-description">
                                    矩形面积等于长乘以宽，周长等于长和宽之和的两倍。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    长为8cm，宽为5cm的矩形，面积和周长各是多少？<br>
                                    解：面积 = $8×5 = 40$ cm²，周长 = $2×(8+5) = 26$ cm
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">矩形</span>
                                    <span class="formula-tag">面积</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="梯形 面积">
                                <div class="formula-title">
                                    <i class="fas fa-object-group"></i> 梯形面积
                                </div>
                                <div class="formula-equation">
                                    $$S = \frac{(a+b)h}{2}$$
                                </div>
                                <div class="formula-description">
                                    梯形面积等于上底加下底的和乘以高除以2。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    上底3cm，下底7cm，高4cm的梯形面积是多少？<br>
                                    解：$S = \frac{(3+7)×4}{2} = 20$ cm²
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">梯形</span>
                                    <span class="formula-tag">面积</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="点到直线距离">
                                <div class="formula-title">
                                    <i class="fas fa-arrows-alt-v"></i> 点到直线距离
                                </div>
                                <div class="formula-equation">
                                    $$d = \frac{|Ax_0 + By_0 + C|}{\sqrt{A^2 + B^2}}$$
                                </div>
                                <div class="formula-description">
                                    点$(x_0, y_0)$到直线$Ax + By + C = 0$的距离公式。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    点(2,3)到直线$3x + 4y - 5 = 0$的距离？<br>
                                    解：$d = \frac{|6 + 12 - 5|}{\sqrt{9 + 16}} = \frac{13}{5} = 2.6$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">解析几何</span>
                                    <span class="formula-tag">距离</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="两点距离 坐标">
                                <div class="formula-title">
                                    <i class="fas fa-exchange-alt"></i> 两点间距离
                                </div>
                                <div class="formula-equation">
                                    $$d = \sqrt{(x_2-x_1)^2 + (y_2-y_1)^2}$$
                                </div>
                                <div class="formula-description">
                                    平面坐标系中两点间的距离公式。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    点A(1,2)到点B(4,6)的距离？<br>
                                    解：$d = \sqrt{(4-1)^2 + (6-2)^2} = \sqrt{9+16} = 5$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">坐标几何</span>
                                    <span class="formula-tag">距离</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="球体 体积 表面积">
                                <div class="formula-title">
                                    <i class="fas fa-globe"></i> 球体公式
                                </div>
                                <div class="formula-equation">
                                    $$V = \frac{4}{3}\pi r^3$$
                                    $$S = 4\pi r^2$$
                                </div>
                                <div class="formula-description">
                                    球体的体积和表面积公式，其中r为球的半径。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    半径为3的球体，体积和表面积各是多少？<br>
                                    解：体积 = $36\pi$，表面积 = $36\pi$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">立体几何</span>
                                    <span class="formula-tag">球体</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="圆柱 体积 表面积">
                                <div class="formula-title">
                                    <i class="fas fa-battery-three-quarters"></i> 圆柱体公式
                                </div>
                                <div class="formula-equation">
                                    $$V = \pi r^2 h$$
                                    $$S = 2\pi r^2 + 2\pi rh$$
                                </div>
                                <div class="formula-description">
                                    圆柱体的体积和表面积公式，其中r为底面半径，h为高。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    底面半径2，高5的圆柱体，体积和表面积各是多少？<br>
                                    解：体积 = $20\pi$，表面积 = $28\pi$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">立体几何</span>
                                    <span class="formula-tag">圆柱</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="圆锥 体积 表面积">
                                <div class="formula-title">
                                    <i class="fas fa-mountain"></i> 圆锥体公式
                                </div>
                                <div class="formula-equation">
                                    $$V = \frac{1}{3}\pi r^2 h$$
                                    $$S = \pi r^2 + \pi rl$$
                                </div>
                                <div class="formula-description">
                                    圆锥体的体积和表面积公式，其中r为底面半径，h为高，l为母线长。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    底面半径3，高4的圆锥体体积？<br>
                                    解：$V = \frac{1}{3}\pi × 9 × 4 = 12\pi$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">立体几何</span>
                                    <span class="formula-tag">圆锥</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="椭圆 标准方程">
                                <div class="formula-title">
                                    <i class="fas fa-ellipsis-h"></i> 椭圆标准方程
                                </div>
                                <div class="formula-equation">
                                    $$\frac{x^2}{a^2} + \frac{y^2}{b^2} = 1 \quad (a > b > 0)$$
                                    $$\frac{(x-h)^2}{a^2} + \frac{(y-k)^2}{b^2} = 1$$
                                </div>
                                <div class="formula-description">
                                    椭圆的标准方程，其中a为长半轴，b为短半轴。第二个方程为中心在(h,k)的椭圆。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    求椭圆$\frac{x^2}{25} + \frac{y^2}{16} = 1$的长轴和短轴长度<br>
                                    解：$a^2=25, b^2=16$，所以$a=5, b=4$<br>
                                    长轴长度=2a=10，短轴长度=2b=8
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">椭圆</span>
                                    <span class="formula-tag">标准方程</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="椭圆 焦点 离心率">
                                <div class="formula-title">
                                    <i class="fas fa-crosshairs"></i> 椭圆焦点与离心率
                                </div>
                                <div class="formula-equation">
                                    $$c^2 = a^2 - b^2$$
                                    $$e = \frac{c}{a} \quad (0 < e < 1)$$
                                    $$F_1(-c, 0), F_2(c, 0)$$
                                </div>
                                <div class="formula-description">
                                    椭圆的焦距关系、离心率公式和焦点坐标。c为焦距，e为离心率。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    椭圆$\frac{x^2}{25} + \frac{y^2}{16} = 1$的焦点坐标和离心率？<br>
                                    解：$a=5, b=4$，$c^2=25-16=9$，所以$c=3$<br>
                                    焦点：$(\pm3, 0)$，离心率：$e=\frac{3}{5}=0.6$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">椭圆</span>
                                    <span class="formula-tag">焦点</span>
                                    <span class="formula-tag">离心率</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="椭圆 面积 周长">
                                <div class="formula-title">
                                    <i class="fas fa-crop-alt"></i> 椭圆面积与周长
                                </div>
                                <div class="formula-equation">
                                    $$S = \pi ab$$
                                    $$C \approx \pi[3(a+b) - \sqrt{(3a+b)(a+3b)}]$$
                                </div>
                                <div class="formula-description">
                                    椭圆的面积公式和周长近似公式（拉马努金公式II）。精确周长需用椭圆积分。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    椭圆$\frac{x^2}{25} + \frac{y^2}{16} = 1$的面积？<br>
                                    解：$a=5, b=4$<br>
                                    $S = \pi × 5 × 4 = 20\pi$ 平方单位
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">椭圆</span>
                                    <span class="formula-tag">面积</span>
                                    <span class="formula-tag">周长</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="椭圆 参数方程">
                                <div class="formula-title">
                                    <i class="fas fa-route"></i> 椭圆参数方程
                                </div>
                                <div class="formula-equation">
                                    $$\begin{cases}
                                    x = a\cos t \\
                                    y = b\sin t
                                    \end{cases} \quad (0 \leq t < 2\pi)$$
                                </div>
                                <div class="formula-description">
                                    椭圆的参数方程，参数t为参变数。当t在[0,2π)变化时，点(x,y)描述完整椭圆。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    椭圆$\frac{x^2}{9} + \frac{y^2}{4} = 1$当$t=\frac{\pi}{3}$时的点坐标？<br>
                                    解：$x = 3\cos\frac{\pi}{3} = 3×\frac{1}{2} = \frac{3}{2}$<br>
                                    $y = 2\sin\frac{\pi}{3} = 2×\frac{\sqrt{3}}{2} = \sqrt{3}$<br>
                                    所以点坐标为$(\frac{3}{2}, \sqrt{3})$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">椭圆</span>
                                    <span class="formula-tag">参数方程</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 三角函数公式 -->
                    <div class="formula-panel" id="trigonometry-panel">
                        <div class="formula-grid">
                            <div class="formula-card" data-keywords="基本三角函数 正弦 余弦 正切">
                                <div class="formula-title">
                                    <i class="fas fa-wave-square"></i> 基本三角函数
                                </div>
                                <div class="formula-equation">
                                    $$\sin\theta = \frac{对边}{斜边}$$
                                    $$\cos\theta = \frac{邻边}{斜边}$$
                                    $$\tan\theta = \frac{对边}{邻边} = \frac{\sin\theta}{\cos\theta}$$
                                </div>
                                <div class="formula-description">
                                    直角三角形中三角函数的基本定义。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    在直角三角形中，对边=3，斜边=5，求$\sin\theta$和$\cos\theta$<br>
                                    解：邻边=4，$\sin\theta = \frac{3}{5}$，$\cos\theta = \frac{4}{5}$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">基本函数</span>
                                    <span class="formula-tag">三角函数</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="平方和恒等式">
                                <div class="formula-title">
                                    <i class="fas fa-equals"></i> 平方和恒等式
                                </div>
                                <div class="formula-equation">
                                    $$\sin^2\theta + \cos^2\theta = 1$$
                                    $$1 + \tan^2\theta = \sec^2\theta$$
                                    $$1 + \cot^2\theta = \csc^2\theta$$
                                </div>
                                <div class="formula-description">
                                    三角函数的基本恒等式，这是三角学的基础。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    已知$\sin\theta = \frac{3}{5}$，求$\cos\theta$<br>
                                    解：$\cos^2\theta = 1 - \sin^2\theta = 1 - \frac{9}{25} = \frac{16}{25}$<br>
                                    所以$\cos\theta = \pm\frac{4}{5}$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">恒等式</span>
                                    <span class="formula-tag">平方和</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="和差公式">
                                <div class="formula-title">
                                    <i class="fas fa-plus-minus"></i> 和差公式
                                </div>
                                <div class="formula-equation">
                                    $$\sin(A \pm B) = \sin A \cos B \pm \cos A \sin B$$
                                    $$\cos(A \pm B) = \cos A \cos B \mp \sin A \sin B$$
                                    $$\tan(A \pm B) = \frac{\tan A \pm \tan B}{1 \mp \tan A \tan B}$$
                                </div>
                                <div class="formula-description">
                                    两角和差的三角函数公式，是复合角三角函数计算的基础。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    计算$\sin 75°$<br>
                                    解：$\sin 75° = \sin(45° + 30°)$<br>
                                    $= \sin 45° \cos 30° + \cos 45° \sin 30°$<br>
                                    $= \frac{\sqrt{2}}{2} \cdot \frac{\sqrt{3}}{2} + \frac{\sqrt{2}}{2} \cdot \frac{1}{2} = \frac{\sqrt{6}+\sqrt{2}}{4}$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">和差公式</span>
                                    <span class="formula-tag">复合角</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="二倍角公式">
                                <div class="formula-title">
                                    <i class="fas fa-times"></i> 二倍角公式
                                </div>
                                <div class="formula-equation">
                                    $$\sin 2\theta = 2\sin\theta \cos\theta$$
                                    $$\cos 2\theta = \cos^2\theta - \sin^2\theta = 2\cos^2\theta - 1 = 1 - 2\sin^2\theta$$
                                    $$\tan 2\theta = \frac{2\tan\theta}{1 - \tan^2\theta}$$
                                </div>
                                <div class="formula-description">
                                    二倍角的三角函数公式，是和差公式的特殊情况。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    已知$\sin\theta = \frac{3}{5}$，求$\sin 2\theta$<br>
                                    解：$\cos\theta = \frac{4}{5}$（取正值）<br>
                                    $\sin 2\theta = 2 \cdot \frac{3}{5} \cdot \frac{4}{5} = \frac{24}{25}$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">二倍角</span>
                                    <span class="formula-tag">特殊角</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="半角公式">
                                <div class="formula-title">
                                    <i class="fas fa-divide"></i> 半角公式
                                </div>
                                <div class="formula-equation">
                                    $$\sin\frac{\theta}{2} = \pm\sqrt{\frac{1 - \cos\theta}{2}}$$
                                    $$\cos\frac{\theta}{2} = \pm\sqrt{\frac{1 + \cos\theta}{2}}$$
                                    $$\tan\frac{\theta}{2} = \frac{\sin\theta}{1 + \cos\theta} = \frac{1 - \cos\theta}{\sin\theta}$$
                                </div>
                                <div class="formula-description">
                                    半角的三角函数公式，用于求角度一半的三角函数值。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    求$\sin 15°$<br>
                                    解：$\sin 15° = \sin\frac{30°}{2} = \sqrt{\frac{1-\cos 30°}{2}}$<br>
                                    $= \sqrt{\frac{1-\frac{\sqrt{3}}{2}}{2}} = \frac{\sqrt{6}-\sqrt{2}}{4}$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">半角公式</span>
                                    <span class="formula-tag">特殊值</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="正弦定理">
                                <div class="formula-title">
                                    <i class="fas fa-triangle"></i> 正弦定理
                                </div>
                                <div class="formula-equation">
                                    $$\frac{a}{\sin A} = \frac{b}{\sin B} = \frac{c}{\sin C} = 2R$$
                                </div>
                                <div class="formula-description">
                                    在任意三角形中，边与其对角正弦值的比等于外接圆直径。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    三角形中，$a=8$，$A=60°$，$B=45°$，求边$b$<br>
                                    解：$\frac{b}{\sin 45°} = \frac{8}{\sin 60°}$<br>
                                    $b = \frac{8 \sin 45°}{\sin 60°} = \frac{8 \cdot \frac{\sqrt{2}}{2}}{\frac{\sqrt{3}}{2}} = \frac{4\sqrt{6}}{3}$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">正弦定理</span>
                                    <span class="formula-tag">解三角形</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="余弦定理">
                                <div class="formula-title">
                                    <i class="fas fa-drafting-compass"></i> 余弦定理
                                </div>
                                <div class="formula-equation">
                                    $$c^2 = a^2 + b^2 - 2ab\cos C$$
                                    $$\cos C = \frac{a^2 + b^2 - c^2}{2ab}$$
                                </div>
                                <div class="formula-description">
                                    在任意三角形中，一边的平方等于其他两边平方和减去两倍这两边与其夹角余弦的乘积。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    三角形中，$a=3$，$b=4$，$C=60°$，求边$c$<br>
                                    解：$c^2 = 9 + 16 - 2×3×4×\cos 60°$<br>
                                    $= 25 - 24×\frac{1}{2} = 13$<br>
                                    所以 $c = \sqrt{13}$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">余弦定理</span>
                                    <span class="formula-tag">解三角形</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="积化和差 和差化积">
                                <div class="formula-title">
                                    <i class="fas fa-exchange-alt"></i> 积化和差与和差化积
                                </div>
                                <div class="formula-equation">
                                    $$\sin A \sin B = \frac{1}{2}[\cos(A-B) - \cos(A+B)]$$
                                    $$\cos A \cos B = \frac{1}{2}[\cos(A-B) + \cos(A+B)]$$
                                    $$\sin A + \sin B = 2\sin\frac{A+B}{2}\cos\frac{A-B}{2}$$
                                    $$\cos A + \cos B = 2\cos\frac{A+B}{2}\cos\frac{A-B}{2}$$
                                </div>
                                <div class="formula-description">
                                    三角函数乘积转换为和差形式，以及和差转换为乘积形式的公式。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    化简$\sin 75° + \sin 15°$<br>
                                    解：$\sin 75° + \sin 15° = 2\sin\frac{75°+15°}{2}\cos\frac{75°-15°}{2}$<br>
                                    $= 2\sin 45°\cos 30° = 2 \cdot \frac{\sqrt{2}}{2} \cdot \frac{\sqrt{3}}{2} = \frac{\sqrt{6}}{2}$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">积化和差</span>
                                    <span class="formula-tag">和差化积</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="三角函数周期性">
                                <div class="formula-title">
                                    <i class="fas fa-sync-alt"></i> 三角函数周期性
                                </div>
                                <div class="formula-equation">
                                    $$\sin(x + 2\pi) = \sin x$$
                                    $$\cos(x + 2\pi) = \cos x$$
                                    $$\tan(x + \pi) = \tan x$$
                                </div>
                                <div class="formula-description">
                                    三角函数的周期性质：正弦和余弦函数周期为2π，正切函数周期为π。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    求$\sin 390°$的值<br>
                                    解：$\sin 390° = \sin(360° + 30°) = \sin 30° = \frac{1}{2}$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">周期性</span>
                                    <span class="formula-tag">基本性质</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="特殊角三角函数值">
                                <div class="formula-title">
                                    <i class="fas fa-star"></i> 特殊角三角函数值
                                </div>
                                <div class="formula-equation">
                                    $$\sin 30° = \frac{1}{2}, \cos 30° = \frac{\sqrt{3}}{2}, \tan 30° = \frac{\sqrt{3}}{3}$$
                                    $$\sin 45° = \frac{\sqrt{2}}{2}, \cos 45° = \frac{\sqrt{2}}{2}, \tan 45° = 1$$
                                    $$\sin 60° = \frac{\sqrt{3}}{2}, \cos 60° = \frac{1}{2}, \tan 60° = \sqrt{3}$$
                                </div>
                                <div class="formula-description">
                                    常用特殊角（30°、45°、60°）的三角函数值，需要熟记。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">记忆方法：</div>
                                    正弦值：$\frac{1}{2}$、$\frac{\sqrt{2}}{2}$、$\frac{\sqrt{3}}{2}$（分子递增）<br>
                                    余弦值：$\frac{\sqrt{3}}{2}$、$\frac{\sqrt{2}}{2}$、$\frac{1}{2}$（分子递减）
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">特殊角</span>
                                    <span class="formula-tag">常用值</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 统计公式 -->
                    <div class="formula-panel" id="statistics-panel">
                        <div class="formula-grid">
                            <div class="formula-card" data-keywords="平均数 均值">
                                <div class="formula-title">
                                    <i class="fas fa-chart-line"></i> 平均数（均值）
                                </div>
                                <div class="formula-equation">
                                    $$\bar{x} = \frac{x_1 + x_2 + ... + x_n}{n} = \frac{\sum_{i=1}^{n} x_i}{n}$$
                                </div>
                                <div class="formula-description">
                                    算术平均数是所有数据的总和除以数据个数。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    数据：3, 5, 7, 9, 11，求平均数<br>
                                    解：$\bar{x} = \frac{3+5+7+9+11}{5} = \frac{35}{5} = 7$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">平均数</span>
                                    <span class="formula-tag">描述统计</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="中位数">
                                <div class="formula-title">
                                    <i class="fas fa-sort-amount-up"></i> 中位数
                                </div>
                                <div class="formula-equation">
                                    $$M = \begin{cases}
                                    x_{(n+1)/2} & \text{当n为奇数} \\
                                    \frac{x_{n/2} + x_{n/2+1}}{2} & \text{当n为偶数}
                                    \end{cases}$$
                                </div>
                                <div class="formula-description">
                                    将数据按大小排列后，位于中间位置的数值。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    数据：1, 3, 5, 7, 9（已排序），求中位数<br>
                                    解：n=5为奇数，中位数 = $x_3 = 5$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">中位数</span>
                                    <span class="formula-tag">描述统计</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="方差 标准差">
                                <div class="formula-title">
                                    <i class="fas fa-random"></i> 方差和标准差
                                </div>
                                <div class="formula-equation">
                                    $$s^2 = \frac{\sum_{i=1}^{n}(x_i - \bar{x})^2}{n-1}$$
                                    $$s = \sqrt{s^2}$$
                                </div>
                                <div class="formula-description">
                                    方差衡量数据的离散程度，标准差是方差的平方根。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    数据：1, 3, 5，求方差<br>
                                    解：$\bar{x} = 3$，$s^2 = \frac{(1-3)^2+(3-3)^2+(5-3)^2}{3-1} = 4$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">方差</span>
                                    <span class="formula-tag">标准差</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="概率">
                                <div class="formula-title">
                                    <i class="fas fa-dice"></i> 基本概率
                                </div>
                                <div class="formula-equation">
                                    $$P(A) = \frac{有利结果数}{总结果数}$$
                                    $$P(A \cup B) = P(A) + P(B) - P(A \cap B)$$
                                    $$P(A \cap B) = P(A) \cdot P(B|A)$$
                                </div>
                                <div class="formula-description">
                                    基本概率公式：古典概率、加法公式、乘法公式。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    投掷一枚骰子，求得到偶数的概率<br>
                                    解：偶数有2,4,6共3个，$P = \frac{3}{6} = \frac{1}{2}$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">概率</span>
                                    <span class="formula-tag">基本公式</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="排列组合">
                                <div class="formula-title">
                                    <i class="fas fa-list-ol"></i> 排列与组合
                                </div>
                                <div class="formula-equation">
                                    $$A_n^m = \frac{n!}{(n-m)!}$$
                                    $$C_n^m = \binom{n}{m} = \frac{n!}{m!(n-m)!}$$
                                </div>
                                <div class="formula-description">
                                    排列考虑顺序，组合不考虑顺序。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    从5个人中选3人排成一排，有多少种排法？<br>
                                    解：$A_5^3 = \frac{5!}{2!} = \frac{120}{2} = 60$种
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">排列组合</span>
                                    <span class="formula-tag">计数原理</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="二项分布">
                                <div class="formula-title">
                                    <i class="fas fa-chart-bar"></i> 二项分布
                                </div>
                                <div class="formula-equation">
                                    $$P(X = k) = C_n^k p^k (1-p)^{n-k}$$
                                    $$E(X) = np, Var(X) = np(1-p)$$
                                </div>
                                <div class="formula-description">
                                    n次独立重复试验中成功k次的概率，期望和方差公式。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    投掷10次硬币，恰好5次正面朝上的概率？<br>
                                    解：$P(X=5) = C_{10}^5 \cdot 0.5^5 \cdot 0.5^5 = 252 \cdot 0.5^{10} ≈ 0.246$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">二项分布</span>
                                    <span class="formula-tag">概率分布</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 微积分公式 -->
                    <div class="formula-panel" id="calculus-panel">
                        <div class="formula-grid">
                            <div class="formula-card" data-keywords="导数 求导">
                                <div class="formula-title">
                                    <i class="fas fa-chart-line"></i> 基本导数公式
                                </div>
                                <div class="formula-equation">
                                    $$\frac{d}{dx}(x^n) = nx^{n-1}$$
                                    $$\frac{d}{dx}(e^x) = e^x$$
                                    $$\frac{d}{dx}(\ln x) = \frac{1}{x}$$
                                    $$\frac{d}{dx}(\sin x) = \cos x$$
                                    $$\frac{d}{dx}(\cos x) = -\sin x$$
                                </div>
                                <div class="formula-description">
                                    常用函数的导数公式，是微分学的基础。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    求$f(x) = x^3$的导数<br>
                                    解：$f'(x) = 3x^2$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">导数</span>
                                    <span class="formula-tag">基本公式</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="求导法则">
                                <div class="formula-title">
                                    <i class="fas fa-cogs"></i> 导数运算法则
                                </div>
                                <div class="formula-equation">
                                    $$(u \pm v)' = u' \pm v'$$
                                    $$(uv)' = u'v + uv'$$
                                    $$\left(\frac{u}{v}\right)' = \frac{u'v - uv'}{v^2}$$
                                    $$[f(g(x))]' = f'(g(x)) \cdot g'(x)$$
                                </div>
                                <div class="formula-description">
                                    导数的四则运算法则和复合函数求导法则（链式法则）。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    求$(x^2 \sin x)'$<br>
                                    解：$(x^2 \sin x)' = 2x \sin x + x^2 \cos x$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">求导法则</span>
                                    <span class="formula-tag">运算规则</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="不定积分 积分">
                                <div class="formula-title">
                                    <i class="fas fa-integral"></i> 基本积分公式
                                </div>
                                <div class="formula-equation">
                                    $$\int x^n dx = \frac{x^{n+1}}{n+1} + C \quad (n \neq -1)$$
                                    $$\int e^x dx = e^x + C$$
                                    $$\int \frac{1}{x} dx = \ln|x| + C$$
                                    $$\int \sin x dx = -\cos x + C$$
                                    $$\int \cos x dx = \sin x + C$$
                                </div>
                                <div class="formula-description">
                                    常用函数的不定积分公式，积分常数C不可省略。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    求$\int 2x dx$<br>
                                    解：$\int 2x dx = x^2 + C$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">积分</span>
                                    <span class="formula-tag">基本公式</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="定积分 牛顿莱布尼兹">
                                <div class="formula-title">
                                    <i class="fas fa-square-root-alt"></i> 牛顿-莱布尼兹公式
                                </div>
                                <div class="formula-equation">
                                    $$\int_a^b f(x) dx = F(b) - F(a)$$
                                </div>
                                <div class="formula-description">
                                    其中F(x)是f(x)的一个原函数。这是连接微分和积分的基本定理。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    计算$\int_0^2 x^2 dx$<br>
                                    解：$\int_0^2 x^2 dx = \left[\frac{x^3}{3}\right]_0^2 = \frac{8}{3} - 0 = \frac{8}{3}$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">定积分</span>
                                    <span class="formula-tag">基本定理</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="分部积分">
                                <div class="formula-title">
                                    <i class="fas fa-expand-arrows-alt"></i> 分部积分法
                                </div>
                                <div class="formula-equation">
                                    $$\int u dv = uv - \int v du$$
                                </div>
                                <div class="formula-description">
                                    用于计算两个函数乘积的积分，选择合适的u和dv是关键。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    计算$\int x e^x dx$<br>
                                    解：令$u=x, dv=e^x dx$，则$du=dx, v=e^x$<br>
                                    $\int x e^x dx = xe^x - \int e^x dx = xe^x - e^x + C = e^x(x-1) + C$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">分部积分</span>
                                    <span class="formula-tag">积分技巧</span>
                                </div>
                            </div>

                            <div class="formula-card" data-keywords="极限">
                                <div class="formula-title">
                                    <i class="fas fa-arrow-right"></i> 重要极限
                                </div>
                                <div class="formula-equation">
                                    $$\lim_{x \to 0} \frac{\sin x}{x} = 1$$
                                    $$\lim_{x \to \infty} \left(1 + \frac{1}{x}\right)^x = e$$
                                    $$\lim_{x \to 0} \frac{1 - \cos x}{x^2} = \frac{1}{2}$$
                                </div>
                                <div class="formula-description">
                                    微积分中的重要极限公式，常用于求解未定式极限。
                                </div>
                                <div class="formula-example">
                                    <div class="example-title">例题：</div>
                                    求$\lim_{x \to 0} \frac{\sin 3x}{x}$<br>
                                    解：$\lim_{x \to 0} \frac{\sin 3x}{x} = 3 \lim_{x \to 0} \frac{\sin 3x}{3x} = 3 \cdot 1 = 3$
                                </div>
                                <div class="formula-tags">
                                    <span class="formula-tag">极限</span>
                                    <span class="formula-tag">重要公式</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="main-footer">
        <div class="container">
            <div class="footer-content">
                <p class="copyright-text">study-llm.me域名为Alex所有。保留所有权利。</p>
            </div>
        </div>
    </footer>

    <script src="../../js/common.js"></script>
    <script src="../../js/navigation.js"></script>
    <script>
        // 数学公式参考功能
        class MathFormulas {
            constructor() {
                this.currentTab = 'algebra';
                this.isMobile = window.innerWidth <= 768;
                this.initializeEventListeners();
                this.setupResponsiveHandling();
                this.initializeMathJax();
                this.handleFormulaOverflow();
            }

            initializeEventListeners() {
                // 标签切换
                document.querySelectorAll('.formulas-tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.switchTab(e.target.closest('.formulas-tab').dataset.tab);
                    });

                    // Add touch support for better mobile interaction
                    tab.addEventListener('touchstart', (e) => {
                        e.target.style.backgroundColor = 'rgba(67, 97, 238, 0.1)';
                    });

                    tab.addEventListener('touchend', (e) => {
                        setTimeout(() => {
                            e.target.style.backgroundColor = '';
                        }, 150);
                    });
                });

                // Window resize handler
                window.addEventListener('resize', this.debounce(() => {
                    this.handleResize();
                }, 250));

                // Orientation change handler for mobile
                window.addEventListener('orientationchange', () => {
                    setTimeout(() => {
                        this.handleResize();
                        this.rerenderMathJax();
                    }, 500);
                });
            }

            setupResponsiveHandling() {
                // Check if device has touch capability
                this.hasTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
                
                // Add responsive classes
                document.body.classList.toggle('touch-device', this.hasTouch);
                document.body.classList.toggle('mobile-device', this.isMobile);
            }

            initializeMathJax() {
                if (typeof MathJax !== 'undefined') {
                    // Wait for MathJax to be fully loaded
                    MathJax.startup.promise.then(() => {
                        this.rerenderMathJax();
                        this.handleFormulaOverflow();
                    }).catch((err) => {
                        console.warn('MathJax initialization error:', err);
                    });
                } else {
                    // Fallback: retry after a delay
                    setTimeout(() => this.initializeMathJax(), 1000);
                }
            }

            switchTab(tabName) {
                if (!tabName || this.currentTab === tabName) return;

                // Update tab states
                document.querySelectorAll('.formulas-tab').forEach(tab => {
                    tab.classList.remove('active');
                    tab.setAttribute('aria-selected', 'false');
                });
                
                const activeTab = document.querySelector(`[data-tab="${tabName}"]`);
                if (activeTab) {
                    activeTab.classList.add('active');
                    activeTab.setAttribute('aria-selected', 'true');
                }

                // Update panel visibility
                document.querySelectorAll('.formula-panel').forEach(panel => {
                    panel.classList.remove('active');
                    panel.setAttribute('aria-hidden', 'true');
                });
                
                const activePanel = document.getElementById(`${tabName}-panel`);
                if (activePanel) {
                    activePanel.classList.add('active');
                    activePanel.setAttribute('aria-hidden', 'false');
                }

                this.currentTab = tabName;

                // Re-render MathJax for the new tab
                this.rerenderMathJax();
                
                // Scroll tab into view on mobile
                if (this.isMobile) {
                    activeTab?.scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'nearest', 
                        inline: 'center' 
                    });
                }
            }

            rerenderMathJax() {
                if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) {
                    // Clear and re-render MathJax
                    const activePanel = document.querySelector('.formula-panel.active');
                    if (activePanel) {
                        MathJax.typesetClear([activePanel]);
                        MathJax.typesetPromise([activePanel]).then(() => {
                            this.handleFormulaOverflow();
                            this.optimizeMathJaxForMobile();
                        }).catch((err) => {
                            console.warn('MathJax typeset error:', err);
                        });
                    }
                }
            }

            handleFormulaOverflow() {
                // Handle overflow for formula equations
                const equations = document.querySelectorAll('.formula-equation');
                equations.forEach(equation => {
                    const mathElements = equation.querySelectorAll('.MathJax, .MathJax_Display');
                    mathElements.forEach(math => {
                        const rect = math.getBoundingClientRect();
                        const containerRect = equation.getBoundingClientRect();
                        
                        if (rect.width > containerRect.width) {
                            equation.style.overflowX = 'auto';
                            equation.classList.add('scrollable-formula');
                            
                            // Add scroll indicators for mobile
                            if (this.isMobile) {
                                this.addScrollIndicators(equation);
                            }
                        }
                    });
                });
            }

            addScrollIndicators(element) {
                if (element.querySelector('.scroll-indicator')) return;
                
                const indicator = document.createElement('div');
                indicator.className = 'scroll-indicator';
                indicator.innerHTML = '← 滑动查看完整公式 →';
                indicator.style.cssText = `
                    position: absolute;
                    top: -20px;
                    right: 0;
                    font-size: 10px;
                    color: #999;
                    background: rgba(255,255,255,0.9);
                    padding: 2px 6px;
                    border-radius: 3px;
                    pointer-events: none;
                    z-index: 10;
                `;
                
                element.style.position = 'relative';
                element.appendChild(indicator);
                
                // Hide indicator after scrolling starts
                element.addEventListener('scroll', () => {
                    indicator.style.opacity = '0.5';
                }, { once: true });
            }

            optimizeMathJaxForMobile() {
                if (!this.isMobile) return;
                
                const mathElements = document.querySelectorAll('.MathJax svg');
                mathElements.forEach(svg => {
                    // Ensure SVG is responsive
                    svg.style.maxWidth = '100%';
                    svg.style.height = 'auto';
                    
                    // Scale down if too large
                    const rect = svg.getBoundingClientRect();
                    if (rect.width > window.innerWidth * 0.9) {
                        const scale = (window.innerWidth * 0.9) / rect.width;
                        svg.style.transform = `scale(${scale})`;
                        svg.style.transformOrigin = 'left center';
                    }
                });
            }

            handleResize() {
                const newIsMobile = window.innerWidth <= 768;
                
                if (newIsMobile !== this.isMobile) {
                    this.isMobile = newIsMobile;
                    document.body.classList.toggle('mobile-device', this.isMobile);
                    
                    // Re-render MathJax with new size constraints
                    setTimeout(() => {
                        this.rerenderMathJax();
                    }, 100);
                }
                
                this.handleFormulaOverflow();
            }

            // Utility function for debouncing
            debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }

            // Add keyboard navigation support
            setupKeyboardNavigation() {
                document.addEventListener('keydown', (e) => {
                    if (e.target.classList.contains('formulas-tab')) {
                        const tabs = Array.from(document.querySelectorAll('.formulas-tab'));
                        const currentIndex = tabs.indexOf(e.target);
                        
                        let newIndex = currentIndex;
                        
                        switch (e.key) {
                            case 'ArrowLeft':
                                newIndex = currentIndex > 0 ? currentIndex - 1 : tabs.length - 1;
                                break;
                            case 'ArrowRight':
                                newIndex = currentIndex < tabs.length - 1 ? currentIndex + 1 : 0;
                                break;
                            case 'Enter':
                            case ' ':
                                e.preventDefault();
                                this.switchTab(e.target.dataset.tab);
                                return;
                        }
                        
                        if (newIndex !== currentIndex) {
                            e.preventDefault();
                            tabs[newIndex].focus();
                        }
                    }
                });
            }
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            const mathFormulas = new MathFormulas();
            mathFormulas.setupKeyboardNavigation();
            
            // Additional mobile optimizations
            if (/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                document.body.classList.add('mobile-browser');
                
                // Prevent zoom on input focus for iOS
                const viewport = document.querySelector('meta[name="viewport"]');
                if (viewport) {
                    viewport.content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no';
                }
            }
        });

        // Handle page visibility changes to re-render MathJax if needed
        document.addEventListener('visibilitychange', () => {
            if (!document.hidden && typeof MathJax !== 'undefined') {
                setTimeout(() => {
                    MathJax.typesetPromise().catch(err => console.warn('MathJax re-render error:', err));
                }, 100);
            }
        });
    </script>
</body>
</html> 