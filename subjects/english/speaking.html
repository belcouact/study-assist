<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>口语练习 - 英语学习助手</title>
    <link rel="icon" href="../../assets/icons/logo_btrfly.ico" type="image/x-icon">
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../../css/components.css">
    <link rel="stylesheet" href="../../css/utilities.css">
    <link rel="stylesheet" href="../../css/responsive.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        .speaking-hero {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            padding: 4rem 0;
            text-align: center;
        }

        .speaking-hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .speaking-hero p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }

        .speaking-tabs {
            display: flex;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin: 2rem 0;
            overflow: hidden;
        }

        .speaking-tab {
            flex: 1;
            padding: 1rem 2rem;
            background: #f8f9fa;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .speaking-tab.active {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
        }

        .speaking-tab:hover:not(.active) {
            background: #e9ecef;
        }

        .speaking-content {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .speaking-panel {
            display: none;
        }

        .speaking-panel.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .scenario-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .scenario-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .scenario-card:hover {
            background: #e9ecef;
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .scenario-card.selected {
            border-color: #ff6b6b;
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(238, 90, 36, 0.1));
        }

        .scenario-card h3 {
            color: #ff6b6b;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .dialogue-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 2rem;
            margin-top: 2rem;
        }

        .dialogue-message {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            position: relative;
        }

        .dialogue-message.user {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(238, 90, 36, 0.1));
            border-left: 4px solid #ff6b6b;
        }

        .dialogue-message.assistant {
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.1), rgba(155, 89, 182, 0.1));
            border-left: 4px solid #3498db;
        }

        .message-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .message-content {
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .pronunciation-word {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            text-align: center;
        }

        .pronunciation-word h3 {
            color: #e17055;
            margin-bottom: 0.5rem;
        }

        .phonetic {
            font-size: 1.2rem;
            color: #636e72;
            margin: 0.5rem 0;
        }

        .audio-controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 1rem 0;
        }

        .audio-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 50px;
            padding: 0.8rem 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .audio-btn:hover {
            background: #ee5a24;
            transform: translateY(-2px);
        }

        .recording-status {
            text-align: center;
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
        }

        .recording-status.recording {
            background: #ff6b6b;
            color: white;
            animation: pulse 1.5s infinite;
        }

        .recording-status.ready {
            background: #00b894;
            color: white;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        .conversation-flow {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .conversation-step {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            transition: all 0.3s ease;
        }

        .conversation-step:hover {
            background: #f8f9fa;
        }

        .step-number {
            background: #ff6b6b;
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
        }

        .step-title {
            font-weight: 600;
            color: #2d3436;
            margin-bottom: 0.25rem;
        }

        .step-description {
            color: #636e72;
            font-size: 0.9rem;
        }

        .practice-area {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 2rem;
            margin-top: 2rem;
        }

        .phrase-card {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-left: 4px solid #ff6b6b;
        }

        .phrase-english {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2d3436;
            margin-bottom: 0.5rem;
        }

        .phrase-chinese {
            color: #636e72;
            margin-bottom: 0.5rem;
        }

        .phrase-usage {
            font-size: 0.9rem;
            color: #74b9ff;
            font-style: italic;
        }

        .difficulty-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .difficulty-elementary {
            background: #00b894;
            color: white;
        }

        .difficulty-intermediate {
            background: #fdcb6e;
            color: #2d3436;
        }

        .difficulty-advanced {
            background: #e17055;
            color: white;
        }

        @media (max-width: 768px) {
            .speaking-tabs {
                flex-direction: column;
            }

            .speaking-tab {
                padding: 0.8rem 1rem;
            }

            .speaking-hero h1 {
                font-size: 2rem;
            }

            .scenario-grid {
                grid-template-columns: 1fr;
            }

            .audio-controls {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="../../index.html">
                        <i class="fas fa-graduation-cap" style="background: linear-gradient(90deg, #4361ee, #7209b7); -webkit-background-clip: text; background-clip: text; color: transparent;"></i>
                        <span class="gradient-text">Alex的学习助手</span>
                    </a>
                </div>
                <nav class="main-nav">
                    <ul>
                        <li><a href="../../index.html">首页</a></li>
                        <li><a href="../../index.html#subjects">科目</a></li>
                        <li><a href="../../tts.html">语音</a></li>
                        <li><a href="../../draw.html">绘图</a></li>
                        <li><a href="main.html">返回英语</a></li>
                    </ul>
                </nav>
                <button class="mobile-menu-toggle" aria-label="切换菜单">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </header>

    <main>
        <!-- Hero Section -->
        <section class="speaking-hero">
            <div class="container">
                <h1><i class="fas fa-comments"></i> 口语练习</h1>
                <p>通过真实对话场景和发音练习提高您的英语口语表达能力</p>
            </div>
        </section>

        <!-- Main Content -->
        <section class="main-content">
            <div class="container">
                <!-- Speaking Tabs -->
                <div class="speaking-tabs">
                    <button class="speaking-tab active" data-tab="scenarios">
                        <i class="fas fa-theater-masks"></i> 对话场景
                    </button>
                    <button class="speaking-tab" data-tab="pronunciation">
                        <i class="fas fa-microphone"></i> 发音练习
                    </button>
                    <button class="speaking-tab" data-tab="phrases">
                        <i class="fas fa-quote-left"></i> 实用表达
                    </button>
                    <button class="speaking-tab" data-tab="conversation">
                        <i class="fas fa-comments"></i> 模拟对话
                    </button>
                </div>

                <!-- Scenarios Panel -->
                <div id="scenarios-panel" class="speaking-content speaking-panel active">
                    <h2><i class="fas fa-theater-masks"></i> 选择对话场景</h2>
                    <div class="scenario-grid">
                        <div class="scenario-card" data-scenario="daily">
                            <h3><i class="fas fa-home"></i> 日常对话</h3>
                            <p>日常生活中的基本交流，如问候、购物、用餐等</p>
                            <span class="difficulty-badge difficulty-elementary">初级</span>
                        </div>
                        <div class="scenario-card" data-scenario="travel">
                            <h3><i class="fas fa-plane"></i> 旅行交流</h3>
                            <p>机场、酒店、餐厅、问路等旅行场景对话</p>
                            <span class="difficulty-badge difficulty-intermediate">中级</span>
                        </div>
                        <div class="scenario-card" data-scenario="business">
                            <h3><i class="fas fa-briefcase"></i> 商务会谈</h3>
                            <p>会议、谈判、演示等商务场景的专业对话</p>
                            <span class="difficulty-badge difficulty-advanced">高级</span>
                        </div>
                        <div class="scenario-card" data-scenario="academic">
                            <h3><i class="fas fa-graduation-cap"></i> 学术讨论</h3>
                            <p>课堂讨论、学术交流、研究汇报等场景</p>
                            <span class="difficulty-badge difficulty-advanced">高级</span>
                        </div>
                        <div class="scenario-card" data-scenario="social">
                            <h3><i class="fas fa-users"></i> 社交聚会</h3>
                            <p>聚会、约会、朋友聚餐等社交场合对话</p>
                            <span class="difficulty-badge difficulty-intermediate">中级</span>
                        </div>
                        <div class="scenario-card" data-scenario="interview">
                            <h3><i class="fas fa-user-tie"></i> 面试对话</h3>
                            <p>求职面试、自我介绍、回答问题等场景</p>
                            <span class="difficulty-badge difficulty-advanced">高级</span>
                        </div>
                    </div>
                    <div id="scenario-content" class="dialogue-container" style="display: none;">
                        <!-- Scenario content will be loaded here -->
                    </div>
                </div>

                <!-- Pronunciation Panel -->
                <div id="pronunciation-panel" class="speaking-content speaking-panel">
                    <h2><i class="fas fa-microphone"></i> 发音练习</h2>
                    <div class="form-group">
                        <label for="pronunciation-category">选择练习类别：</label>
                        <select id="pronunciation-category" class="form-control">
                            <option value="vowels">元音发音</option>
                            <option value="consonants">辅音发音</option>
                            <option value="difficult">易混淆音</option>
                            <option value="words">常用单词</option>
                            <option value="sentences">句子练习</option>
                        </select>
                    </div>
                    <button id="start-pronunciation" class="btn btn-primary">
                        <i class="fas fa-play"></i> 开始练习
                    </button>
                    <div id="pronunciation-content" class="practice-area" style="display: none;">
                        <!-- Pronunciation content will be loaded here -->
                    </div>
                </div>

                <!-- Phrases Panel -->
                <div id="phrases-panel" class="speaking-content speaking-panel">
                    <h2><i class="fas fa-quote-left"></i> 实用表达</h2>
                    <div class="form-group">
                        <label for="phrase-category">选择表达类别：</label>
                        <select id="phrase-category" class="form-control">
                            <option value="greetings">问候用语</option>
                            <option value="opinions">表达观点</option>
                            <option value="emotions">情感表达</option>
                            <option value="requests">请求帮助</option>
                            <option value="agreement">同意/反对</option>
                            <option value="transitions">话题转换</option>
                        </select>
                    </div>
                    <button id="load-phrases" class="btn btn-primary">
                        <i class="fas fa-list"></i> 加载表达
                    </button>
                    <div id="phrases-content" class="practice-area" style="display: none;">
                        <!-- Phrases content will be loaded here -->
                    </div>
                </div>

                <!-- Conversation Panel -->
                <div id="conversation-panel" class="speaking-content speaking-panel">
                    <h2><i class="fas fa-comments"></i> 模拟对话</h2>
                    <p>与AI进行实时对话练习，提高口语流利度</p>
                    <div class="form-group">
                        <label for="conversation-topic">选择对话主题：</label>
                        <select id="conversation-topic" class="form-control">
                            <option value="introduction">自我介绍</option>
                            <option value="hobbies">兴趣爱好</option>
                            <option value="weather">天气话题</option>
                            <option value="food">美食讨论</option>
                            <option value="travel">旅行经历</option>
                            <option value="work">工作话题</option>
                        </select>
                    </div>
                    <button id="start-conversation" class="btn btn-primary">
                        <i class="fas fa-play-circle"></i> 开始对话
                    </button>
                    <div id="conversation-area" class="dialogue-container" style="display: none;">
                        <div id="conversation-messages"></div>
                        <div class="audio-controls">
                            <button id="record-btn" class="audio-btn">
                                <i class="fas fa-microphone"></i> 开始录音
                            </button>
                            <button id="stop-record-btn" class="audio-btn" style="display: none;">
                                <i class="fas fa-stop"></i> 停止录音
                            </button>
                        </div>
                        <div id="recording-status" class="recording-status" style="display: none;"></div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="main-footer">
        <div class="container">
            <div class="footer-content">
                <p class="copyright-text">study-llm.me域名为Alex所有。保留所有权利。</p>
                <div class="profile-section">
                    <button id="profile-button" class="profile-button">
                        <i class="fas fa-user-circle"></i>
                        学习阶段
                    </button>
                    <div id="profile-display" class="profile-display"></div>
                </div>
            </div>
        </div>
    </footer>

    <script src="../../js/common.js"></script>
    <script src="../../js/navigation.js"></script>
    <script src="../../js/profile.js"></script>
    <script>
        // Speaking practice data
        const scenarioData = {
            daily: {
                title: "日常对话",
                dialogues: [
                    {
                        situation: "在咖啡店点餐",
                        conversation: [
                            { speaker: "Barista", text: "Good morning! What can I get for you today?", chinese: "早上好！今天您想要什么？" },
                            { speaker: "Customer", text: "Hi! I'd like a large coffee with milk, please.", chinese: "你好！我想要一杯大杯加牛奶的咖啡。" },
                            { speaker: "Barista", text: "Would you like anything else? We have fresh pastries.", chinese: "您还需要别的吗？我们有新鲜的糕点。" },
                            { speaker: "Customer", text: "That sounds great! I'll take a croissant too.", chinese: "听起来不错！我也要一个羊角面包。" }
                        ]
                    },
                    {
                        situation: "问路",
                        conversation: [
                            { speaker: "Tourist", text: "Excuse me, could you help me find the subway station?", chinese: "打扰一下，您能帮我找到地铁站吗？" },
                            { speaker: "Local", text: "Of course! Go straight for two blocks, then turn left.", chinese: "当然可以！直走两个街区，然后左转。" },
                            { speaker: "Tourist", text: "Thank you so much! How long does it take to walk there?", chinese: "非常感谢！走到那里需要多长时间？" },
                            { speaker: "Local", text: "About 5 minutes. You can't miss it!", chinese: "大约5分钟。您不会错过的！" }
                        ]
                    }
                ]
            },
            travel: {
                title: "旅行交流",
                dialogues: [
                    {
                        situation: "机场办理登机手续",
                        conversation: [
                            { speaker: "Agent", text: "Good afternoon! May I see your passport and ticket?", chinese: "下午好！可以看一下您的护照和机票吗？" },
                            { speaker: "Passenger", text: "Here you are. I'd like a window seat if possible.", chinese: "给您。如果可能的话，我想要靠窗的座位。" },
                            { speaker: "Agent", text: "Let me check... Yes, I can give you 15A. Any bags to check?", chinese: "让我查一下...是的，我可以给您15A。有行李需要托运吗？" },
                            { speaker: "Passenger", text: "Just this one suitcase. When does boarding start?", chinese: "就这一个行李箱。什么时候开始登机？" }
                        ]
                    }
                ]
            },
            business: {
                title: "商务会谈",
                dialogues: [
                    {
                        situation: "会议开场",
                        conversation: [
                            { speaker: "Manager", text: "Good morning everyone. Let's begin today's meeting.", chinese: "大家早上好。让我们开始今天的会议。" },
                            { speaker: "Colleague", text: "Before we start, could we review the agenda?", chinese: "在开始之前，我们能回顾一下议程吗？" },
                            { speaker: "Manager", text: "Certainly. We'll discuss the quarterly results first.", chinese: "当然可以。我们首先讨论季度业绩。" },
                            { speaker: "Colleague", text: "That sounds good. I have the latest figures ready.", chinese: "听起来不错。我已经准备好最新的数据。" }
                        ]
                    }
                ]
            }
        };

        const pronunciationData = {
            vowels: [
                { word: "beat", phonetic: "/biːt/", chinese: "击败", audio: "vowel_ee.mp3" },
                { word: "bit", phonetic: "/bɪt/", chinese: "一点", audio: "vowel_i.mp3" },
                { word: "bat", phonetic: "/bæt/", chinese: "蝙蝠", audio: "vowel_ae.mp3" },
                { word: "but", phonetic: "/bʌt/", chinese: "但是", audio: "vowel_u.mp3" }
            ],
            consonants: [
                { word: "think", phonetic: "/θɪŋk/", chinese: "思考", audio: "consonant_th.mp3" },
                { word: "this", phonetic: "/ðɪs/", chinese: "这个", audio: "consonant_dh.mp3" },
                { word: "ship", phonetic: "/ʃɪp/", chinese: "船", audio: "consonant_sh.mp3" },
                { word: "chip", phonetic: "/tʃɪp/", chinese: "芯片", audio: "consonant_ch.mp3" }
            ],
            difficult: [
                { word: "light", phonetic: "/laɪt/", chinese: "光", audio: "difficult_l.mp3" },
                { word: "right", phonetic: "/raɪt/", chinese: "右边", audio: "difficult_r.mp3" },
                { word: "very", phonetic: "/ˈveri/", chinese: "非常", audio: "difficult_v.mp3" },
                { word: "berry", phonetic: "/ˈberi/", chinese: "浆果", audio: "difficult_b.mp3" }
            ]
        };

        const phrasesData = {
            greetings: [
                { english: "How are you doing?", chinese: "你好吗？", usage: "非正式问候" },
                { english: "Nice to meet you.", chinese: "很高兴见到你。", usage: "初次见面" },
                { english: "How's everything going?", chinese: "一切都好吗？", usage: "关心近况" },
                { english: "Long time no see!", chinese: "好久不见！", usage: "久别重逢" }
            ],
            opinions: [
                { english: "I think that...", chinese: "我认为...", usage: "表达观点" },
                { english: "In my opinion...", chinese: "在我看来...", usage: "个人意见" },
                { english: "I believe that...", chinese: "我相信...", usage: "表达信念" },
                { english: "From my perspective...", chinese: "从我的角度来看...", usage: "个人视角" }
            ],
            emotions: [
                { english: "I'm thrilled about...", chinese: "我对...感到兴奋", usage: "表达兴奋" },
                { english: "I'm concerned about...", chinese: "我对...感到担心", usage: "表达担忧" },
                { english: "I'm disappointed that...", chinese: "我对...感到失望", usage: "表达失望" },
                { english: "I'm grateful for...", chinese: "我对...感到感激", usage: "表达感谢" }
            ]
        };

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            initSpeakingTabs();
            initScenarioCards();
            initPronunciationSystem();
            initPhrasesSystem();
            initConversationSystem();
        });

        // Tab system
        function initSpeakingTabs() {
            const tabs = document.querySelectorAll('.speaking-tab');
            const panels = document.querySelectorAll('.speaking-panel');

            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const targetPanel = this.getAttribute('data-tab') + '-panel';
                    
                    // Update active tab
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Update active panel
                    panels.forEach(p => p.classList.remove('active'));
                    document.getElementById(targetPanel).classList.add('active');
                });
            });
        }

        // Scenario cards
        function initScenarioCards() {
            const scenarioCards = document.querySelectorAll('[data-scenario]');
            const scenarioContent = document.getElementById('scenario-content');

            scenarioCards.forEach(card => {
                card.addEventListener('click', function() {
                    const scenario = this.getAttribute('data-scenario');
                    
                    // Update selected card
                    scenarioCards.forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    // Load scenario content
                    loadScenarioContent(scenario, scenarioContent);
                });
            });
        }

        function loadScenarioContent(scenario, container) {
            const data = scenarioData[scenario];
            if (!data) return;

            let html = `<h3><i class="fas fa-theater-masks"></i> ${data.title}</h3>`;
            
            data.dialogues.forEach((dialogue, index) => {
                html += `
                    <div class="conversation-flow">
                        <h4><i class="fas fa-map-marker-alt"></i> 场景：${dialogue.situation}</h4>
                        ${dialogue.conversation.map((line, lineIndex) => `
                            <div class="dialogue-message ${line.speaker === 'Customer' || line.speaker === 'Tourist' || line.speaker === 'Passenger' || line.speaker === 'Colleague' ? 'user' : 'assistant'}">
                                <div class="message-header">
                                    <i class="fas fa-user"></i> ${line.speaker}
                                </div>
                                <div class="message-content">
                                    <div class="phrase-english">${line.text}</div>
                                    <div class="phrase-chinese">${line.chinese}</div>
                                    <div class="audio-controls">
                                        <button class="audio-btn" onclick="speakText('${line.text}')">
                                            <i class="fas fa-volume-up"></i> 播放
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            });

            container.innerHTML = html;
            container.style.display = 'block';
        }

        // Pronunciation system
        function initPronunciationSystem() {
            const startBtn = document.getElementById('start-pronunciation');
            const container = document.getElementById('pronunciation-content');

            startBtn.addEventListener('click', function() {
                const category = document.getElementById('pronunciation-category').value;
                loadPronunciationContent(category, container);
            });
        }

        function loadPronunciationContent(category, container) {
            const data = pronunciationData[category];
            if (!data) return;

            let html = `<h3><i class="fas fa-microphone"></i> ${category === 'vowels' ? '元音' : category === 'consonants' ? '辅音' : '易混淆音'}练习</h3>`;
            
            data.forEach(item => {
                html += `
                    <div class="pronunciation-word">
                        <h3>${item.word}</h3>
                        <div class="phonetic">${item.phonetic}</div>
                        <div class="phrase-chinese">${item.chinese}</div>
                        <div class="audio-controls">
                            <button class="audio-btn" onclick="speakText('${item.word}')">
                                <i class="fas fa-volume-up"></i> 听发音
                            </button>
                            <button class="audio-btn" onclick="startRecording('${item.word}')">
                                <i class="fas fa-microphone"></i> 录音练习
                            </button>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
            container.style.display = 'block';
        }

        // Phrases system
        function initPhrasesSystem() {
            const loadBtn = document.getElementById('load-phrases');
            const container = document.getElementById('phrases-content');

            loadBtn.addEventListener('click', function() {
                const category = document.getElementById('phrase-category').value;
                loadPhrasesContent(category, container);
            });
        }

        function loadPhrasesContent(category, container) {
            const data = phrasesData[category];
            if (!data) return;

            let html = `<h3><i class="fas fa-quote-left"></i> ${getCategoryName(category)}</h3>`;
            
            data.forEach(phrase => {
                html += `
                    <div class="phrase-card">
                        <div class="phrase-english">${phrase.english}</div>
                        <div class="phrase-chinese">${phrase.chinese}</div>
                        <div class="phrase-usage">${phrase.usage}</div>
                        <div class="audio-controls">
                            <button class="audio-btn" onclick="speakText('${phrase.english}')">
                                <i class="fas fa-volume-up"></i> 播放
                            </button>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
            container.style.display = 'block';
        }

        function getCategoryName(category) {
            const names = {
                greetings: '问候用语',
                opinions: '表达观点',
                emotions: '情感表达',
                requests: '请求帮助',
                agreement: '同意/反对',
                transitions: '话题转换'
            };
            return names[category] || category;
        }

        // Conversation system
        function initConversationSystem() {
            const startBtn = document.getElementById('start-conversation');
            const container = document.getElementById('conversation-area');
            const messagesDiv = document.getElementById('conversation-messages');

            startBtn.addEventListener('click', function() {
                const topic = document.getElementById('conversation-topic').value;
                startConversation(topic, container, messagesDiv);
            });
        }

        function startConversation(topic, container, messagesDiv) {
            container.style.display = 'block';
            
            // Initialize conversation with AI greeting
            const greeting = getTopicGreeting(topic);
            messagesDiv.innerHTML = `
                <div class="dialogue-message assistant">
                    <div class="message-header">
                        <i class="fas fa-robot"></i> AI助手
                    </div>
                    <div class="message-content">
                        <div class="phrase-english">${greeting.english}</div>
                        <div class="phrase-chinese">${greeting.chinese}</div>
                    </div>
                </div>
            `;

            // Speak the greeting
            speakText(greeting.english);
        }

        function getTopicGreeting(topic) {
            const greetings = {
                introduction: {
                    english: "Hi there! I'd love to get to know you better. Could you tell me a bit about yourself?",
                    chinese: "你好！我很想更好地了解你。你能告诉我一些关于你自己的事情吗？"
                },
                hobbies: {
                    english: "What do you like to do in your free time? I'm curious about your hobbies!",
                    chinese: "你空闲时间喜欢做什么？我很好奇你的爱好！"
                },
                weather: {
                    english: "How's the weather where you are today? It's always interesting to talk about weather!",
                    chinese: "你那里今天天气怎么样？谈论天气总是很有趣！"
                },
                food: {
                    english: "I love talking about food! What's your favorite dish or cuisine?",
                    chinese: "我喜欢谈论食物！你最喜欢的菜或菜系是什么？"
                },
                travel: {
                    english: "Have you traveled anywhere interesting recently? I'd love to hear about your experiences!",
                    chinese: "你最近去过什么有趣的地方吗？我很想听听你的经历！"
                },
                work: {
                    english: "What kind of work do you do? I'm interested in learning about different careers!",
                    chinese: "你做什么工作？我对了解不同的职业很感兴趣！"
                }
            };
            return greetings[topic] || greetings.introduction;
        }

        // Speech synthesis function
        function speakText(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'en-US';
                utterance.rate = 0.8;
                speechSynthesis.speak(utterance);
            } else {
                console.log('Speech synthesis not supported');
            }
        }

        // Recording function (placeholder)
        function startRecording(word) {
            const status = document.getElementById('recording-status') || createRecordingStatus();
            status.style.display = 'block';
            status.className = 'recording-status recording';
            status.innerHTML = `<i class="fas fa-microphone"></i> 正在录音练习 "${word}"...`;
            
            // Simulate recording for 3 seconds
            setTimeout(() => {
                status.className = 'recording-status ready';
                status.innerHTML = `<i class="fas fa-check"></i> 录音完成！继续练习下一个单词。`;
                
                setTimeout(() => {
                    status.style.display = 'none';
                }, 2000);
            }, 3000);
        }

        function createRecordingStatus() {
            const status = document.createElement('div');
            status.id = 'recording-status';
            status.className = 'recording-status';
            status.style.display = 'none';
            document.querySelector('.practice-area').appendChild(status);
            return status;
        }
    </script>
</body>
</html> 