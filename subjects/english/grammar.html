<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>语法掌握 - 英语学习助手</title>
    <link rel="icon" href="../../assets/icons/logo_btrfly.ico" type="image/x-icon">
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../../css/components.css">
    <link rel="stylesheet" href="../../css/utilities.css">
    <link rel="stylesheet" href="../../css/responsive.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        .grammar-hero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 4rem 0;
            text-align: center;
        }

        .grammar-hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .grammar-hero p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }

        .grammar-tabs {
            display: flex;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin: 2rem 0;
            overflow: hidden;
        }

        .grammar-tab {
            flex: 1;
            padding: 1rem 2rem;
            background: #f8f9fa;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .grammar-tab.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .grammar-tab:hover:not(.active) {
            background: #e9ecef;
        }

        .grammar-content {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .grammar-panel {
            display: none;
        }

        .grammar-panel.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .topic-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .topic-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .topic-card:hover {
            background: #e9ecef;
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .topic-card.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
        }

        .topic-card h3 {
            color: #667eea;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .exercise-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 2rem;
            margin-top: 2rem;
        }

        .exercise-question {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-left: 4px solid #667eea;
        }

        .exercise-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .exercise-option {
            background: #e9ecef;
            border: none;
            border-radius: 8px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .exercise-option:hover {
            background: #dee2e6;
        }

        .exercise-option.selected {
            background: #667eea;
            color: white;
        }

        .exercise-option.correct {
            background: #28a745;
            color: white;
        }

        .exercise-option.incorrect {
            background: #dc3545;
            color: white;
        }

        .explanation-box {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border-radius: 10px;
            padding: 1.5rem;
            margin-top: 1rem;
            border-left: 4px solid #667eea;
        }

        .progress-bar {
            background: #e9ecef;
            border-radius: 10px;
            height: 10px;
            margin: 1rem 0;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #667eea, #764ba2);
            height: 100%;
            transition: width 0.3s ease;
        }

        .score-display {
            text-align: center;
            padding: 2rem;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border-radius: 15px;
            margin: 2rem 0;
        }

        .score-number {
            font-size: 3rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 0.5rem;
        }

        .grammar-rule {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-left: 4px solid #28a745;
        }

        .example-sentence {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1rem;
            margin: 0.5rem 0;
            font-style: italic;
        }

        .highlight {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2), rgba(118, 75, 162, 0.2));
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .grammar-tabs {
                flex-direction: column;
            }

            .grammar-tab {
                padding: 0.8rem 1rem;
            }

            .grammar-hero h1 {
                font-size: 2rem;
            }

            .topic-grid {
                grid-template-columns: 1fr;
            }

            .exercise-options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="../../index.html">
                        <i class="fas fa-graduation-cap" style="background: linear-gradient(90deg, #4361ee, #7209b7); -webkit-background-clip: text; background-clip: text; color: transparent;"></i>
                        <span class="gradient-text">Alex的学习助手</span>
                    </a>
                </div>
                <nav class="main-nav">
                    <ul>
                        <li><a href="../../index.html">首页</a></li>
                        <li><a href="../../index.html#subjects">科目</a></li>
                        <li><a href="../../tts.html">语音</a></li>
                        <li><a href="../../draw.html">绘图</a></li>
                        <li><a href="main.html">返回英语</a></li>
                    </ul>
                </nav>
                <button class="mobile-menu-toggle" aria-label="切换菜单">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </header>

    <main>
        <!-- Hero Section -->
        <section class="grammar-hero">
            <div class="container">
                <h1><i class="fas fa-spell-check"></i> 语法掌握</h1>
                <p>通过互动练习和详细解释掌握英语语法规则，提高语言运用能力</p>
            </div>
        </section>

        <!-- Main Content -->
        <section class="main-content">
            <div class="container">
                <!-- Grammar Tabs -->
                <div class="grammar-tabs">
                    <button class="grammar-tab active" data-tab="learn">
                        <i class="fas fa-book-open"></i> 学习语法
                    </button>
                    <button class="grammar-tab" data-tab="practice">
                        <i class="fas fa-dumbbell"></i> 练习题目
                    </button>
                    <button class="grammar-tab" data-tab="test">
                        <i class="fas fa-clipboard-check"></i> 语法测试
                    </button>
                    <button class="grammar-tab" data-tab="reference">
                        <i class="fas fa-bookmark"></i> 语法手册
                    </button>
                </div>

                <!-- Learn Panel -->
                <div id="learn-panel" class="grammar-content grammar-panel active">
                    <h2><i class="fas fa-lightbulb"></i> 选择语法主题</h2>
                    <div class="topic-grid">
                        <div class="topic-card" data-topic="tenses">
                            <h3><i class="fas fa-clock"></i> 时态</h3>
                            <p>学习现在时、过去时、将来时及其各种形式</p>
                        </div>
                        <div class="topic-card" data-topic="articles">
                            <h3><i class="fas fa-font"></i> 冠词</h3>
                            <p>掌握 a, an, the 的正确使用方法</p>
                        </div>
                        <div class="topic-card" data-topic="prepositions">
                            <h3><i class="fas fa-arrows-alt"></i> 介词</h3>
                            <p>学习时间、地点、方向介词的用法</p>
                        </div>
                        <div class="topic-card" data-topic="conditionals">
                            <h3><i class="fas fa-question-circle"></i> 条件句</h3>
                            <p>理解第一、二、三条件句的结构和用法</p>
                        </div>
                        <div class="topic-card" data-topic="passive">
                            <h3><i class="fas fa-exchange-alt"></i> 被动语态</h3>
                            <p>学习被动语态的构成和使用场合</p>
                        </div>
                        <div class="topic-card" data-topic="modals">
                            <h3><i class="fas fa-cog"></i> 情态动词</h3>
                            <p>掌握 can, could, should, must 等的用法</p>
                        </div>
                    </div>
                    <div id="topic-content" class="exercise-container" style="display: none;">
                        <!-- Topic content will be loaded here -->
                    </div>
                </div>

                <!-- Practice Panel -->
                <div id="practice-panel" class="grammar-content grammar-panel">
                    <h2><i class="fas fa-dumbbell"></i> 语法练习</h2>
                    <div class="form-group">
                        <label for="practice-topic">选择练习主题：</label>
                        <select id="practice-topic" class="form-control">
                            <option value="mixed">综合练习</option>
                            <option value="tenses">时态练习</option>
                            <option value="articles">冠词练习</option>
                            <option value="prepositions">介词练习</option>
                            <option value="conditionals">条件句练习</option>
                            <option value="passive">被动语态练习</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="practice-difficulty">难度级别：</label>
                        <select id="practice-difficulty" class="form-control">
                            <option value="elementary">初级</option>
                            <option value="intermediate" selected>中级</option>
                            <option value="advanced">高级</option>
                        </select>
                    </div>
                    <button id="start-practice" class="btn btn-primary">
                        <i class="fas fa-play"></i> 开始练习
                    </button>
                    <div id="practice-container" style="display: none;">
                        <div class="progress-bar">
                            <div id="practice-progress" class="progress-fill" style="width: 0%"></div>
                        </div>
                        <div id="practice-questions"></div>
                        <div id="practice-results" style="display: none;"></div>
                    </div>
                </div>

                <!-- Test Panel -->
                <div id="test-panel" class="grammar-content grammar-panel">
                    <h2><i class="fas fa-clipboard-check"></i> 语法测试</h2>
                    <p>通过综合测试评估您的语法水平</p>
                    <div class="form-group">
                        <label for="test-level">测试级别：</label>
                        <select id="test-level" class="form-control">
                            <option value="elementary">初级测试 (20题)</option>
                            <option value="intermediate" selected>中级测试 (25题)</option>
                            <option value="advanced">高级测试 (30题)</option>
                        </select>
                    </div>
                    <button id="start-test" class="btn btn-primary">
                        <i class="fas fa-play-circle"></i> 开始测试
                    </button>
                    <div id="test-container" style="display: none;">
                        <div class="progress-bar">
                            <div id="test-progress" class="progress-fill" style="width: 0%"></div>
                        </div>
                        <div id="test-questions"></div>
                        <div id="test-results" style="display: none;"></div>
                    </div>
                </div>

                <!-- Reference Panel -->
                <div id="reference-panel" class="grammar-content grammar-panel">
                    <h2><i class="fas fa-bookmark"></i> 语法手册</h2>
                    <p>快速查阅常用语法规则和例句</p>
                    <div class="topic-grid">
                        <div class="topic-card" data-reference="tenses">
                            <h3><i class="fas fa-clock"></i> 时态总览</h3>
                            <p>所有时态的构成和用法总结</p>
                        </div>
                        <div class="topic-card" data-reference="sentence-structure">
                            <h3><i class="fas fa-sitemap"></i> 句子结构</h3>
                            <p>简单句、复合句、复杂句的构成</p>
                        </div>
                        <div class="topic-card" data-reference="common-errors">
                            <h3><i class="fas fa-exclamation-triangle"></i> 常见错误</h3>
                            <p>中国学生常犯的语法错误及纠正</p>
                        </div>
                        <div class="topic-card" data-reference="irregular-verbs">
                            <h3><i class="fas fa-list"></i> 不规则动词</h3>
                            <p>常用不规则动词变化表</p>
                        </div>
                    </div>
                    <div id="reference-content" class="exercise-container" style="display: none;">
                        <!-- Reference content will be loaded here -->
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="main-footer">
        <div class="container">
            <div class="footer-content">
                <p class="copyright-text">study-llm.me域名为Alex所有。保留所有权利。</p>
                <div class="profile-section">
                    <button id="profile-button" class="profile-button">
                        <i class="fas fa-user-circle"></i>
                        学习阶段
                    </button>
                    <div id="profile-display" class="profile-display"></div>
                </div>
            </div>
        </div>
    </footer>

    <script src="../../js/common.js"></script>
    <script src="../../js/navigation.js"></script>
    <script src="../../js/profile.js"></script>
    <script>
        // Grammar learning data
        const grammarData = {
            tenses: {
                title: "时态",
                rules: [
                    {
                        name: "一般现在时 (Simple Present)",
                        structure: "主语 + 动词原形/动词第三人称单数形式",
                        usage: "表示经常性动作、习惯、真理等",
                        examples: [
                            "I <span class='highlight'>study</span> English every day.",
                            "She <span class='highlight'>works</span> in a hospital.",
                            "The sun <span class='highlight'>rises</span> in the east."
                        ]
                    },
                    {
                        name: "现在进行时 (Present Continuous)",
                        structure: "主语 + am/is/are + 动词-ing",
                        usage: "表示正在进行的动作",
                        examples: [
                            "I <span class='highlight'>am studying</span> now.",
                            "They <span class='highlight'>are playing</span> football.",
                            "She <span class='highlight'>is reading</span> a book."
                        ]
                    },
                    {
                        name: "一般过去时 (Simple Past)",
                        structure: "主语 + 动词过去式",
                        usage: "表示过去发生的动作或状态",
                        examples: [
                            "I <span class='highlight'>studied</span> yesterday.",
                            "He <span class='highlight'>went</span> to school.",
                            "We <span class='highlight'>were</span> happy."
                        ]
                    }
                ]
            },
            articles: {
                title: "冠词",
                rules: [
                    {
                        name: "不定冠词 a/an",
                        structure: "a + 辅音音素开头的词, an + 元音音素开头的词",
                        usage: "表示泛指，第一次提到某物",
                        examples: [
                            "I have <span class='highlight'>a</span> cat.",
                            "She is <span class='highlight'>an</span> engineer.",
                            "There is <span class='highlight'>a</span> university here."
                        ]
                    },
                    {
                        name: "定冠词 the",
                        structure: "the + 名词",
                        usage: "表示特指，双方都知道的事物",
                        examples: [
                            "<span class='highlight'>The</span> book on the table is mine.",
                            "I like <span class='highlight'>the</span> music you played.",
                            "<span class='highlight'>The</span> sun is shining."
                        ]
                    }
                ]
            },
            prepositions: {
                title: "介词",
                rules: [
                    {
                        name: "时间介词",
                        structure: "at/in/on + 时间",
                        usage: "at用于具体时刻，in用于月份/年份，on用于具体日期",
                        examples: [
                            "I get up <span class='highlight'>at</span> 7 o'clock.",
                            "She was born <span class='highlight'>in</span> 1990.",
                            "We have a meeting <span class='highlight'>on</span> Monday."
                        ]
                    },
                    {
                        name: "地点介词",
                        structure: "at/in/on + 地点",
                        usage: "at用于小地点，in用于大地点，on用于表面",
                        examples: [
                            "I'm <span class='highlight'>at</span> the bus stop.",
                            "He lives <span class='highlight'>in</span> Beijing.",
                            "The book is <span class='highlight'>on</span> the table."
                        ]
                    }
                ]
            }
        };

        // Practice questions data
        const practiceQuestions = {
            tenses: [
                {
                    question: "I _____ to school every day.",
                    options: ["go", "goes", "going", "went"],
                    correct: 0,
                    explanation: "主语是I，一般现在时用动词原形。"
                },
                {
                    question: "She _____ her homework now.",
                    options: ["do", "does", "is doing", "did"],
                    correct: 2,
                    explanation: "now表示现在进行时，结构是be + doing。"
                },
                {
                    question: "They _____ to the park yesterday.",
                    options: ["go", "goes", "going", "went"],
                    correct: 3,
                    explanation: "yesterday表示过去时间，用过去式went。"
                }
            ],
            articles: [
                {
                    question: "I saw _____ elephant at the zoo.",
                    options: ["a", "an", "the", "/"],
                    correct: 1,
                    explanation: "elephant以元音音素开头，用an。"
                },
                {
                    question: "_____ book you lent me is very interesting.",
                    options: ["A", "An", "The", "/"],
                    correct: 2,
                    explanation: "特指你借给我的那本书，用the。"
                }
            ]
        };

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            initGrammarTabs();
            initTopicCards();
            initPracticeSystem();
            initTestSystem();
            initReferenceSystem();
        });

        // Tab system
        function initGrammarTabs() {
            const tabs = document.querySelectorAll('.grammar-tab');
            const panels = document.querySelectorAll('.grammar-panel');

            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const targetPanel = this.getAttribute('data-tab') + '-panel';
                    
                    // Update active tab
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Update active panel
                    panels.forEach(p => p.classList.remove('active'));
                    document.getElementById(targetPanel).classList.add('active');
                });
            });
        }

        // Topic cards in learn panel
        function initTopicCards() {
            const topicCards = document.querySelectorAll('[data-topic]');
            const topicContent = document.getElementById('topic-content');

            topicCards.forEach(card => {
                card.addEventListener('click', function() {
                    const topic = this.getAttribute('data-topic');
                    
                    // Update selected card
                    topicCards.forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    // Load topic content
                    loadTopicContent(topic, topicContent);
                });
            });
        }

        function loadTopicContent(topic, container) {
            const data = grammarData[topic];
            if (!data) return;

            let html = `<h3><i class="fas fa-book-open"></i> ${data.title}</h3>`;
            
            data.rules.forEach(rule => {
                html += `
                    <div class="grammar-rule">
                        <h4>${rule.name}</h4>
                        <p><strong>结构：</strong>${rule.structure}</p>
                        <p><strong>用法：</strong>${rule.usage}</p>
                        <div class="examples">
                            <strong>例句：</strong>
                            ${rule.examples.map(ex => `<div class="example-sentence">${ex}</div>`).join('')}
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
            container.style.display = 'block';
        }

        // Practice system
        function initPracticeSystem() {
            const startBtn = document.getElementById('start-practice');
            const container = document.getElementById('practice-container');
            const questionsDiv = document.getElementById('practice-questions');
            const progressBar = document.getElementById('practice-progress');

            let currentQuestions = [];
            let currentQuestionIndex = 0;
            let score = 0;

            startBtn.addEventListener('click', function() {
                const topic = document.getElementById('practice-topic').value;
                const difficulty = document.getElementById('practice-difficulty').value;
                
                startPractice(topic, difficulty);
            });

            function startPractice(topic, difficulty) {
                currentQuestions = generatePracticeQuestions(topic, difficulty);
                currentQuestionIndex = 0;
                score = 0;
                
                container.style.display = 'block';
                showQuestion();
            }

            function generatePracticeQuestions(topic, difficulty) {
                // Generate questions based on topic and difficulty
                if (topic === 'mixed') {
                    let questions = [];
                    Object.keys(practiceQuestions).forEach(key => {
                        questions = questions.concat(practiceQuestions[key]);
                    });
                    return shuffleArray(questions).slice(0, 10);
                } else if (practiceQuestions[topic]) {
                    return practiceQuestions[topic];
                } else {
                    return generateDefaultQuestions(topic, difficulty);
                }
            }

            function generateDefaultQuestions(topic, difficulty) {
                // Fallback question generation
                return [
                    {
                        question: `这是一个${topic}的${difficulty}级别练习题。`,
                        options: ["选项A", "选项B", "选项C", "选项D"],
                        correct: 0,
                        explanation: "这是示例解释。"
                    }
                ];
            }

            function showQuestion() {
                if (currentQuestionIndex >= currentQuestions.length) {
                    showPracticeResults();
                    return;
                }

                const question = currentQuestions[currentQuestionIndex];
                const progress = ((currentQuestionIndex + 1) / currentQuestions.length) * 100;
                progressBar.style.width = progress + '%';

                questionsDiv.innerHTML = `
                    <div class="exercise-question">
                        <h4>题目 ${currentQuestionIndex + 1}/${currentQuestions.length}</h4>
                        <p>${question.question}</p>
                        <div class="exercise-options">
                            ${question.options.map((option, index) => 
                                `<button class="exercise-option" data-index="${index}">${option}</button>`
                            ).join('')}
                        </div>
                        <div id="question-explanation" style="display: none;"></div>
                        <button id="next-question" class="btn btn-primary" style="display: none; margin-top: 1rem;">下一题</button>
                    </div>
                `;

                // Add option click handlers
                const options = questionsDiv.querySelectorAll('.exercise-option');
                options.forEach(option => {
                    option.addEventListener('click', function() {
                        const selectedIndex = parseInt(this.getAttribute('data-index'));
                        checkAnswer(selectedIndex, question);
                    });
                });

                // Add next question handler
                document.getElementById('next-question').addEventListener('click', function() {
                    currentQuestionIndex++;
                    showQuestion();
                });
            }

            function checkAnswer(selectedIndex, question) {
                const options = questionsDiv.querySelectorAll('.exercise-option');
                const explanationDiv = document.getElementById('question-explanation');
                const nextBtn = document.getElementById('next-question');

                options.forEach((option, index) => {
                    option.disabled = true;
                    if (index === question.correct) {
                        option.classList.add('correct');
                    } else if (index === selectedIndex && index !== question.correct) {
                        option.classList.add('incorrect');
                    }
                });

                if (selectedIndex === question.correct) {
                    score++;
                }

                explanationDiv.innerHTML = `
                    <div class="explanation-box">
                        <h5><i class="fas fa-lightbulb"></i> 解释</h5>
                        <p>${question.explanation}</p>
                    </div>
                `;
                explanationDiv.style.display = 'block';
                nextBtn.style.display = 'block';
            }

            function showPracticeResults() {
                const percentage = Math.round((score / currentQuestions.length) * 100);
                const resultsDiv = document.getElementById('practice-results');
                
                resultsDiv.innerHTML = `
                    <div class="score-display">
                        <div class="score-number">${percentage}%</div>
                        <p>您答对了 ${score}/${currentQuestions.length} 题</p>
                        <button class="btn btn-primary" onclick="location.reload()">重新练习</button>
                    </div>
                `;
                
                questionsDiv.style.display = 'none';
                resultsDiv.style.display = 'block';
            }
        }

        // Test system (similar to practice but more comprehensive)
        function initTestSystem() {
            const startBtn = document.getElementById('start-test');
            
            startBtn.addEventListener('click', function() {
                const level = document.getElementById('test-level').value;
                alert(`${level}测试功能正在开发中，敬请期待！`);
            });
        }

        // Reference system
        function initReferenceSystem() {
            const referenceCards = document.querySelectorAll('[data-reference]');
            const referenceContent = document.getElementById('reference-content');

            referenceCards.forEach(card => {
                card.addEventListener('click', function() {
                    const reference = this.getAttribute('data-reference');
                    
                    referenceCards.forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    loadReferenceContent(reference, referenceContent);
                });
            });
        }

        function loadReferenceContent(reference, container) {
            let html = '';
            
            switch(reference) {
                case 'tenses':
                    html = `
                        <h3><i class="fas fa-clock"></i> 时态总览</h3>
                        <div class="grammar-rule">
                            <h4>现在时态</h4>
                            <p>一般现在时：I work / 现在进行时：I am working / 现在完成时：I have worked</p>
                        </div>
                        <div class="grammar-rule">
                            <h4>过去时态</h4>
                            <p>一般过去时：I worked / 过去进行时：I was working / 过去完成时：I had worked</p>
                        </div>
                        <div class="grammar-rule">
                            <h4>将来时态</h4>
                            <p>一般将来时：I will work / 将来进行时：I will be working / 将来完成时：I will have worked</p>
                        </div>
                    `;
                    break;
                case 'sentence-structure':
                    html = `
                        <h3><i class="fas fa-sitemap"></i> 句子结构</h3>
                        <div class="grammar-rule">
                            <h4>简单句 (Simple Sentence)</h4>
                            <p>只有一个主谓结构：I like apples.</p>
                        </div>
                        <div class="grammar-rule">
                            <h4>复合句 (Compound Sentence)</h4>
                            <p>两个或多个独立句子用连词连接：I like apples, but she likes oranges.</p>
                        </div>
                        <div class="grammar-rule">
                            <h4>复杂句 (Complex Sentence)</h4>
                            <p>包含主句和从句：I know that you are right.</p>
                        </div>
                    `;
                    break;
                case 'common-errors':
                    html = `
                        <h3><i class="fas fa-exclamation-triangle"></i> 常见错误</h3>
                        <div class="grammar-rule">
                            <h4>主谓一致错误</h4>
                            <p>❌ He don't like it. ✅ He doesn't like it.</p>
                        </div>
                        <div class="grammar-rule">
                            <h4>时态错误</h4>
                            <p>❌ I am go to school. ✅ I go to school. / I am going to school.</p>
                        </div>
                        <div class="grammar-rule">
                            <h4>冠词错误</h4>
                            <p>❌ I have a apple. ✅ I have an apple.</p>
                        </div>
                    `;
                    break;
                case 'irregular-verbs':
                    html = `
                        <h3><i class="fas fa-list"></i> 不规则动词表</h3>
                        <div class="grammar-rule">
                            <h4>常用不规则动词</h4>
                            <p>be - was/were - been (是)</p>
                            <p>go - went - gone (去)</p>
                            <p>do - did - done (做)</p>
                            <p>have - had - had (有)</p>
                            <p>see - saw - seen (看见)</p>
                            <p>come - came - come (来)</p>
                            <p>take - took - taken (拿)</p>
                            <p>get - got - got/gotten (得到)</p>
                        </div>
                    `;
                    break;
            }
            
            container.innerHTML = html;
            container.style.display = 'block';
        }

        // Utility functions
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }
    </script>
</body>
</html> 