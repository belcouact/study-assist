<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>阅读理解 - 英语学习助手</title>
    <link rel="icon" href="../../assets/icons/logo_btrfly.ico" type="image/x-icon">
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../../css/components.css">
    <link rel="stylesheet" href="../../css/utilities.css">
    <link rel="stylesheet" href="../../css/responsive.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        .reading-hero {
            background: linear-gradient(135deg, #00b894 0%, #00cec9 100%);
            color: white;
            padding: 4rem 0;
            text-align: center;
        }

        .reading-hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .reading-hero p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }

        .reading-tabs {
            display: flex;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin: 2rem 0;
            overflow: hidden;
        }

        .reading-tab {
            flex: 1;
            padding: 1rem 2rem;
            background: #f8f9fa;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .reading-tab.active {
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
        }

        .reading-tab:hover:not(.active) {
            background: #e9ecef;
        }

        .reading-content {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .reading-panel {
            display: none;
        }

        .reading-panel.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .text-types-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .text-type-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .text-type-card:hover {
            background: #e9ecef;
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .text-type-card.selected {
            border-color: #00b894;
            background: linear-gradient(135deg, rgba(0, 184, 148, 0.1), rgba(0, 206, 201, 0.1));
        }

        .text-type-card h3 {
            color: #00b894;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .reading-passage {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 2rem;
            margin: 2rem 0;
            line-height: 1.8;
            font-size: 1.1rem;
        }

        .passage-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #2d3436;
            margin-bottom: 1rem;
            text-align: center;
        }

        .passage-content {
            text-align: justify;
            margin-bottom: 2rem;
        }

        .passage-content p {
            margin-bottom: 1rem;
        }

        .reading-tools {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .tool-btn {
            background: #00b894;
            color: white;
            border: none;
            border-radius: 25px;
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .tool-btn:hover {
            background: #00a085;
            transform: translateY(-2px);
        }

        .tool-btn.active {
            background: #00cec9;
        }

        .questions-container {
            background: white;
            border-radius: 10px;
            padding: 2rem;
            margin-top: 2rem;
            border-left: 4px solid #00b894;
        }

        .question-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .question-text {
            font-weight: 600;
            margin-bottom: 1rem;
            color: #2d3436;
        }

        .question-options {
            display: grid;
            gap: 0.5rem;
        }

        .question-option {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .question-option:hover {
            border-color: #00b894;
            background: rgba(0, 184, 148, 0.05);
        }

        .question-option.selected {
            border-color: #00b894;
            background: rgba(0, 184, 148, 0.1);
        }

        .question-option.correct {
            border-color: #00b894;
            background: rgba(0, 184, 148, 0.2);
        }

        .question-option.incorrect {
            border-color: #e74c3c;
            background: rgba(231, 76, 60, 0.1);
        }

        .explanation-box {
            background: linear-gradient(135deg, rgba(0, 184, 148, 0.1), rgba(0, 206, 201, 0.1));
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            border-left: 4px solid #00b894;
        }

        .skills-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .skill-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .skill-card:hover {
            background: #e9ecef;
            transform: translateY(-5px);
        }

        .skill-card.selected {
            border-color: #00b894;
            background: linear-gradient(135deg, rgba(0, 184, 148, 0.1), rgba(0, 206, 201, 0.1));
        }

        .skill-icon {
            font-size: 2.5rem;
            color: #00b894;
            margin-bottom: 1rem;
        }

        .skill-title {
            font-weight: 600;
            color: #2d3436;
            margin-bottom: 0.5rem;
        }

        .skill-description {
            color: #636e72;
            font-size: 0.9rem;
        }

        .progress-tracker {
            background: white;
            border-radius: 10px;
            padding: 2rem;
            margin-top: 2rem;
            text-align: center;
        }

        .progress-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: conic-gradient(#00b894 0deg, #00b894 var(--progress-deg), #e9ecef var(--progress-deg), #e9ecef 360deg);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            position: relative;
        }

        .progress-circle::before {
            content: '';
            width: 90px;
            height: 90px;
            border-radius: 50%;
            background: white;
            position: absolute;
        }

        .progress-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: #00b894;
            z-index: 1;
        }

        .vocabulary-highlight {
            background: linear-gradient(135deg, rgba(255, 193, 7, 0.3), rgba(255, 235, 59, 0.3));
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            cursor: pointer;
            position: relative;
        }

        .vocabulary-tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #2d3436;
            color: white;
            padding: 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 10;
        }

        .vocabulary-highlight:hover .vocabulary-tooltip {
            opacity: 1;
            visibility: visible;
        }

        .reading-timer {
            background: #00b894;
            color: white;
            border-radius: 25px;
            padding: 0.5rem 1rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .difficulty-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .difficulty-beginner {
            background: #00b894;
            color: white;
        }

        .difficulty-intermediate {
            background: #fdcb6e;
            color: #2d3436;
        }

        .difficulty-advanced {
            background: #e17055;
            color: white;
        }

        @media (max-width: 768px) {
            .reading-tabs {
                flex-direction: column;
            }

            .reading-tab {
                padding: 0.8rem 1rem;
            }

            .reading-hero h1 {
                font-size: 2rem;
            }

            .text-types-grid {
                grid-template-columns: 1fr;
            }

            .reading-tools {
                justify-content: center;
            }

            .skills-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="../../index.html">
                        <i class="fas fa-graduation-cap" style="background: linear-gradient(90deg, #4361ee, #7209b7); -webkit-background-clip: text; background-clip: text; color: transparent;"></i>
                        <span class="gradient-text">Alex的学习助手</span>
                    </a>
                </div>
                <nav class="main-nav">
                    <ul>
                        <li><a href="../../index.html">首页</a></li>
                        <li><a href="../../index.html#subjects">科目</a></li>
                        <li><a href="../../tts.html">语音</a></li>
                        <li><a href="../../draw.html">绘图</a></li>
                        <li><a href="main.html">返回英语</a></li>
                    </ul>
                </nav>
                <button class="mobile-menu-toggle" aria-label="切换菜单">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </header>

    <main>
        <!-- Hero Section -->
        <section class="reading-hero">
            <div class="container">
                <h1><i class="fas fa-book-reader"></i> 阅读理解</h1>
                <p>通过多样化的阅读材料和练习提高英语阅读理解能力和批判性思维</p>
            </div>
        </section>

        <!-- Main Content -->
        <section class="main-content">
            <div class="container">
                <!-- Reading Tabs -->
                <div class="reading-tabs">
                    <button class="reading-tab active" data-tab="passages">
                        <i class="fas fa-book-open"></i> 阅读文章
                    </button>
                    <button class="reading-tab" data-tab="skills">
                        <i class="fas fa-brain"></i> 阅读技巧
                    </button>
                    <button class="reading-tab" data-tab="practice">
                        <i class="fas fa-dumbbell"></i> 练习测试
                    </button>
                    <button class="reading-tab" data-tab="progress">
                        <i class="fas fa-chart-line"></i> 学习进度
                    </button>
                </div>

                <!-- Passages Panel -->
                <div id="passages-panel" class="reading-content reading-panel active">
                    <h2><i class="fas fa-book-open"></i> 选择阅读类型</h2>
                    <div class="text-types-grid">
                        <div class="text-type-card" data-type="news">
                            <h3><i class="fas fa-newspaper"></i> 新闻文章</h3>
                            <p>时事新闻和报道文章</p>
                            <span class="difficulty-badge difficulty-intermediate">中级</span>
                        </div>
                        <div class="text-type-card" data-type="science">
                            <h3><i class="fas fa-flask"></i> 科学文章</h3>
                            <p>科学发现和技术报告</p>
                            <span class="difficulty-badge difficulty-advanced">高级</span>
                        </div>
                        <div class="text-type-card" data-type="story">
                            <h3><i class="fas fa-book"></i> 故事小说</h3>
                            <p>短篇故事和文学作品</p>
                            <span class="difficulty-badge difficulty-beginner">初级</span>
                        </div>
                        <div class="text-type-card" data-type="biography">
                            <h3><i class="fas fa-user"></i> 人物传记</h3>
                            <p>名人传记和人物介绍</p>
                            <span class="difficulty-badge difficulty-intermediate">中级</span>
                        </div>
                        <div class="text-type-card" data-type="travel">
                            <h3><i class="fas fa-map"></i> 旅行游记</h3>
                            <p>旅行经历和地方介绍</p>
                            <span class="difficulty-badge difficulty-beginner">初级</span>
                        </div>
                        <div class="text-type-card" data-type="academic">
                            <h3><i class="fas fa-graduation-cap"></i> 学术文章</h3>
                            <p>学术研究和论文摘要</p>
                            <span class="difficulty-badge difficulty-advanced">高级</span>
                        </div>
                    </div>

                    <div id="passage-content" style="display: none;">
                        <div class="reading-tools">
                            <div class="reading-timer">
                                <i class="fas fa-clock"></i>
                                <span id="reading-time">00:00</span>
                            </div>
                            <button class="tool-btn" id="highlight-vocab">
                                <i class="fas fa-highlighter"></i> 词汇高亮
                            </button>
                            <button class="tool-btn" id="read-aloud">
                                <i class="fas fa-volume-up"></i> 朗读
                            </button>
                            <button class="tool-btn" id="show-questions">
                                <i class="fas fa-question-circle"></i> 显示问题
                            </button>
                        </div>

                        <div id="reading-passage" class="reading-passage">
                            <!-- Passage content will be loaded here -->
                        </div>

                        <div id="questions-section" class="questions-container" style="display: none;">
                            <!-- Questions will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Skills Panel -->
                <div id="skills-panel" class="reading-content reading-panel">
                    <h2><i class="fas fa-brain"></i> 阅读技巧训练</h2>
                    <div class="skills-grid">
                        <div class="skill-card" data-skill="skimming">
                            <div class="skill-icon">
                                <i class="fas fa-eye"></i>
                            </div>
                            <div class="skill-title">快速浏览</div>
                            <div class="skill-description">学习快速获取文章主旨的技巧</div>
                        </div>
                        <div class="skill-card" data-skill="scanning">
                            <div class="skill-icon">
                                <i class="fas fa-search"></i>
                            </div>
                            <div class="skill-title">扫读查找</div>
                            <div class="skill-description">快速定位特定信息的方法</div>
                        </div>
                        <div class="skill-card" data-skill="inference">
                            <div class="skill-icon">
                                <i class="fas fa-lightbulb"></i>
                            </div>
                            <div class="skill-title">推理判断</div>
                            <div class="skill-description">从文本中推断隐含信息</div>
                        </div>
                        <div class="skill-card" data-skill="vocabulary">
                            <div class="skill-icon">
                                <i class="fas fa-book"></i>
                            </div>
                            <div class="skill-title">词汇理解</div>
                            <div class="skill-description">通过上下文理解生词含义</div>
                        </div>
                        <div class="skill-card" data-skill="structure">
                            <div class="skill-icon">
                                <i class="fas fa-sitemap"></i>
                            </div>
                            <div class="skill-title">文章结构</div>
                            <div class="skill-description">分析文章组织和逻辑结构</div>
                        </div>
                        <div class="skill-card" data-skill="critical">
                            <div class="skill-icon">
                                <i class="fas fa-balance-scale"></i>
                            </div>
                            <div class="skill-title">批判思维</div>
                            <div class="skill-description">评估作者观点和论证</div>
                        </div>
                    </div>

                    <div id="skill-content" style="display: none;">
                        <!-- Skill training content will be loaded here -->
                    </div>
                </div>

                <!-- Practice Panel -->
                <div id="practice-panel" class="reading-content reading-panel">
                    <h2><i class="fas fa-dumbbell"></i> 阅读练习测试</h2>
                    <div class="form-group">
                        <label for="test-type">选择测试类型：</label>
                        <select id="test-type" class="form-control">
                            <option value="comprehension">理解测试</option>
                            <option value="vocabulary">词汇测试</option>
                            <option value="speed">速度测试</option>
                            <option value="mixed">综合测试</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="test-difficulty">难度级别：</label>
                        <select id="test-difficulty" class="form-control">
                            <option value="beginner">初级</option>
                            <option value="intermediate" selected>中级</option>
                            <option value="advanced">高级</option>
                        </select>
                    </div>
                    <button id="start-test" class="btn btn-primary">
                        <i class="fas fa-play"></i> 开始测试
                    </button>

                    <div id="test-container" style="display: none;">
                        <!-- Test content will be loaded here -->
                    </div>
                </div>

                <!-- Progress Panel -->
                <div id="progress-panel" class="reading-content reading-panel">
                    <h2><i class="fas fa-chart-line"></i> 学习进度</h2>
                    <div class="progress-tracker">
                        <div class="progress-circle" style="--progress-deg: 216deg;">
                            <div class="progress-number">60%</div>
                        </div>
                        <h3>总体阅读水平</h3>
                        <p>您已完成 12 篇文章阅读</p>
                    </div>

                    <div class="skills-grid">
                        <div class="skill-card">
                            <div class="skill-icon">
                                <i class="fas fa-tachometer-alt"></i>
                            </div>
                            <div class="skill-title">阅读速度</div>
                            <div class="skill-description">平均 180 词/分钟</div>
                        </div>
                        <div class="skill-card">
                            <div class="skill-icon">
                                <i class="fas fa-bullseye"></i>
                            </div>
                            <div class="skill-title">理解准确率</div>
                            <div class="skill-description">85% 正确率</div>
                        </div>
                        <div class="skill-card">
                            <div class="skill-icon">
                                <i class="fas fa-book"></i>
                            </div>
                            <div class="skill-title">词汇掌握</div>
                            <div class="skill-description">1,250 个单词</div>
                        </div>
                        <div class="skill-card">
                            <div class="skill-icon">
                                <i class="fas fa-trophy"></i>
                            </div>
                            <div class="skill-title">完成测试</div>
                            <div class="skill-description">8 次测试</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="main-footer">
        <div class="container">
            <div class="footer-content">
                <p class="copyright-text">study-llm.me域名为Alex所有。保留所有权利。</p>
                <div class="profile-section">
                    <button id="profile-button" class="profile-button">
                        <i class="fas fa-user-circle"></i>
                        学习阶段
                    </button>
                    <div id="profile-display" class="profile-display"></div>
                </div>
            </div>
        </div>
    </footer>

    <script src="../../js/common.js"></script>
    <script src="../../js/navigation.js"></script>
    <script src="../../js/profile.js"></script>
    <script>
        // Reading data
        const readingTexts = {
            news: {
                title: "Climate Change Summit Reaches Historic Agreement",
                content: `World leaders gathered in Geneva this week for the annual Climate Change Summit, where they reached a groundbreaking agreement on reducing global carbon emissions. The three-day conference brought together representatives from 195 countries to discuss urgent environmental challenges.

The agreement, dubbed the "Geneva Accord," commits participating nations to reduce their carbon emissions by 50% within the next decade. This ambitious target represents the most significant climate commitment in international history.

Dr. Sarah Chen, lead climate scientist at the International Environmental Institute, praised the agreement. "This is exactly what we needed," she said. "The scientific evidence is clear that we must act now to prevent catastrophic climate change."

The accord includes provisions for renewable energy investment, forest conservation, and support for developing nations transitioning to clean energy. Countries will report their progress annually, with independent monitoring to ensure compliance.

However, some environmental groups argue that the targets are still insufficient. "While this is progress, we need even more aggressive action," said Maria Rodriguez, spokesperson for Global Climate Action. "The planet cannot wait for gradual change."

The agreement will take effect on January 1st next year, marking a new chapter in global environmental cooperation.`,
                questions: [
                    {
                        question: "What is the main purpose of the Geneva Accord?",
                        options: [
                            "To establish new environmental research centers",
                            "To reduce global carbon emissions by 50% in ten years",
                            "To create a fund for climate refugees",
                            "To ban fossil fuels completely"
                        ],
                        correct: 1,
                        explanation: "The text clearly states that the Geneva Accord commits nations to reduce carbon emissions by 50% within the next decade."
                    },
                    {
                        question: "How many countries participated in the summit?",
                        options: ["150", "175", "195", "200"],
                        correct: 2,
                        explanation: "The text mentions that representatives from 195 countries attended the conference."
                    },
                    {
                        question: "What is Dr. Sarah Chen's opinion about the agreement?",
                        options: [
                            "She thinks it's insufficient",
                            "She believes it's exactly what was needed",
                            "She has no opinion",
                            "She thinks it's too ambitious"
                        ],
                        correct: 1,
                        explanation: "Dr. Chen is quoted as saying 'This is exactly what we needed' and praising the agreement."
                    }
                ]
            },
            science: {
                title: "Revolutionary Gene Therapy Shows Promise for Treating Blindness",
                content: `Scientists at the University of Cambridge have developed a revolutionary gene therapy that could restore sight to people with inherited blindness. The breakthrough treatment has shown remarkable success in early clinical trials.

The therapy targets Leber congenital amaurosis (LCA), a rare genetic disorder that causes severe vision loss from birth. LCA affects approximately 1 in 80,000 people worldwide and has previously been considered incurable.

The treatment works by introducing healthy copies of genes into the retina using a modified virus as a delivery vehicle. These genes produce proteins essential for normal vision that are missing or defective in LCA patients.

In the Phase II clinical trial, 18 patients received the gene therapy injection directly into their eyes. After six months, 15 patients showed significant improvement in their vision, with some able to read large print for the first time in their lives.

"The results exceeded our expectations," said Dr. James Wilson, lead researcher on the project. "Patients who could barely detect light are now able to navigate independently and recognize faces."

The therapy appears to be safe, with only mild side effects reported. The most common was temporary inflammation at the injection site, which resolved within a few days.

The research team is now planning Phase III trials involving 200 patients across multiple countries. If successful, the therapy could be available to patients within five years.`,
                questions: [
                    {
                        question: "What condition does the gene therapy treat?",
                        options: [
                            "Age-related macular degeneration",
                            "Leber congenital amaurosis",
                            "Diabetic retinopathy",
                            "Glaucoma"
                        ],
                        correct: 1,
                        explanation: "The text specifically mentions that the therapy targets Leber congenital amaurosis (LCA)."
                    },
                    {
                        question: "How many patients showed improvement in the Phase II trial?",
                        options: ["12", "15", "18", "20"],
                        correct: 1,
                        explanation: "The text states that 15 out of 18 patients showed significant improvement in their vision."
                    }
                ]
            }
        };

        const skillsData = {
            skimming: {
                title: "快速浏览技巧",
                content: `快速浏览（Skimming）是一种快速阅读技巧，用于获取文章的主要信息和整体概念。

主要步骤：
1. 阅读标题和副标题
2. 浏览第一段和最后一段
3. 快速扫视每段的首句
4. 注意关键词和短语
5. 忽略细节信息

练习方法：
- 限时阅读：给自己设定时间限制
- 只读重点：专注于主题句和结论
- 避免回读：不要重复阅读已读内容
- 记录要点：用关键词记录主要信息

通过练习，您可以在短时间内掌握文章的核心内容。`,
                exercise: "请在2分钟内快速浏览一篇新闻文章，然后回答关于文章主旨的问题。"
            },
            scanning: {
                title: "扫读查找技巧",
                content: `扫读（Scanning）是一种快速定位特定信息的阅读技巧。

使用场合：
- 查找具体数据、日期、名字
- 寻找特定事实或细节
- 在长文中定位关键信息

技巧要点：
1. 明确查找目标
2. 快速移动视线
3. 识别关键词线索
4. 利用文章结构
5. 跳过无关内容

练习建议：
- 在文章中查找特定数字
- 寻找人名和地名
- 定位时间和日期
- 查找特定术语或概念`,
                exercise: "在给定文章中快速找到所有提到的数字和百分比。"
            }
        };

        let readingTimer = null;
        let startTime = null;

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            initReadingTabs();
            initTextTypes();
            initSkillCards();
            initPracticeSystem();
            initReadingTools();
        });

        // Tab system
        function initReadingTabs() {
            const tabs = document.querySelectorAll('.reading-tab');
            const panels = document.querySelectorAll('.reading-panel');

            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const targetPanel = this.getAttribute('data-tab') + '-panel';
                    
                    // Update active tab
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Update active panel
                    panels.forEach(p => p.classList.remove('active'));
                    document.getElementById(targetPanel).classList.add('active');
                });
            });
        }

        // Text types
        function initTextTypes() {
            const typeCards = document.querySelectorAll('.text-type-card');
            const passageContent = document.getElementById('passage-content');

            typeCards.forEach(card => {
                card.addEventListener('click', function() {
                    const type = this.getAttribute('data-type');
                    
                    // Update selected card
                    typeCards.forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    // Load passage
                    loadPassage(type, passageContent);
                });
            });
        }

        function loadPassage(type, container) {
            const text = readingTexts[type];
            if (!text) return;

            container.style.display = 'block';
            
            const passageDiv = document.getElementById('reading-passage');
            passageDiv.innerHTML = `
                <div class="passage-title">${text.title}</div>
                <div class="passage-content">${text.content.split('\n\n').map(p => `<p>${p}</p>`).join('')}</div>
            `;

            // Start reading timer
            startReadingTimer();
            
            // Load questions
            loadQuestions(text.questions);
        }

        function loadQuestions(questions) {
            const questionsSection = document.getElementById('questions-section');
            let html = '<h3><i class="fas fa-question-circle"></i> 理解问题</h3>';
            
            questions.forEach((q, index) => {
                html += `
                    <div class="question-item">
                        <div class="question-text">${index + 1}. ${q.question}</div>
                        <div class="question-options">
                            ${q.options.map((option, optIndex) => `
                                <div class="question-option" data-question="${index}" data-option="${optIndex}">
                                    ${String.fromCharCode(65 + optIndex)}. ${option}
                                </div>
                            `).join('')}
                        </div>
                        <div id="explanation-${index}" class="explanation-box" style="display: none;">
                            <strong>解释：</strong> ${q.explanation}
                        </div>
                    </div>
                `;
            });
            
            questionsSection.innerHTML = html;
            
            // Add click handlers for options
            questionsSection.querySelectorAll('.question-option').forEach(option => {
                option.addEventListener('click', function() {
                    const questionIndex = parseInt(this.getAttribute('data-question'));
                    const optionIndex = parseInt(this.getAttribute('data-option'));
                    const question = questions[questionIndex];
                    
                    // Remove previous selections for this question
                    questionsSection.querySelectorAll(`[data-question="${questionIndex}"]`).forEach(opt => {
                        opt.classList.remove('selected', 'correct', 'incorrect');
                    });
                    
                    // Mark selected option
                    this.classList.add('selected');
                    
                    // Show correct answer and explanation
                    setTimeout(() => {
                        questionsSection.querySelectorAll(`[data-question="${questionIndex}"]`).forEach((opt, idx) => {
                            if (idx === question.correct) {
                                opt.classList.add('correct');
                            } else if (idx === optionIndex && idx !== question.correct) {
                                opt.classList.add('incorrect');
                            }
                        });
                        
                        document.getElementById(`explanation-${questionIndex}`).style.display = 'block';
                    }, 500);
                });
            });
        }

        // Skills system
        function initSkillCards() {
            const skillCards = document.querySelectorAll('.skill-card[data-skill]');
            const skillContent = document.getElementById('skill-content');

            skillCards.forEach(card => {
                card.addEventListener('click', function() {
                    const skill = this.getAttribute('data-skill');
                    
                    // Update selected card
                    skillCards.forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    // Load skill content
                    loadSkillContent(skill, skillContent);
                });
            });
        }

        function loadSkillContent(skill, container) {
            const skillData = skillsData[skill];
            if (!skillData) return;

            container.innerHTML = `
                <div class="reading-passage">
                    <div class="passage-title">${skillData.title}</div>
                    <div class="passage-content">${skillData.content.split('\n\n').map(p => `<p>${p}</p>`).join('')}</div>
                    <div style="background: #e8f5e8; padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                        <strong>练习任务：</strong> ${skillData.exercise}
                    </div>
                </div>
            `;
            container.style.display = 'block';
        }

        // Practice system
        function initPracticeSystem() {
            const startBtn = document.getElementById('start-test');
            
            startBtn.addEventListener('click', function() {
                const type = document.getElementById('test-type').value;
                const difficulty = document.getElementById('test-difficulty').value;
                
                startPracticeTest(type, difficulty);
            });
        }

        function startPracticeTest(type, difficulty) {
            const container = document.getElementById('test-container');
            container.style.display = 'block';
            
            container.innerHTML = `
                <div class="reading-passage">
                    <div class="passage-title">练习测试 - ${type} (${difficulty})</div>
                    <div class="passage-content">
                        <p>测试功能正在开发中。这里将显示根据您选择的类型和难度生成的阅读理解测试。</p>
                        <p>测试将包括：</p>
                        <ul>
                            <li>适合难度级别的阅读材料</li>
                            <li>多种题型的理解问题</li>
                            <li>即时反馈和详细解释</li>
                            <li>个性化的学习建议</li>
                        </ul>
                    </div>
                </div>
            `;
        }

        // Reading tools
        function initReadingTools() {
            const highlightBtn = document.getElementById('highlight-vocab');
            const readAloudBtn = document.getElementById('read-aloud');
            const showQuestionsBtn = document.getElementById('show-questions');

            if (highlightBtn) {
                highlightBtn.addEventListener('click', function() {
                    this.classList.toggle('active');
                    toggleVocabularyHighlight();
                });
            }

            if (readAloudBtn) {
                readAloudBtn.addEventListener('click', function() {
                    readPassageAloud();
                });
            }

            if (showQuestionsBtn) {
                showQuestionsBtn.addEventListener('click', function() {
                    const questionsSection = document.getElementById('questions-section');
                    questionsSection.style.display = questionsSection.style.display === 'none' ? 'block' : 'none';
                    this.textContent = questionsSection.style.display === 'none' ? '显示问题' : '隐藏问题';
                });
            }
        }

        function toggleVocabularyHighlight() {
            const passage = document.getElementById('reading-passage');
            const isActive = document.getElementById('highlight-vocab').classList.contains('active');
            
            if (isActive) {
                // Add vocabulary highlighting
                highlightVocabulary(passage);
            } else {
                // Remove highlighting
                removeVocabularyHighlight(passage);
            }
        }

        function highlightVocabulary(container) {
            const difficultWords = [
                { word: 'groundbreaking', meaning: '开创性的，突破性的' },
                { word: 'ambitious', meaning: '雄心勃勃的，有野心的' },
                { word: 'catastrophic', meaning: '灾难性的' },
                { word: 'provisions', meaning: '条款，规定' },
                { word: 'compliance', meaning: '遵守，服从' },
                { word: 'insufficient', meaning: '不足的，不够的' },
                { word: 'aggressive', meaning: '积极的，激进的' }
            ];
            
            let content = container.innerHTML;
            
            difficultWords.forEach(item => {
                const regex = new RegExp(`\\b${item.word}\\b`, 'gi');
                content = content.replace(regex, `<span class="vocabulary-highlight">${item.word}<span class="vocabulary-tooltip">${item.meaning}</span></span>`);
            });
            
            container.innerHTML = content;
        }

        function removeVocabularyHighlight(container) {
            const highlights = container.querySelectorAll('.vocabulary-highlight');
            highlights.forEach(highlight => {
                highlight.outerHTML = highlight.textContent;
            });
        }

        function readPassageAloud() {
            const passage = document.querySelector('.passage-content');
            if (!passage) return;
            
            const text = passage.textContent;
            
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'en-US';
                utterance.rate = 0.8;
                speechSynthesis.speak(utterance);
            } else {
                alert('您的浏览器不支持语音合成功能。');
            }
        }

        function startReadingTimer() {
            startTime = Date.now();
            const timerDisplay = document.getElementById('reading-time');
            
            readingTimer = setInterval(() => {
                const elapsed = Date.now() - startTime;
                const minutes = Math.floor(elapsed / 60000);
                const seconds = Math.floor((elapsed % 60000) / 1000);
                timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function stopReadingTimer() {
            if (readingTimer) {
                clearInterval(readingTimer);
                readingTimer = null;
            }
        }

        // Stop timer when leaving the page
        window.addEventListener('beforeunload', stopReadingTimer);
    </script>
</body>
</html> 